<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPIDEY BOT - Admin Dashboard</title>
    <style>
        :root {
            --theme-color: 0, 212, 255;
            --text-color: rgba(255, 255, 255, 0.9);
            --bg-primary: #0a0e27;
            --bg-secondary: #1a1f3a;
            --accent-cyan: #00d4ff;
            --accent-purple: #9146ff;
            --accent-pink: #ff69b4;
            --accent-green: #00ff88;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(to bottom right, #0d7f8f 0%, #0a6b85 15%, #005a7f 30%, #003d5c 45%, #0a2555 60%, #2a1a5c 75%, #3a0a4c 90%, #1a0033 100%);
            color: var(--text-color);
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
            min-height: 100vh;
            background-attachment: fixed;
        }

        body.light-mode {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            background: var(--bg-primary);
        }

        body.light-mode .header {
            background: linear-gradient(135deg, rgba(145, 70, 255, 0.08) 0%, rgba(0, 212, 255, 0.05) 100%);
            border-bottom-color: rgba(var(--theme-color), 0.1);
        }

        body.light-mode .header-title,
        body.light-mode .user-name {
            color: rgba(0, 0, 0, 0.9);
        }

        body.light-mode .user-role {
            color: rgba(0, 0, 0, 0.5);
        }

        body.light-mode .sidebar {
            background: var(--bg-primary);
            border-right-color: rgba(var(--theme-color), 0.1);
        }

        body.light-mode .sidebar-section-title {
            color: rgba(0, 0, 0, 0.4);
        }

        body.light-mode .sidebar-item {
            color: rgba(0, 0, 0, 0.6);
        }

        body.light-mode .sidebar-item:hover {
            background: rgba(var(--theme-color), 0.08);
            color: rgba(0, 0, 0, 0.8);
        }

        body.light-mode .sidebar-item.active {
            color: rgba(0, 0, 0, 0.9);
        }

        body.light-mode .content-area {
            background: var(--bg-primary);
        }

        body.light-mode .content-title {
            color: rgba(0, 0, 0, 0.95);
        }

        body.light-mode .content-subtitle {
            color: rgba(0, 0, 0, 0.5);
        }

        body.light-mode .panel {
            background: var(--bg-secondary);
            border-color: rgba(var(--theme-color), 0.15);
        }

        body.light-mode .panel-title {
            color: rgba(0, 0, 0, 0.95);
        }

        body.light-mode .form-label {
            color: rgba(0, 0, 0, 0.6);
        }

        body.light-mode .form-input {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(var(--theme-color), 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        body.light-mode .form-input:focus {
            background: rgba(0, 0, 0, 0.08);
            border-color: rgba(var(--theme-color), 0.4);
        }

        body.light-mode .color-label {
            color: rgba(0, 0, 0, 0.8);
        }

        body.light-mode .color-preset {
            border-color: rgba(0, 0, 0, 0.2);
        }

        body.light-mode .server-dropdown-btn {
            color: rgba(0, 0, 0, 0.8);
        }

        body.light-mode .server-menu-item {
            color: rgba(0, 0, 0, 0.6);
        }

        body.light-mode .server-menu-item:hover {
            color: rgba(0, 0, 0, 0.9);
        }

        body.light-mode .server-menu-item.active {
            color: var(--accent-cyan);
        }

        body.light-mode .panel-header {
            border-bottom-color: rgba(0, 0, 0, 0.1);
        }

        body.light-mode .color-picker-wrapper {
            background: transparent;
        }

        /* ── Light mode: stat cards, labels, inline text ── */
        body.light-mode [style*="color: rgba(255,255,255"] {
            color: rgba(0,0,0,0.7) !important;
        }

        body.light-mode .content-section [style*="color: rgba(255,255,255,0.9)"] {
            color: rgba(0,0,0,0.9) !important;
        }

        body.light-mode .content-section [style*="color: rgba(255,255,255,0.7)"] {
            color: rgba(0,0,0,0.6) !important;
        }

        body.light-mode .content-section [style*="color: rgba(255,255,255,0.5)"] {
            color: rgba(0,0,0,0.45) !important;
        }

        body.light-mode .content-section [style*="color: rgba(255,255,255,0.6)"] {
            color: rgba(0,0,0,0.55) !important;
        }

        body.light-mode .content-section [style*="color: rgba(255,255,255,0.4)"] {
            color: rgba(0,0,0,0.4) !important;
        }

        /* ── Light mode: staff panel ── */
        body.light-mode .staff-section-label {
            color: rgba(0,0,0,0.45);
        }

        body.light-mode .staff-member {
            background: rgba(0,0,0,0.03);
        }

        body.light-mode .staff-member:hover {
            background: rgba(0,0,0,0.06);
        }

        body.light-mode .staff-name {
            color: rgba(0,0,0,0.85);
        }

        body.light-mode .staff-role-tag {
            color: rgba(0,0,0,0.55);
            background: rgba(var(--theme-color), 0.08);
            border-color: rgba(var(--theme-color), 0.15);
        }

        body.light-mode .staff-avatar {
            color: rgba(0,0,0,0.7);
        }

        body.light-mode .staff-divider {
            background: rgba(0,0,0,0.08);
        }

        /* ── Light mode: overlay ── */
        body.light-mode .server-select-overlay {
            background: rgba(240, 240, 245, 0.7);
        }

        body.light-mode .server-select-prompt {
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(var(--theme-color), 0.2);
            box-shadow: 0 16px 64px rgba(0, 0, 0, 0.15);
        }

        body.light-mode .server-select-prompt h2 {
            color: rgba(0,0,0,0.9);
        }

        body.light-mode .server-select-prompt p {
            color: rgba(0,0,0,0.5);
        }

        /* ── Light mode: notification, user profile, generic text ── */
        body.light-mode .notification-icon {
            color: rgba(0,0,0,0.6);
        }

        body.light-mode .content-grid .panel p,
        body.light-mode .content-grid .panel small {
            color: rgba(0,0,0,0.55) !important;
        }

        body.light-mode .server-dropdown-menu {
            background: rgba(255,255,255,0.97);
            border-color: rgba(var(--theme-color), 0.15);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }

        .dashboard-wrapper {
            display: flex;
            height: 100vh;
            flex-direction: column;
            background: transparent;
        }

        /* Header */
        .header {
            background: rgba(10, 20, 40, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(var(--theme-color), 0.2);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-logo {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .header-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
        }

        .color-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .color-picker {
            width: 60px;
            height: 50px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .color-picker:hover {
            transform: scale(1.05);
        }

        .color-label {
            font-size: 0.95rem;
            color: rgba(var(--theme-color), 0.9);
            font-weight: 500;
            min-width: 120px;
        }

        .color-preset {
            width: 50px;
            height: 50px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-preset:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.6);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.4);
        }

        .btn-secondary {
            background: rgba(var(--theme-color), 0.15);
            border: 1px solid rgba(var(--theme-color), 0.4);
            color: rgba(var(--theme-color), 1);
        }

        .btn-secondary:hover {
            background: rgba(var(--theme-color), 0.25);
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .server-selector {
            position: relative;
        }

        .server-dropdown-btn {
            background: rgba(var(--theme-color), 0.12);
            border: 1px solid rgba(var(--theme-color), 0.3);
            color: rgba(255, 255, 255, 0.85);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s ease;
            max-width: 320px;
            white-space: nowrap;
            overflow: hidden;
        }

        .server-btn-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(var(--theme-color), 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
            overflow: hidden;
            color: rgba(255, 255, 255, 0.9);
        }

        .server-btn-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .server-dropdown-btn span:first-of-type {
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            min-width: 0;
        }

        .server-dropdown-btn:hover {
            background: rgba(var(--theme-color), 0.18);
            border-color: rgba(var(--theme-color), 0.5);
        }

        .server-dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-radius: 8px;
            margin-top: 0.5rem;
            min-width: 220px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 9999 !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            display: none;
        }

        .server-dropdown-menu.active {
            display: block;
        }

        .server-menu-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.7);
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .server-menu-item:hover {
            background: rgba(var(--theme-color), 0.15);
            border-left-color: rgba(var(--theme-color), 0.6);
            color: rgba(255, 255, 255, 0.95);
        }

        .server-menu-item.active {
            background: rgba(var(--theme-color), 0.2);
            border-left-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .server-menu-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(var(--theme-color), 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
            flex-shrink: 0;
            overflow: hidden;
            color: rgba(255, 255, 255, 0.9);
        }

        .server-menu-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .server-menu-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 0;
            flex: 1;
        }

        .server-menu-name {
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .server-menu-members {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.4);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .mode-toggle {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.1);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .mode-toggle:hover {
            background: rgba(var(--theme-color), 0.2);
            border-color: rgba(var(--theme-color), 0.4);
        }

        body.light-mode .mode-toggle {
            background: rgba(var(--theme-color), 0.08);
            border-color: rgba(var(--theme-color), 0.15);
        }

        body.light-mode .mode-toggle:hover {
            background: rgba(var(--theme-color), 0.15);
            border-color: rgba(var(--theme-color), 0.3);
        }

        .notification-icon {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.1);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .notification-icon:hover {
            background: rgba(var(--theme-color), 0.2);
            border-color: rgba(var(--theme-color), 0.4);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            position: relative;
            padding: 0 0.5rem;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            border: 2px solid var(--accent-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            background-size: cover;
            background-position: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 0.15rem;
            min-width: 0;
            flex-shrink: 1;
        }

        .user-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-role {
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.5);
            white-space: nowrap;
        }

        .profile-dropdown-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75rem;
            flex-shrink: 0;
            margin-left: 0.25rem;
        }

        .profile-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            margin-top: 0.5rem;
            min-width: 180px;
            display: none;
            z-index: 9999 !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .profile-menu.active {
            display: block;
        }

        .profile-menu-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(var(--theme-color), 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.7);
        }

        .profile-menu-item:last-child {
            border-bottom: none;
        }

        .profile-menu-item:hover {
            background: rgba(var(--theme-color), 0.1);
            color: rgba(255, 255, 255, 0.95);
        }

        .profile-menu-item.logout {
            color: #ff6b6b;
        }

        /* Server Selection Overlay */
        .server-select-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(5, 10, 25, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .server-select-overlay.hidden {
            display: none;
        }

        .server-select-prompt {
            text-align: center;
            padding: 3rem;
            background: rgba(15, 25, 50, 0.9);
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-radius: 16px;
            box-shadow: 0 16px 64px rgba(0, 0, 0, 0.5);
            max-width: 420px;
        }

        .server-select-prompt .prompt-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .server-select-prompt h2 {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1.4rem;
            margin-bottom: 0.75rem;
        }

        .server-select-prompt p {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .server-select-prompt .prompt-btn {
            background: linear-gradient(135deg, rgba(145, 70, 255, 0.6), rgba(0, 212, 255, 0.6));
            border: 1px solid rgba(var(--theme-color), 0.4);
            color: #fff;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .server-select-prompt .prompt-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(145, 70, 255, 0.3);
        }

        /* Main Container */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            width: 220px;
            background: rgba(10, 20, 40, 0.2);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(var(--theme-color), 0.2);
            overflow-y: auto;
            padding: 1.5rem 0;
            box-shadow: 8px 0 32px rgba(0, 0, 0, 0.2);
        }

        .sidebar-section {
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }

        .sidebar-section-title {
            font-size: 0.65rem;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.3);
            letter-spacing: 1px;
            padding: 0 1rem 0.75rem;
            font-weight: 700;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-item {
            padding: 0.6rem 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            gap: 0.65rem;
            margin: 0.2rem 0.5rem;
            border-radius: 6px;
            font-size: 0.85rem;
            position: relative;
        }

        .sidebar-item:hover {
            background: rgba(var(--theme-color), 0.1);
            color: rgba(255, 255, 255, 0.8);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(145, 70, 255, 0.3) 0%, rgba(0, 212, 255, 0.2) 100%);
            color: var(--accent-cyan);
            border-left: 3px solid var(--accent-cyan);
            padding-left: calc(0.75rem - 3px);
        }

        .sidebar-item-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .sidebar-item-icon svg {
            width: 100%;
            height: 100%;
            stroke: currentColor;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: transparent;
        }

        .content-header {
            margin-bottom: 1rem;
        }

        .content-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 0.5rem;
        }

        .content-subtitle {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.5);
        }

        /* Grid Layout */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
            position: relative;
            z-index: 1;
        }

        .content-grid.wide {
            grid-template-columns: 2fr 1fr;
        }

        #settings-section .content-grid,
        #logging-section .content-grid,
        #server-guard-section .content-grid,
        #react-roles-section .content-grid,
        #role-categories-section .content-grid,
        #server-messages-section .content-grid,
        #custom-commands-section .content-grid,
        #components-section .content-grid,
        #xp-levels-section .content-grid,
        #leaderboards-section .content-grid,
        #invite-tracking-section .content-grid,
        #message-counting-section .content-grid,
        #statistics-channels-section .content-grid,
        #giveaways-section .content-grid,
        #social-notifs-section .content-grid,
        #reminders-section .content-grid,
        #recordings-section .content-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        /* Single panel in a grid spans full width */
        .content-grid > .panel:only-child {
            grid-column: 1 / -1;
        }

        /* Tighter spacing between consecutive grids */
        .content-grid + .content-grid {
            margin-top: 0.75rem !important;
        }

        /* Panels */
        .panel {
            background: rgba(20, 30, 60, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 10px;
            padding: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        #settings-section .panel,
        #logging-section .panel,
        #server-guard-section .panel,
        #react-roles-section .panel,
        #role-categories-section .panel,
        #server-messages-section .panel,
        #custom-commands-section .panel,
        #components-section .panel,
        #xp-levels-section .panel,
        #leaderboards-section .panel,
        #invite-tracking-section .panel,
        #message-counting-section .panel,
        #statistics-channels-section .panel,
        #giveaways-section .panel,
        #social-notifs-section .panel,
        #reminders-section .panel,
        #recordings-section .panel {
            padding: 0.9rem;
        }

        .panel:hover {
            background: rgba(20, 30, 60, 0.35);
            border-color: rgba(var(--theme-color), 0.4);
            box-shadow: 0 8px 32px rgba(var(--theme-color), 0.15);
        }

        /* Toggle Switch */
        .toggle-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            padding: 0.3rem 0;
            font-size: 0.95rem;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
            flex-shrink: 0;
            margin-left: 1rem;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.15);
            transition: 0.3s ease;
            border-radius: 24px;
        }
        .toggle-slider:before {
            content: "";
            position: absolute;
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: #fff;
            transition: 0.3s ease;
            border-radius: 50%;
        }
        .toggle-switch input:checked + .toggle-slider {
            background: rgba(var(--theme-color), 0.8);
        }
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            padding-bottom: 0.6rem;
            border-bottom: 1px solid rgba(var(--theme-color), 0.15);
        }

        .panel-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
        }

        #settings-section .panel-title,
        #logging-section .panel-title,
        #server-guard-section .panel-title,
        #react-roles-section .panel-title,
        #role-categories-section .panel-title,
        #server-messages-section .panel-title,
        #custom-commands-section .panel-title,
        #components-section .panel-title,
        #xp-levels-section .panel-title,
        #leaderboards-section .panel-title,
        #invite-tracking-section .panel-title,
        #message-counting-section .panel-title,
        #statistics-channels-section .panel-title,
        #giveaways-section .panel-title,
        #social-notifs-section .panel-title,
        #reminders-section .panel-title,
        #recordings-section .panel-title {
            font-size: 0.85rem;
        }

        .panel-icon {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.15);
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .panel-icon:hover {
            background: rgba(var(--theme-color), 0.25);
            border-color: rgba(var(--theme-color), 0.5);
        }

        .panel-content {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        #settings-section .panel-content,
        #logging-section .panel-content,
        #server-guard-section .panel-content,
        #react-roles-section .panel-content,
        #role-categories-section .panel-content,
        #server-messages-section .panel-content,
        #custom-commands-section .panel-content,
        #components-section .panel-content,
        #xp-levels-section .panel-content,
        #leaderboards-section .panel-content,
        #invite-tracking-section .panel-content,
        #message-counting-section .panel-content,
        #statistics-channels-section .panel-content,
        #giveaways-section .panel-content,
        #social-notifs-section .panel-content,
        #reminders-section .panel-content,
        #recordings-section .panel-content {
            gap: 0.5rem;
        }

        /* Form Elements */
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .form-label {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.65);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        #settings-section .form-label,
        #logging-section .form-label,
        #server-guard-section .form-label,
        #react-roles-section .form-label,
        #role-categories-section .form-label,
        #server-messages-section .form-label,
        #custom-commands-section .form-label,
        #components-section .form-label,
        #xp-levels-section .form-label,
        #leaderboards-section .form-label,
        #invite-tracking-section .form-label,
        #message-counting-section .form-label,
        #statistics-channels-section .form-label,
        #giveaways-section .form-label,
        #social-notifs-section .form-label,
        #reminders-section .form-label,
        #recordings-section .form-label {
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .form-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(var(--theme-color), 0.2);
            padding: 0.4rem 0.5rem;
            border-radius: 5px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.75rem;
            transition: all 0.2s ease;
            height: 28px;
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(var(--theme-color), 0.5);
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.15);
        }

        /* Dropdown Option Styling */
        .form-input option {
            background: #1a1a2e;
            color: #fff;
            padding: 0.5rem;
        }

        .form-input option:checked {
            background: linear-gradient(rgba(0, 212, 255, 0.3), rgba(0, 212, 255, 0.3));
            color: #fff;
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        select option {
            background: #0f1623;
            color: #fff;
            padding: 0.6rem 0.8rem;
            border: none;
        }

        select option:checked {
            background: rgba(0, 212, 255, 0.3);
            color: #fff;
        }

        .form-input {
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .glass-select {
            background: rgba(20, 30, 60, 0.4) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.3) !important;
            color: #fff !important;
        }

        .glass-select:hover {
            background: rgba(20, 30, 60, 0.5) !important;
            border-color: rgba(0, 212, 255, 0.5) !important;
        }

        .glass-select:focus {
            background: rgba(20, 30, 60, 0.6) !important;
            border-color: rgba(0, 212, 255, 0.6) !important;
            box-shadow: 0 0 12px rgba(0, 212, 255, 0.2) !important;
        }

        .panel-content {
            max-height: 100%;
            overflow: visible;
            position: relative;
            z-index: auto;
        }

        /* Buttons */
        .btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            height: 28px;
            width: 100%;
            justify-content: center;
        }

        #settings-section .btn,
        #logging-section .btn,
        #server-guard-section .btn,
        #react-roles-section .btn,
        #role-categories-section .btn,
        #server-messages-section .btn,
        #custom-commands-section .btn,
        #components-section .btn,
        #xp-levels-section .btn,
        #leaderboards-section .btn,
        #invite-tracking-section .btn,
        #message-counting-section .btn,
        #statistics-channels-section .btn,
        #giveaways-section .btn,
        #social-notifs-section .btn,
        #reminders-section .btn,
        #recordings-section .btn {
            font-size: 0.65rem;
            height: 26px;
            padding: 0.3rem 0.6rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-cyan) 100%);
            color: rgba(255, 255, 255, 0.95);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(145, 70, 255, 0.3);
        }

        .btn-secondary {
            background: rgba(var(--theme-color), 0.15);
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(var(--theme-color), 0.3);
        }

        .btn-secondary:hover {
            background: rgba(var(--theme-color), 0.25);
            border-color: rgba(var(--theme-color), 0.5);
        }

        /* ===== Toast Notification System ===== */
        #toastContainer {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
            pointer-events: none;
            max-width: 420px;
            width: calc(100% - 3rem);
        }
        .toast {
            pointer-events: auto;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.85rem 1rem;
            border-radius: 14px;
            background: rgba(20, 20, 35, 0.85);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 8px 32px rgba(0,0,0,0.4), 0 0 0 1px rgba(255,255,255,0.03) inset;
            animation: toastIn 0.35s cubic-bezier(0.22, 1, 0.36, 1);
            cursor: pointer;
            transition: opacity 0.25s, transform 0.25s;
        }
        .toast:hover { transform: translateX(-4px); }
        .toast.hiding {
            animation: toastOut 0.3s cubic-bezier(0.55, 0, 1, 0.45) forwards;
        }
        .toast-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
            margin-top: 1px;
        }
        .toast-body { flex: 1; min-width: 0; }
        .toast-title {
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 2px;
        }
        .toast-msg {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            line-height: 1.4;
            word-break: break-word;
        }
        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 2px;
            border-radius: 0 0 14px 14px;
            animation: toastProgress linear forwards;
        }
        .toast.toast-success { border-color: rgba(0, 212, 130, 0.35); }
        .toast.toast-success .toast-title { color: #00d482; }
        .toast.toast-success .toast-progress { background: linear-gradient(90deg, #00d482, #00d4ff); }
        .toast.toast-error { border-color: rgba(237, 66, 69, 0.35); }
        .toast.toast-error .toast-title { color: #ed4245; }
        .toast.toast-error .toast-progress { background: linear-gradient(90deg, #ed4245, #ff6b6b); }
        .toast.toast-info { border-color: rgba(0, 212, 255, 0.35); }
        .toast.toast-info .toast-title { color: #00d4ff; }
        .toast.toast-info .toast-progress { background: linear-gradient(90deg, #00d4ff, #9146ff); }
        .toast.toast-warning { border-color: rgba(255, 165, 0, 0.35); }
        .toast.toast-warning .toast-title { color: #ffa500; }
        .toast.toast-warning .toast-progress { background: linear-gradient(90deg, #ffa500, #ff6b6b); }

        @keyframes toastIn {
            from { opacity: 0; transform: translateX(60px) scale(0.95); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }
        @keyframes toastOut {
            from { opacity: 1; transform: translateX(0) scale(1); }
            to { opacity: 0; transform: translateX(60px) scale(0.92); }
        }
        @keyframes toastProgress {
            from { width: 100%; }
            to { width: 0%; }
        }

        body.light-mode .toast {
            background: rgba(255, 255, 255, 0.92);
            border-color: rgba(0,0,0,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
        }
        body.light-mode .toast-msg { color: rgba(0,0,0,0.55); }

        /* Unsaved Changes Notification */
        #unsavedNotification {
            display: none;
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 165, 0, 0.4);
            border-radius: 20px;
            padding: 0.75rem 1.5rem;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            gap: 1.5rem;
            animation: slideUp 0.4s ease-out;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 20px rgba(255, 165, 0, 0.1);
            max-width: calc(100% - 2rem);
        }

        #unsavedNotification.hide {
            animation: slideDown 0.4s ease-in;
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            to {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
        }

        .unsaved-message {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .unsaved-icon {
            font-size: 1rem;
            color: #ff9500;
            flex-shrink: 0;
        }

        .unsaved-text {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .unsaved-buttons {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-shrink: 0;
        }

        .btn-reset {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.4rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .btn-reset:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-1px);
        }

        .btn-save-changes {
            background: rgba(34, 197, 94, 0.8);
            color: #fff;
            border: none;
            padding: 0.4rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.2);
        }

        .btn-save-changes:hover {
            background: rgba(34, 197, 94, 1);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.3);
        }

        .content-section {
            display: none !important;
            visibility: hidden !important;
            min-height: 100vh;
            position: relative;
            z-index: 0 !important;
        }

        .content-section.active {
            display: block !important;
            visibility: visible !important;
            z-index: 1 !important;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(var(--theme-color), 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(var(--theme-color), 0.4);
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        .graph-container {
            position: relative;
            height: 350px;
            margin-bottom: 1.5rem;
            width: 100%;
            display: block;
        }

        .graph-container canvas {
            max-height: 350px !important;
            height: 350px !important;
            width: 100% !important;
        }

        /* Staff Panel Styles */
        .staff-section-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255,255,255,0.4);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .staff-member {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.4rem;
            background: rgba(255,255,255,0.03);
            transition: background 0.2s ease;
        }

        .staff-member:hover {
            background: rgba(255,255,255,0.07);
        }

        .staff-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(var(--theme-color), 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
            overflow: hidden;
            color: rgba(255,255,255,0.9);
        }

        .staff-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .staff-info {
            flex: 1;
            min-width: 0;
        }

        .staff-name {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.9);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .staff-roles {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 3px;
        }

        .staff-role-tag {
            font-size: 0.65rem;
            padding: 1px 6px;
            border-radius: 4px;
            background: rgba(var(--theme-color), 0.15);
            color: rgba(255,255,255,0.6);
            border: 1px solid rgba(var(--theme-color), 0.2);
        }

        .staff-owner-badge {
            font-size: 0.65rem;
            padding: 1px 6px;
            border-radius: 4px;
            background: rgba(255,215,0,0.2);
            color: #ffd700;
            border: 1px solid rgba(255,215,0,0.3);
        }

        .staff-revoke-btn {
            flex-shrink: 0;
            background: rgba(255,80,80,0.15);
            border: 1px solid rgba(255,80,80,0.3);
            color: #ff6b6b;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .staff-revoke-btn:hover {
            background: rgba(255,80,80,0.3);
            border-color: rgba(255,80,80,0.5);
        }

        .staff-revoke-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .staff-divider {
            height: 1px;
            background: rgba(var(--theme-color), 0.1);
            margin: 0.75rem 0;
        }

        /* ========== Custom Multi-Select Dropdown ========== */
        .custom-multiselect {
            position: relative;
            width: 100%;
        }
        .custom-multiselect .cms-trigger {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 5px;
            padding: 0.35rem 0.5rem;
            cursor: pointer;
            min-height: 34px;
            transition: all 0.2s ease;
            user-select: none;
        }
        .custom-multiselect .cms-trigger:hover {
            border-color: rgba(var(--theme-color), 0.4);
            background: rgba(0, 0, 0, 0.4);
        }
        .custom-multiselect.open .cms-trigger {
            border-color: rgba(var(--theme-color), 0.5);
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.15);
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }
        .cms-trigger-text {
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            flex: 1;
            overflow: hidden;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
        }
        .cms-trigger-text .cms-tag {
            display: inline-flex;
            align-items: center;
            background: rgba(var(--theme-color), 0.15);
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-radius: 3px;
            padding: 1px 6px;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.85);
            white-space: nowrap;
            max-width: 140px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .cms-trigger-text .cms-tag .cms-tag-x {
            margin-left: 4px;
            cursor: pointer;
            font-size: 0.65rem;
            opacity: 0.6;
            transition: opacity 0.15s;
        }
        .cms-trigger-text .cms-tag .cms-tag-x:hover {
            opacity: 1;
            color: #ff6b6b;
        }
        .cms-trigger-text .cms-overflow {
            font-size: 0.65rem;
            color: rgba(var(--theme-color), 0.8);
            white-space: nowrap;
            align-self: center;
        }
        .cms-arrow {
            margin-left: 6px;
            font-size: 0.6rem;
            color: rgba(255, 255, 255, 0.4);
            transition: transform 0.2s ease;
            flex-shrink: 0;
        }
        .custom-multiselect.open .cms-arrow {
            transform: rotate(180deg);
        }
        .cms-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            background: #141e3c;
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-top: none;
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }
        .custom-multiselect.open .cms-dropdown {
            display: block;
            animation: cmsFadeIn 0.15s ease;
        }
        @keyframes cmsFadeIn {
            from { opacity: 0; transform: translateY(-4px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .cms-search {
            padding: 6px 8px;
            border-bottom: 1px solid rgba(var(--theme-color), 0.1);
            position: sticky;
            top: 0;
            background: #141e3c;
            z-index: 1;
        }
        .cms-search input {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(var(--theme-color), 0.15);
            border-radius: 3px;
            padding: 4px 8px;
            font-size: 0.7rem;
            color: #fff;
            outline: none;
        }
        .cms-search input::placeholder { color: rgba(255, 255, 255, 0.3); }
        .cms-search input:focus {
            border-color: rgba(var(--theme-color), 0.4);
        }
        .cms-options {
            max-height: 160px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(var(--theme-color), 0.3) transparent;
        }
        .cms-options::-webkit-scrollbar { width: 5px; }
        .cms-options::-webkit-scrollbar-track { background: transparent; }
        .cms-options::-webkit-scrollbar-thumb {
            background: rgba(var(--theme-color), 0.3);
            border-radius: 3px;
        }
        .cms-option {
            display: flex;
            align-items: center;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.73rem;
            color: rgba(255, 255, 255, 0.75);
            transition: background 0.12s ease;
            gap: 8px;
        }
        .cms-option:hover {
            background: rgba(var(--theme-color), 0.08);
        }
        .cms-option.selected {
            background: rgba(var(--theme-color), 0.12);
            color: rgba(255, 255, 255, 0.95);
        }
        .cms-option .cms-check {
            width: 14px;
            height: 14px;
            border: 1.5px solid rgba(var(--theme-color), 0.3);
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.55rem;
            flex-shrink: 0;
            transition: all 0.15s ease;
        }
        .cms-option.selected .cms-check {
            background: rgba(var(--theme-color), 0.4);
            border-color: rgba(var(--theme-color), 0.7);
            color: #fff;
        }
        .cms-option .cms-role-color {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .cms-empty {
            padding: 12px;
            text-align: center;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.3);
        }

        /* Light mode overrides for custom multi-select */
        body.light-mode .cms-trigger {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(var(--theme-color), 0.2);
        }
        body.light-mode .cms-trigger:hover {
            background: rgba(0, 0, 0, 0.08);
        }
        body.light-mode .custom-multiselect.open .cms-trigger {
            background: rgba(0, 0, 0, 0.08);
        }
        body.light-mode .cms-trigger-text { color: rgba(0, 0, 0, 0.4); }
        body.light-mode .cms-trigger-text .cms-tag {
            background: rgba(var(--theme-color), 0.1);
            color: rgba(0, 0, 0, 0.75);
        }
        body.light-mode .cms-dropdown { background: #fff; box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
        body.light-mode .cms-search { background: #fff; }
        body.light-mode .cms-search input { background: rgba(0,0,0,0.04); color: #222; }
        body.light-mode .cms-option { color: rgba(0,0,0,0.7); }
        body.light-mode .cms-option:hover { background: rgba(var(--theme-color), 0.06); }
        body.light-mode .cms-option.selected { background: rgba(var(--theme-color), 0.1); color: #000; }

        /* Allow dropdown overflow on panels containing custom multi-selects */
        .panel:has(.custom-multiselect) {
            overflow: visible;
        }
        .panel:has(.custom-multiselect) .panel-content {
            overflow: visible;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="dashboard-wrapper">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="header-logo">
                    <img src="/assets/spidey-logo.png" alt="SPIDEY BOT Logo" />
                </div>
                
                <div class="server-selector">
                    <button class="server-dropdown-btn" onclick="toggleServerDropdown()">
                        <div class="server-btn-icon" id="serverBtnIcon">?</div>
                        <span id="serverDisplayName">Select Server</span>
                        <span>▼</span>
                    </button>
                    <div class="server-dropdown-menu" id="serverDropdownMenu">
                        <div id="serversList"></div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark/Light Mode">
                    <span id="modeIcon">🌙</span>
                </div>
                
                <div class="user-profile" onclick="toggleProfileMenu()">
                    <div class="user-avatar" id="userAvatar">D</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-role" id="userRole">Admin</div>
                    </div>
                    <div class="profile-dropdown-icon">⋮</div>
                    
                    <div class="profile-menu" id="profileMenu">
                        <div class="profile-menu-item">Profile Settings</div>
                        <div class="profile-menu-item">Preferences</div>
                        <div class="profile-menu-item logout" onclick="logout()">Log Out</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Server Selection Overlay -->
            <div class="server-select-overlay" id="serverSelectOverlay">
                <div class="server-select-prompt">
                    <div class="prompt-icon">🖥️</div>
                    <h2 data-i18n="overlay_selectServer">Select a Server</h2>
                    <p data-i18n="overlay_selectServerDesc">Choose a server from the dropdown above to view its dashboard and manage settings.</p>
                </div>
            </div>
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_main">MAIN</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item active" data-section="dashboard" onclick="switchSection('dashboard')">
                            <span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></span>
                            <span data-i18n="sidebar_dashboard">Dashboard</span>
                        </li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_core">CORE</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="settings" onclick="switchSection('settings')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m8.48 0l4.24-4.24M1 12h6m6 0h6m-17.78 7.78l4.24-4.24m8.48 0l4.24 4.24"/></svg></span><span data-i18n="sidebar_settings">Settings</span></li>
                        <li class="sidebar-item" data-section="logging" onclick="switchSection('logging')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 2H7a2 2 0 00-2 2v16a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2h-2M9 7h6M9 13h6M9 19h2"/></svg></span><span data-i18n="sidebar_logging">Logging</span></li>
                        <li class="sidebar-item" data-section="server-guard" onclick="switchSection('server-guard')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 1l7 3.5v5.5c0 4-7 7-7 7s-7-3-7-7V4.5L12 1z"/></svg></span><span data-i18n="sidebar_serverGuard">Server Guard</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_features">FEATURES</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="react-roles" onclick="switchSection('react-roles')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg></span><span data-i18n="sidebar_reactRoles">React Roles</span></li>
                        <li class="sidebar-item" data-section="role-categories" onclick="switchSection('role-categories')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h5a2 2 0 012 2z"/></svg></span><span data-i18n="sidebar_roleCategories">Role Categories</span></li>
                        <li class="sidebar-item" data-section="server-messages" onclick="switchSection('server-messages')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg></span><span data-i18n="sidebar_serverMessages">Server Messages</span></li>
                        <li class="sidebar-item" data-section="custom-commands" onclick="switchSection('custom-commands')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4l6 6m-6-6l-6 6"/></svg></span><span data-i18n="sidebar_commands">Commands</span></li>
                        <li class="sidebar-item" data-section="components" onclick="switchSection('components')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="8.5" y="11.5" width="7" height="7"/></svg></span><span data-i18n="sidebar_components">Components</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_systems">SYSTEMS</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="xp-levels" onclick="switchSection('xp-levels')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg></span><span data-i18n="sidebar_xpLevels">XP Levels</span></li>
                        <li class="sidebar-item" data-section="leaderboards" onclick="switchSection('leaderboards')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 9l6-7 6 7M3 12h18v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8z"/></svg></span><span data-i18n="sidebar_leaderboards">Leaderboards</span></li>
                        <li class="sidebar-item" data-section="giveaways" onclick="switchSection('giveaways')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M12 11v6M9 14h6"/></svg></span><span data-i18n="sidebar_giveaways">Giveaways</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_monitoring">MONITORING</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="events" onclick="switchSection('events')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="9"/><polyline points="12 6 12 12 16 14"/></svg></span><span data-i18n="sidebar_memberActivity">Member Activity</span></li>
                        <li class="sidebar-item" data-section="social-notifs" onclick="switchSection('social-notifs')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3 6h6l-5 4 2 6-6-4-6 4 2-6-5-4h6l3-6z"/></svg></span><span data-i18n="sidebar_socialNotifs">Social Notifs</span></li>
                        <li class="sidebar-item" data-section="invite-tracking" onclick="switchSection('invite-tracking')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></span><span data-i18n="sidebar_invites">Invites</span></li>
                        <li class="sidebar-item" data-section="message-counting" onclick="switchSection('message-counting')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg></span><span data-i18n="sidebar_messages">Messages</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_advanced">ADVANCED</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="recordings" onclick="switchSection('recordings')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M12 1v4m0 8v4M4.22 4.22l2.83 2.83m5.9 0l2.83-2.83M1 12h4m8 0h4m-15.78 7.78l2.83-2.83m5.9 0l2.83 2.83"/></svg></span><span data-i18n="sidebar_recordings">Recordings</span></li>
                        <li class="sidebar-item" data-section="reminders" onclick="switchSection('reminders')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="9"/><polyline points="12 6 12 12 16 14"/></svg></span><span data-i18n="sidebar_reminders">Reminders</span></li>
                        <li class="sidebar-item" data-section="statistics-channels" onclick="switchSection('statistics-channels')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="7" width="3" height="14"/><rect x="10" y="3" width="3" height="18"/><rect x="17" y="10" width="3" height="11"/></svg></span><span data-i18n="sidebar_stats">Stats</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_subscriptions">SUBSCRIPTIONS</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="subscriptions" onclick="switchSection('subscriptions')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M12 11v6M9 14h6"/></svg></span><span data-i18n="sidebar_premium">Premium</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title" data-i18n="nav_tools">TOOLS</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="colors" onclick="switchSection('colors')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M12 6v12M6 12h12"/><circle cx="12" cy="7" r="1.5" fill="currentColor"/></svg></span><span data-i18n="sidebar_colors">Colors</span></li>
                    </ul>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Section -->
                <div id="dashboard-section" class="content-section active">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_dashboard">Dashboard</div>
                        <div class="content-subtitle" data-i18n="subtitle_dashboard">Real-time server analytics</div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div data-i18n="stat_totalMembers" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Total Members</div>
                                <div id="totalMembersLive" style="font-size: 2rem; font-weight: 700; color: #00d4ff;">0</div>
                            </div>
                            <div style="background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div data-i18n="stat_verifiedUsers" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Verified Users</div>
                                <div id="verifiedMembersLive" style="font-size: 2rem; font-weight: 700; color: #00ff88;">0</div>
                            </div>
                            <div style="background: rgba(145,70,255,0.1); border: 1px solid rgba(145,70,255,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div data-i18n="stat_bots" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Bots</div>
                                <div id="botsLive" style="font-size: 2rem; font-weight: 700; color: #9146ff;">0</div>
                            </div>
                            <div style="background: rgba(255,105,180,0.1); border: 1px solid rgba(255,105,180,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div data-i18n="stat_admins" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Admins</div>
                                <div id="adminsLive" style="font-size: 2rem; font-weight: 700; color: #ff69b4;">0</div>
                            </div>
                            <div style="background: rgba(255,107,53,0.1); border: 1px solid rgba(255,107,53,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div data-i18n="stat_moderators" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Moderators</div>
                                <div id="modsLive" style="font-size: 2rem; font-weight: 700; color: #ff6b35;">0</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 1rem;">
                        <div data-i18n="heading_memberOverview" style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: rgba(255,255,255,0.9);">Member Overview</div>
                        <div class="content-grid wide">
                            <div class="panel">
                                <div class="panel-header"><div class="panel-title" data-i18n="panel_allMemberTypes">📊 All Member Types</div></div>
                                <div class="panel-content">
                                    <div class="graph-container"><canvas id="allMembersChart" width="400" height="350"></canvas></div>
                                </div>
                            </div>
                            <div class="panel" style="max-height: 500px; overflow-y: auto;">
                                <div class="panel-header"><div class="panel-title" data-i18n="panel_serverStaff">👑 Server Staff</div></div>
                                <div class="panel-content" id="staffPanel">
                                    <div style="color: rgba(255,255,255,0.5); padding: 1rem; text-align: center; font-size: 0.85rem;">Select a server to view staff</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Member Events Section -->
                <div id="events-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_memberActivity">Member Activity</div>
                        <div class="content-subtitle">Live member events: joins, leaves, invites, and boosts</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1 / -1;">
                            <div class="panel-header"><div class="panel-title">📜 Recent Member Events</div></div>
                            <div class="panel-content">
                                <div id="memberEventsList" style="display: flex; flex-direction: column; gap: 0.75rem; max-height: 400px; overflow-y: auto;">
                                    <div style="color: rgba(255, 255, 255, 0.5); padding: 1rem; text-align: center;">Loading events...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_settings">Settings</div>
                        <div class="content-subtitle" data-i18n="subtitle_settings">Configure bot settings and server preferences</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title" data-i18n="panel_botConfig">⚙️ Bot Configuration</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label" data-i18n="commandPrefix">Command Prefix</div>
                                    <input type="text" class="form-input" value="/" readonly disabled style="opacity: 0.6; cursor: not-allowed;" title="Slash commands only"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_botNickname">Bot Nickname</div>
                                    <input type="text" class="form-input" placeholder="SPIDEY BOT" value="SPIDEY BOT" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_botStatus">Bot Status</div>
                                    <select class="form-input" disabled style="opacity: 0.6; cursor: not-allowed;">
                                        <option selected>Online</option>
                                        <option>Idle</option>
                                        <option>Do Not Disturb</option>
                                        <option>Invisible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_botActivity">Bot Activity</div>
                                    <input type="text" class="form-input" placeholder="e.g., with commands // help" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="defaultLanguage">Default Language</div>
                                    <select class="form-input" id="languageSelect" onchange="changeLanguage(this.value)">
                                        <option value="en" selected>English</option>
                                        <option value="es">Español (Spanish)</option>
                                        <option value="fr">Français (French)</option>
                                        <option value="de">Deutsch (German)</option>
                                        <option value="pt">Português (Portuguese)</option>
                                        <option value="it">Italiano (Italian)</option>
                                        <option value="nl">Nederlands (Dutch)</option>
                                        <option value="pl">Polski (Polish)</option>
                                        <option value="ru">Русский (Russian)</option>
                                        <option value="ja">日本語 (Japanese)</option>
                                        <option value="ko">한국어 (Korean)</option>
                                        <option value="zh">中文 (Chinese)</option>
                                        <option value="ar">العربية (Arabic)</option>
                                        <option value="hi">हिन्दी (Hindi)</option>
                                        <option value="tr">Türkçe (Turkish)</option>
                                        <option value="sv">Svenska (Swedish)</option>
                                        <option value="da">Dansk (Danish)</option>
                                        <option value="no">Norsk (Norwegian)</option>
                                        <option value="fi">Suomi (Finnish)</option>
                                        <option value="cs">Čeština (Czech)</option>
                                        <option value="ro">Română (Romanian)</option>
                                        <option value="hu">Magyar (Hungarian)</option>
                                        <option value="uk">Українська (Ukrainian)</option>
                                        <option value="th">ไทย (Thai)</option>
                                        <option value="vi">Tiếng Việt (Vietnamese)</option>
                                        <option value="id">Bahasa Indonesia</option>
                                        <option value="ms">Bahasa Melayu (Malay)</option>
                                        <option value="el">Ελληνικά (Greek)</option>
                                        <option value="bg">Български (Bulgarian)</option>
                                        <option value="hr">Hrvatski (Croatian)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_timezone">Timezone (GMT)</div>
                                    <input type="text" class="form-input" placeholder="GMT" value="GMT" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title" data-i18n="panel_roleManagement">👥 Role Management</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_adminRole">Admin Role</div>
                                    <select class="form-input" id="adminRoleSelect">
                                        <option value="">Select admin role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_modRole">Moderator Role</div>
                                    <select class="form-input" id="modRoleSelect">
                                        <option value="">Select moderator role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_membersRole">Members Role</div>
                                    <select class="form-input" id="membersRoleSelect">
                                        <option value="">Select members role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_mutedRole">Muted Role</div>
                                    <select class="form-input" id="mutedRoleSelect">
                                        <option value="">Select muted role...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title" data-i18n="panel_channels">📝 Channels</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_generalChannel">General Channel</div>
                                    <select class="form-input" id="generalChannelSelect">
                                        <option value="">Select general channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_announcementsChannel">Announcements Channel</div>
                                    <select class="form-input" id="announcementsChannelSelect">
                                        <option value="">Select announcements channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label" data-i18n="label_welcomeChannel">Welcome Channel</div>
                                    <select class="form-input" id="welcomeChannelSelect">
                                        <option value="">Select welcome channel...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title" data-i18n="panel_featureToggles">✨ Feature Toggles</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_musicPlayer">Music Player</span><label class="toggle-switch"><input type="checkbox" id="toggle_musicPlayer" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_economySystem">Economy System</span><label class="toggle-switch"><input type="checkbox" id="toggle_economySystem" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_levelingSystem">Leveling System</span><label class="toggle-switch"><input type="checkbox" id="toggle_levelingSystem" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_welcomeMessages">Welcome Messages</span><label class="toggle-switch"><input type="checkbox" id="toggle_welcomeMessages" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_moderationTools">Moderation Tools</span><label class="toggle-switch"><input type="checkbox" id="toggle_moderationTools" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span data-i18n="toggle_socialNotifications">Social Notifications</span><label class="toggle-switch"><input type="checkbox" id="toggle_socialNotifications" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Logging Section -->
                <div id="logging-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_logging">Logging</div>
                        <div class="content-subtitle">Configure logging channels</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📝 Message Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Deleted Messages</span><label class="toggle-switch"><input type="checkbox" id="log_deleted" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Edited Messages</span><label class="toggle-switch"><input type="checkbox" id="log_edited" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Bulk Deletes</span><label class="toggle-switch"><input type="checkbox" id="log_bulkDelete"/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Log Channel</div>
                                    <select class="form-input" id="messageLogChannelSelect">
                                        <option value="">Select log channel...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">👤 Moderation Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Bans</span><label class="toggle-switch"><input type="checkbox" id="log_bans" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Kicks</span><label class="toggle-switch"><input type="checkbox" id="log_kicks" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Mutes</span><label class="toggle-switch"><input type="checkbox" id="log_mutes" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <label class="toggle-label"><span>Log Warns</span><label class="toggle-switch"><input type="checkbox" id="log_warns" checked/><span class="toggle-slider"></span></label></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Moderation Log Channel</div>
                                    <select class="form-input" id="modLogChannelSelect">
                                        <option value="">Select mod log channel...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Server Guard Section -->
                <div id="server-guard-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_serverGuard">Server Guard</div>
                        <div class="content-subtitle">Anti-spam and raid protection</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🛡️ Anti-Spam</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_antiSpamEnabled" checked/> Enable Anti-Spam</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Messages per 5s</div>
                                    <input type="number" id="sg_antiSpamLimit" class="form-input" placeholder="5" value="5"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Action</div>
                                    <select id="sg_antiSpamAction" class="form-input">
                                        <option value="warn">Warn</option>
                                        <option value="mute">Mute</option>
                                        <option value="kick">Kick</option>
                                        <option value="ban">Ban</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">⚠️ Raid Protection</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_raidEnabled" checked/> Enable Raid Detection</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Users per 10s</div>
                                    <input type="number" id="sg_raidLimit" class="form-input" placeholder="10" value="10"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_banRaidUsers"/> Ban Raid Users</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🔐 Permissions</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_membersOnly" checked/> <span>Only @Members can use commands</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_adminsBypass" checked/> <span>Admins bypass all restrictions</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_allowDM"/> <span>Allow DM commands</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_confirmDangerous" checked/> <span>Require confirmation for dangerous actions</span></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🚨 Anti-Nuke System</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_antiNukeEnabled" checked/> Enable Anti-Nuke</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Staff Activity Monitoring</div>
                                    <select id="sg_antiNukeMode" class="form-input">
                                        <option value="monitor">24/7 Monitoring</option>
                                        <option value="alert">Alert Only</option>
                                        <option value="lockdown">Auto-Lockdown</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Actions per 30s</div>
                                    <input type="number" id="sg_antiNukeLimit" class="form-input" placeholder="10" value="10"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🔗 Link Scanning</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_linkScanEnabled" checked/> Enable Link Scanning</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_detectPhishing" checked/> Detect Phishing</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_blockScamSites" checked/> Block Scam Sites</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_malwareDetection" checked/> Malware Detection</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🚪 Advanced Join Gate</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_joinGateEnabled" checked/> Enable Join Gate</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_accountAgeCheck" checked/> Account Age Check</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Min Account Age (days)</div>
                                    <input type="number" id="sg_minAccountAge" class="form-input" placeholder="3" value="3"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_suspiciousAvatars" checked/> Detect Suspicious Avatars</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_usernameAnalysis" checked/> Username Analysis</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📊 Rate Limiting</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_rateLimitEnabled" checked/> Enable Rate Limiting</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Requests per Minute</div>
                                    <input type="number" id="sg_rateLimitPerMin" class="form-input" placeholder="100" value="100"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_dosProtection" checked/> DoS Protection</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Response on Limit</div>
                                    <select id="sg_rateLimitAction" class="form-input">
                                        <option value="throttle">Throttle</option>
                                        <option value="block">Temporary Block</option>
                                        <option value="kick">Kick</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📝 Audit Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_auditLogEnabled" checked/> Enable Audit Logs</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Audit Log Channel</div>
                                    <select id="sg_auditLogChannel" class="form-input channel-select">
                                        <option value="">Select audit log channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_logApiRequests" checked/> Log All API Requests</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_ipTracking" checked/> Include IP Tracking</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💾 Backup System</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="sg_autoBackup" checked/> Auto-Backup Enabled</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Backup Frequency</div>
                                    <select id="sg_backupFrequency" class="form-input">
                                        <option value="6h">Every 6 Hours</option>
                                        <option value="daily">Daily</option>
                                        <option value="weekly">Weekly</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Retention Period</div>
                                    <input type="number" id="sg_backupRetention" class="form-input" placeholder="30" value="30"/>
                                    <div style="font-size: 0.7rem; color: rgba(255, 255, 255, 0.5); margin-top: 0.2rem;">days</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- React Roles Section -->
                <div id="react-roles-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_reactRoles">React Roles</div>
                        <div class="content-subtitle">Reaction-based role assignment — react to a message, get a role</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💎 Create Reaction Role</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <select id="rr_channelSelect" class="form-input channel-select">
                                        <option value="">Select channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Message ID</div>
                                    <input type="text" id="rr_messageId" class="form-input" placeholder="Right-click message → Copy Message ID"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Emoji</div>
                                    <input type="text" id="rr_emoji" class="form-input" placeholder="e.g. 🎮 or a custom emoji name"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Role to Assign</div>
                                    <select id="rr_roleSelect" class="form-input role-select">
                                        <option value="">Select role...</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="addReactRole()" style="width:100%;">➕ Add Reaction Role</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">⚙️ Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="rr_allowMultiple" checked/> Allow Multiple Roles</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="rr_removeOnUnreact" checked/> Remove Role on Unreact</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" id="rr_dmConfirm"/> DM User on Role Change</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Active Reaction Roles List -->
                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel" style="grid-column: 1 / -1;">
                            <div class="panel-header"><div class="panel-title">📋 Active Reaction Roles</div></div>
                            <div class="panel-content" id="rr_activeList">
                                <div style="color: rgba(255,255,255,0.5); text-align: center; padding: 1rem;">No reaction roles configured yet</div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Post Section -->
                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📨 Quick Post Role Selector</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(0,212,255,0.06); border:1px solid rgba(0,212,255,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Posts an embed message to a channel. Copy the Message ID from the posted message, then use the "Create Reaction Role" form above to attach emoji → role mappings to it.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Post to Channel</div>
                                    <select id="rr_postChannel" class="form-input channel-select">
                                        <option value="">Select channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Title</div>
                                    <input type="text" id="rr_postTitle" class="form-input" placeholder="e.g. Choose Your Roles!"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Description</div>
                                    <textarea id="rr_postDesc" class="form-input" rows="3" placeholder="React below to claim roles..."></textarea>
                                </div>
                                <button class="btn btn-primary" onclick="postReactRoleMessage()" style="width:100%;">📨 Post Reaction Role Message</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📜 Role Categories</div></div>
                            <div class="panel-content" id="rr_categoriesList">
                                <div style="color: rgba(255,255,255,0.5); text-align: center; padding: 1rem;">Loading categories...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Create Category + Post Category (side by side) -->
                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📂 Create Category</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(145,70,255,0.06); border:1px solid rgba(145,70,255,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Create a new role category with a name and roles. Same as <code>/create-category [name]</code> + <code>/addrole [category] [name] [id]</code>. After creating, use Post Category to send it to a channel.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Category Name</div>
                                    <input type="text" id="categoryName" class="form-input" placeholder="e.g. Competitive, Chill, Events..."/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Description <span style="font-size:0.75rem; color:rgba(255,255,255,0.4);">(optional)</span></div>
                                    <input type="text" id="categoryMessage" class="form-input" placeholder="Select a role below"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Select Roles</div>
                                    <div id="cc_roleSelect" class="custom-multiselect" data-placeholder="Click to select roles..."></div>
                                </div>
                                <button class="btn btn-primary" onclick="createRoleCategory()" style="width:100%;">📂 Create Category</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📤 Post Category Selector</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(0,212,255,0.06); border:1px solid rgba(0,212,255,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Pick a category and channel, then post a role selector embed with a dropdown. Members use the dropdown to self-assign roles. Same as <code>/setupcategory [name]</code>.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Category</div>
                                    <select id="sc_categorySelect" class="form-input">
                                        <option value="">Select a category...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Post to Channel</div>
                                    <select id="sc_channelSelect" class="form-input channel-select">
                                        <option value="">Select channel...</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="setupCategory()" style="width:100%;">📤 Post Category Selector</button>
                            </div>
                        </div>
                    </div>

                    <!-- Gaming Roles Section (full width) -->
                    <div class="content-grid" style="margin-top: 1rem; grid-template-columns: 1fr;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎮 Gaming Roles</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(0,212,255,0.06); border:1px solid rgba(0,212,255,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Add game roles here (e.g. Valorant, Minecraft). Members click the 🎮 button posted via Quick Setup → Gaming Roles to choose which games they play. Same as the bot command <code>/addgamerole [name] [roleID]</code>.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Select Roles</div>
                                    <div id="gr_roleSelect" class="custom-multiselect" data-placeholder="Click to select roles..."></div>
                                </div>
                                <button class="btn btn-primary" onclick="addTypedRole('game')" style="width:100%;">➕ Add Selected Gaming Roles</button>
                                <div id="gr_list" style="margin-top:0.75rem;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Watch Party + Platform Roles (side by side) -->
                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎬 Watch Party Roles</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(78,205,196,0.06); border:1px solid rgba(78,205,196,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Add streaming/watch party roles. Members click the 🎬 button from Quick Setup → Watch Party to join. Same as <code>/addwatchpartyrole [name] [roleID]</code>.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Select Roles</div>
                                    <div id="wp_roleSelect" class="custom-multiselect" data-placeholder="Click to select roles..."></div>
                                </div>
                                <button class="btn btn-primary" onclick="addTypedRole('watchparty')" style="width:100%;">➕ Add Selected Watch Party Roles</button>
                                <div id="wp_list" style="margin-top:0.75rem;"></div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💻 Platform Roles</div></div>
                            <div class="panel-content">
                                <div style="background:rgba(69,183,209,0.06); border:1px solid rgba(69,183,209,0.15); border-radius:8px; padding:0.75rem; margin-bottom:1rem; font-size:0.8rem; color:rgba(255,255,255,0.65);">
                                    💡 <strong>How it works:</strong> Add platform roles (PC, PlayStation, Xbox, etc). Members pick their platforms via the 💻 button from Quick Setup → Platform Roles. Same as <code>/addplatformrole [name] [roleID]</code>.
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Select Roles</div>
                                    <div id="pl_roleSelect" class="custom-multiselect" data-placeholder="Click to select roles..."></div>
                                </div>
                                <button class="btn btn-primary" onclick="addTypedRole('platform')" style="width:100%;">➕ Add Selected Platform Roles</button>
                                <div id="pl_list" style="margin-top:0.75rem;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- How Roles Work -->
                    <div class="content-grid" style="margin-top: 1rem; grid-template-columns: 1fr;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📖 How Roles Work</div></div>
                            <div class="panel-content">
                                <div style="font-size:0.85rem; color:rgba(255,255,255,0.7); line-height:1.7; display:grid; grid-template-columns: 1fr 1fr; gap: 0 2rem;">
                                    <p style="margin:0 0 0.5rem 0;"><strong>1.</strong> Add roles in the sections above (Gaming, Watch Party, Platform)</p>
                                    <p style="margin:0 0 0.5rem 0;"><strong>4.</strong> Members click the button → dropdown appears → they pick roles</p>
                                    <p style="margin:0 0 0.5rem 0;"><strong>2.</strong> Go to <strong>Quick Setup</strong> (below) and click the Post button for each type</p>
                                    <p style="margin:0 0 0.5rem 0;"><strong>5.</strong> For <strong>Reaction Roles</strong>: post a message, add emoji→role pairs above</p>
                                    <p style="margin:0 0 0.5rem 0;"><strong>3.</strong> The bot posts an embed with a button in your server</p>
                                    <p style="margin:0;"><strong>6.</strong> For <strong>Role Categories</strong>: create one above, then use Post Category or <code>/setupcategory [name]</code></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Setup Section -->
                <div id="quick-setup-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">⚡ Quick Setup Commands</div>
                        <div class="content-subtitle">One-click setup for popular role features</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎮 Gaming Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send gaming role selector message with button interaction</p>
                                <button class="btn btn-primary" onclick="quickSetup('gaming')" style="width: 100%;">Post Gaming Roles Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎬 Watch Party</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send watch party role selector message</p>
                                <button class="btn btn-primary" onclick="quickSetup('watchparty')" style="width: 100%;">Post Watch Party Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💻 Platform Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send platform role selector message</p>
                                <button class="btn btn-primary" onclick="quickSetup('platform')" style="width: 100%;">Post Platform Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🗑️ Remove Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send role removal message for members</p>
                                <button class="btn btn-primary" onclick="quickSetup('removeRoles')" style="width: 100%;">Post Remove Roles</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎖️ Auto Level Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Create 100 level roles with emoji badges (takes a moment)</p>
                                <button class="btn btn-primary" onclick="quickSetup('levelRoles')" style="width: 100%;">Create Level Roles 1-100</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activity Logging Section -->
                <div id="role-categories-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">📊 Activity Logs</div>
                        <div class="content-subtitle">Real-time tracking of all bot activities and events</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header">
                                <div class="panel-title">🔍 Filter Logs</div>
                                <button class="btn btn-primary" onclick="clearActivityLogs()" style="padding: 0.4rem 0.8rem; font-size: 0.85rem;">🗑️ Clear</button>
                            </div>
                            <div class="panel-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 🎤 Voice Events
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ⚠️ Moderation
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 💰 Economy
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 📈 Leveling
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 🎵 Music
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 👥 Members
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ⚙️ Config Changes
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> 📢 Alerts
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header"><div class="panel-title">📋 Recent Activities</div></div>
                            <div class="panel-content">
                                <div id="activityLogsList" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 1rem; min-height: 300px; max-height: 600px; overflow-y: auto; font-family: 'Monaco', 'Courier New', monospace; font-size: 0.85rem; line-height: 1.6;">
                                    <div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">
                                        ⏳ Waiting for activities... Messages will appear here as they happen
                                    </div>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); margin-top: 0.75rem; display: block;">
                                    📌 Auto-updates every 5 seconds | Maximum 500 logs stored | Older entries archived automatically
                                </small>
                            </div>
                        </div>

                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header"><div class="panel-title">📊 Log Statistics</div></div>
                            <div class="panel-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem;">
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statTotalLogs">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Total Logs</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statModeration">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Mod Actions</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statMembers">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Members Joined</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statLevelUps">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Level Ups</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Server Messages Section -->
                <div id="server-messages-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_serverMessages">Server Messages</div>
                        <div class="content-subtitle">Welcome and goodbye messages</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📨 Welcome Message</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> <span>Enable Welcome Messages</span></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Welcome Message</div>
                                    <textarea class="form-input" rows="3" placeholder="Welcome {user}! You are member #{count}">Welcome {user}! You are member #{count} in our server. Have fun!</textarea>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); display: block; margin-top: 0.5rem;">Use {user} for username, {count} for member number</small>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">👋 Goodbye Message</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> <span>Enable Goodbye Messages</span></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Goodbye Message</div>
                                    <textarea class="form-input" rows="3" placeholder="{user} has left the server...">{user} has left the server. We hope to see you again!</textarea>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); display: block; margin-top: 0.5rem;">Use {user} for username</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Commands Section -->
                <div id="custom-commands-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_customCommands">Custom Commands</div>
                        <div class="content-subtitle">Create custom bot commands</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">⚡ Create Command</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Command Name</div>
                                    <input type="text" class="form-input" placeholder="e.g., rules"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Response</div>
                                    <textarea class="form-input" placeholder="Command response" style="height: 80px;"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Require Role</div>
                                    <input type="text" class="form-input" placeholder="Leave empty for all"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveCustomCommands()">Create Command</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📝 Aliases</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Command</div>
                                    <select class="form-input">
                                        <option>-- Select Command --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Alias</div>
                                    <input type="text" class="form-input" placeholder="e.g., r (for rules)"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveCustomCommands()">Add Alias</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Components Section -->
                <div id="components-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_components">Components</div>
                        <div class="content-subtitle">Manage bot components and features</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🧩 Available Components</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Music Player</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Moderation</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Economy System</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Leveling/XP</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- XP Levels Section -->
                <div id="xp-levels-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_xpLevels">XP Levels</div>
                        <div class="content-subtitle">Configure leveling system</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">⭐ XP Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">XP per Message</div>
                                    <input type="number" class="form-input" placeholder="10-30" value="15"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP for Voice (per minute)</div>
                                    <input type="number" class="form-input" placeholder="1-5" value="2"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP per Level</div>
                                    <input type="number" class="form-input" placeholder="500" value="500"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveXPLevels()">Update</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎯 Level Roles</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Level</div>
                                    <input type="number" class="form-input" placeholder="e.g., 10"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Role</div>
                                    <input type="text" class="form-input" placeholder="Select role"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveXPLevels()">Add Level Role</button>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 1rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎯 Leveling Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">XP per Message</div>
                                    <input type="number" class="form-input" placeholder="10-30" value="10"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP to Level Up</div>
                                    <input type="number" class="form-input" placeholder="500" value="500"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Level</div>
                                    <input type="number" class="form-input" placeholder="100" value="100"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> <span>Auto-assign level roles</span></label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leaderboards Section -->
                <div id="leaderboards-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_leaderboards">Leaderboards</div>
                        <div class="content-subtitle">Configure leaderboard display</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🏆 Leaderboard Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Leaderboard</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Display Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Update Frequency</div>
                                    <select class="form-input">
                                        <option>Every Hour</option>
                                        <option>Every 6 Hours</option>
                                        <option>Daily</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Top Users to Show</div>
                                    <input type="number" class="form-input" placeholder="10" value="10"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Giveaways Section -->
                <div id="giveaways-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_giveaways">Giveaways</div>
                        <div class="content-subtitle">Manage giveaways</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎁 Start New Giveaway</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Prize</div>
                                    <input type="text" class="form-input" placeholder="e.g., Discord Nitro"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Duration (minutes)</div>
                                    <input type="number" class="form-input" placeholder="60"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Winners</div>
                                    <input type="number" class="form-input" placeholder="1" value="1"/>
                                </div>
                                <button class="btn btn-primary" onclick="createGiveaway()">Start Giveaway</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📊 Active Giveaways</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">No active giveaways</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Social Notifs Section -->
                <div id="social-notifs-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_socialNotifs">Social Notifications</div>
                        <div class="content-subtitle">Monitor Twitch, TikTok, Kick</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📡 Add Streamer</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Platform</div>
                                    <select class="form-input">
                                        <option>Twitch</option>
                                        <option>TikTok</option>
                                        <option>Kick</option>
                                        <option>YouTube</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Username</div>
                                    <input type="text" class="form-input" placeholder="Enter username"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Notification Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <button class="btn btn-primary" onclick="addStreamer()">Add Streamer</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📋 Monitored Accounts</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">No monitored accounts yet</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Invite Tracking Section -->
                <div id="invite-tracking-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_inviteTracking">Invite Tracking</div>
                        <div class="content-subtitle">Track member invites</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🔗 Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Invite Tracking</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Log Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Track Invite Links</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📊 Invite Leaderboard</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">Top inviters will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Message Counting Section -->
                <div id="message-counting-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_messageCounting">Message Counting</div>
                        <div class="content-subtitle">Track message statistics</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💭 Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Message Counting</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Ignore Channels</div>
                                    <input type="text" class="form-input" placeholder="Channel list (comma separated)"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> Count Bot Messages</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📈 Message Stats</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">Message statistics will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recordings Section -->
                <div id="recordings-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_recordings">Recordings</div>
                        <div class="content-subtitle">Manage voice recordings</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎚️ Recording Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> Enable Voice Recording</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Storage Location</div>
                                    <input type="text" class="form-input" placeholder="Select storage path"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Recording Duration (minutes)</div>
                                    <input type="number" class="form-input" placeholder="60" value="60"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📁 Recording Library</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">No recordings yet</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reminders Section -->
                <div id="reminders-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_reminders">Reminders</div>
                        <div class="content-subtitle">Configure reminders</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">⏱️ Create Reminder</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Reminder Title</div>
                                    <input type="text" class="form-input" placeholder="e.g., Daily Standup"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Message</div>
                                    <textarea class="form-input" placeholder="Reminder message" style="height: 80px;"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Time</div>
                                    <input type="time" class="form-input"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Repeat</div>
                                    <select class="form-input">
                                        <option>Once</option>
                                        <option>Daily</option>
                                        <option>Weekly</option>
                                        <option>Monthly</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="createReminder()">Create Reminder</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📅 Scheduled Reminders</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">No scheduled reminders</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Channels Section -->
                <div id="statistics-channels-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_statsChannels">Statistics Channels</div>
                        <div class="content-subtitle">Display server statistics</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📈 Channel Statistics</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Statistic Type</div>
                                    <select class="form-input">
                                        <option>Member Count</option>
                                        <option>Bot Count</option>
                                        <option>Server Level</option>
                                        <option>Total Messages</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Auto-Update</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Update Frequency (minutes)</div>
                                    <input type="number" class="form-input" placeholder="5" value="5"/>
                                </div>
                                <button class="btn btn-primary" onclick="addStatChannel()">Add Stat Channel</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">📊 Active Stats</div></div>
                            <div class="panel-content">
                                <div style="color: rgba(255, 255, 255, 0.6); text-align: center; padding: 2rem;">No stat channels configured</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subscriptions Section -->
                <div id="subscriptions-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_premium">Premium Subscriptions</div>
                        <div class="content-subtitle">Manage premium features</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">💳 Current Plan</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Status</div>
                                    <div style="color: rgba(0, 212, 255, 1); font-weight: 600;">✓ Premium Active</div>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Plan Type</div>
                                    <div style="font-size: 1.1rem; font-weight: 500;">Pro Tier</div>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Renewal Date</div>
                                    <div>January 15, 2025</div>
                                </div>
                                <button class="btn btn-primary" onclick="alert('✅ Subscription management interface')">Manage Subscription</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎯 Features Included</div></div>
                            <div class="panel-content">
                                <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: rgba(0, 212, 255, 1);">✓</span> <span>Unlimited Custom Commands</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: rgba(0, 212, 255, 1);">✓</span> <span>Advanced Analytics</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: rgba(0, 212, 255, 1);">✓</span> <span>Priority Support</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="color: rgba(0, 212, 255, 1);">✓</span> <span>Custom Branding</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Colors Section -->
                <div id="colors-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title" data-i18n="title_colors">UI Colors</div>
                        <div class="content-subtitle">Customize dashboard colors</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🎨 Theme Colors</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Primary Theme Color</div>
                                    <div class="color-picker-wrapper">
                                        <input type="color" id="themeColorPicker" class="color-picker" value="#00d4ff" onchange="changeThemeColor(this.value)"/>
                                        <span class="color-label" id="themeColorLabel">#00d4ff (Cyan)</span>
                                    </div>
                                </div>
                                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--theme-color), 0.2);">
                                    <p style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.6); margin-bottom: 1rem;">25 Color Themes:</p>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(50px, 1fr)); gap: 0.6rem;">
                                        <button class="color-preset" style="background: #00d4ff;" onclick="changeThemeColor('#00d4ff')" title="Cyan"></button>
                                        <button class="color-preset" style="background: #9146ff;" onclick="changeThemeColor('#9146ff')" title="Purple"></button>
                                        <button class="color-preset" style="background: #ff69b4;" onclick="changeThemeColor('#ff69b4')" title="Pink"></button>
                                        <button class="color-preset" style="background: #00ff88;" onclick="changeThemeColor('#00ff88')" title="Green"></button>
                                        <button class="color-preset" style="background: #ff6b35;" onclick="changeThemeColor('#ff6b35')" title="Orange"></button>
                                        <button class="color-preset" style="background: #00ffff;" onclick="changeThemeColor('#00ffff')" title="Aqua"></button>
                                        <button class="color-preset" style="background: #ff0055;" onclick="changeThemeColor('#ff0055')" title="Red"></button>
                                        <button class="color-preset" style="background: #1e90ff;" onclick="changeThemeColor('#1e90ff')" title="Blue"></button>
                                        <button class="color-preset" style="background: #ffff00;" onclick="changeThemeColor('#ffff00')" title="Yellow"></button>
                                        <button class="color-preset" style="background: #00ff00;" onclick="changeThemeColor('#00ff00')" title="Lime"></button>
                                        <button class="color-preset" style="background: #ff00ff;" onclick="changeThemeColor('#ff00ff')" title="Magenta"></button>
                                        <button class="color-preset" style="background: #20b2aa;" onclick="changeThemeColor('#20b2aa')" title="Teal"></button>
                                        <button class="color-preset" style="background: #4b0082;" onclick="changeThemeColor('#4b0082')" title="Indigo"></button>
                                        <button class="color-preset" style="background: #ee82ee;" onclick="changeThemeColor('#ee82ee')" title="Violet"></button>
                                        <button class="color-preset" style="background: #ff1493;" onclick="changeThemeColor('#ff1493')" title="Deep Pink"></button>
                                        <button class="color-preset" style="background: #dc143c;" onclick="changeThemeColor('#dc143c')" title="Crimson"></button>
                                        <button class="color-preset" style="background: #ff7f50;" onclick="changeThemeColor('#ff7f50')" title="Coral"></button>
                                        <button class="color-preset" style="background: #ffa07a;" onclick="changeThemeColor('#ffa07a')" title="Light Salmon"></button>
                                        <button class="color-preset" style="background: #ffd700;" onclick="changeThemeColor('#ffd700')" title="Gold"></button>
                                        <button class="color-preset" style="background: #c0c0c0;" onclick="changeThemeColor('#c0c0c0')" title="Silver"></button>
                                        <button class="color-preset" style="background: #40e0d0;" onclick="changeThemeColor('#40e0d0')" title="Turquoise"></button>
                                        <button class="color-preset" style="background: #000080;" onclick="changeThemeColor('#000080')" title="Navy"></button>
                                        <button class="color-preset" style="background: #800000;" onclick="changeThemeColor('#800000')" title="Maroon"></button>
                                        <button class="color-preset" style="background: #808000;" onclick="changeThemeColor('#808000')" title="Olive"></button>
                                        <button class="color-preset" style="background: #87ceeb;" onclick="changeThemeColor('#87ceeb')" title="Sky Blue"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🌈 Accent Colors</div></div>
                            <div class="panel-content">
                                <div style="display: flex; flex-direction: column; gap: 1.2rem;">
                                    <div class="form-group">
                                        <div class="form-label">Cyan Accent</div>
                                        <div class="color-picker-wrapper">
                                            <input type="color" id="cyanColorPicker" class="color-picker" value="#00d4ff" onchange="changeCyanAccent(this.value)"/>
                                            <span class="color-label" id="cyanColorLabel">#00d4ff</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="form-label">Purple Accent</div>
                                        <div class="color-picker-wrapper">
                                            <input type="color" id="purpleColorPicker" class="color-picker" value="#9146ff" onchange="changePurpleAccent(this.value)"/>
                                            <span class="color-label" id="purpleColorLabel">#9146ff</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="form-label">Pink Accent</div>
                                        <div class="color-picker-wrapper">
                                            <input type="color" id="pinkColorPicker" class="color-picker" value="#ff69b4" onchange="changePinkAccent(this.value)"/>
                                            <span class="color-label" id="pinkColorLabel">#ff69b4</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">🔤 Text Color</div></div>
                            <div class="panel-content">
                                <div style="display: flex; flex-direction: column; gap: 1.2rem;">
                                    <div class="form-group">
                                        <div class="form-label">Text Color</div>
                                        <div class="color-picker-wrapper">
                                            <input type="color" id="textColorPicker" class="color-picker" value="#ffffff" onchange="changeTextColor(this.value)"/>
                                            <span class="color-label" id="textColorLabel">#ffffff</span>
                                        </div>
                                    </div>
                                    <div style="padding: 1rem; background: rgba(var(--theme-color), 0.1); border: 1px solid rgba(var(--theme-color), 0.3); border-radius: 6px; text-align: center;">
                                        <div style="font-size: 0.9rem;">Preview Text Color</div>
                                    </div>
                                    <small style="color: rgba(255, 255, 255, 0.5);">Note: Text color changes based on light/dark mode</small>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">👁️ Preview</div></div>
                            <div class="panel-content">
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="padding: 1rem; background: rgba(var(--theme-color), 0.1); border: 1px solid rgba(var(--theme-color), 0.3); border-radius: 6px;">
                                        <div style="font-weight: 600; color: rgba(var(--theme-color), 1); margin-bottom: 0.5rem;">Sample Element</div>
                                        <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">This shows how your selected color looks</div>
                                    </div>
                                    <button class="btn btn-primary" onclick="resetColors()">Reset to Default</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== TOAST NOTIFICATION SYSTEM ==========
        function showToast(message, type = 'info', duration = 4000) {
            const container = document.getElementById('toastContainer');
            if (!container) { console.log(message); return; }
            // Parse type from message content if not specified
            if (type === 'info') {
                if (message.startsWith('✅')) type = 'success';
                else if (message.startsWith('❌')) type = 'error';
                else if (message.startsWith('⚠️') || message.startsWith('⏳')) type = 'warning';
            }
            const icons = { success: '✅', error: '❌', warning: '⚠️', info: 'ℹ️' };
            const titles = { success: 'Success', error: 'Error', warning: 'Warning', info: 'Info' };
            // Clean emoji prefix from message for cleaner display
            let cleanMsg = message.replace(/^[✅❌⚠️⏳ℹ️🔄💡📨]\s*/, '').trim();
            // Handle multi-line messages
            cleanMsg = cleanMsg.replace(/\n/g, '<br>');

            const toast = document.createElement('div');
            toast.className = 'toast toast-' + type;
            toast.style.position = 'relative';
            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-body">
                    <div class="toast-title">${titles[type]}</div>
                    <div class="toast-msg">${cleanMsg}</div>
                </div>
                <div class="toast-progress" style="animation-duration: ${duration}ms;"></div>
            `;
            toast.onclick = () => dismissToast(toast);
            container.appendChild(toast);

            // Auto-dismiss
            const timer = setTimeout(() => dismissToast(toast), duration);
            toast._timer = timer;

            // Cap at 5 visible toasts
            while (container.children.length > 5) {
                dismissToast(container.children[0]);
            }
        }

        function dismissToast(toast) {
            if (!toast || toast._dismissed) return;
            toast._dismissed = true;
            clearTimeout(toast._timer);
            toast.classList.add('hiding');
            setTimeout(() => toast.remove(), 300);
        }

        // Override global alert to use toast
        const _origAlert = window.alert;
        window.alert = function(msg) {
            showToast(String(msg));
        };

        // ========== I18N TRANSLATION ENGINE ==========
        const translations = {
            en: {},
            es: {
                overlay_selectServer: 'Seleccionar un Servidor', overlay_selectServerDesc: 'Elige un servidor del menú superior para ver su panel y gestionar configuraciones.',
                nav_main: 'PRINCIPAL', nav_core: 'NÚCLEO', nav_features: 'FUNCIONES', nav_systems: 'SISTEMAS', nav_monitoring: 'MONITOREO', nav_advanced: 'AVANZADO', nav_subscriptions: 'SUSCRIPCIONES', nav_tools: 'HERRAMIENTAS',
                sidebar_dashboard: 'Panel', sidebar_settings: 'Configuración', sidebar_logging: 'Registros', sidebar_serverGuard: 'Guardia del Servidor', sidebar_reactRoles: 'Roles de Reacción', sidebar_roleCategories: 'Categorías de Roles', sidebar_serverMessages: 'Mensajes del Servidor', sidebar_commands: 'Comandos', sidebar_components: 'Componentes', sidebar_xpLevels: 'Niveles XP', sidebar_leaderboards: 'Clasificaciones', sidebar_giveaways: 'Sorteos', sidebar_memberActivity: 'Actividad de Miembros', sidebar_socialNotifs: 'Notificaciones', sidebar_invites: 'Invitaciones', sidebar_messages: 'Mensajes', sidebar_recordings: 'Grabaciones', sidebar_reminders: 'Recordatorios', sidebar_stats: 'Estadísticas', sidebar_premium: 'Premium', sidebar_colors: 'Colores',
                title_dashboard: 'Panel', subtitle_dashboard: 'Análisis del servidor en tiempo real', title_settings: 'Configuración', subtitle_settings: 'Configurar el bot y preferencias del servidor', title_logging: 'Registros', title_serverGuard: 'Guardia del Servidor', title_reactRoles: 'Roles de Reacción', title_serverMessages: 'Mensajes del Servidor', title_customCommands: 'Comandos Personalizados', title_components: 'Componentes', title_xpLevels: 'Niveles XP', title_leaderboards: 'Clasificaciones', title_giveaways: 'Sorteos', title_memberActivity: 'Actividad de Miembros', title_socialNotifs: 'Notificaciones Sociales', title_inviteTracking: 'Seguimiento de Invitaciones', title_messageCounting: 'Conteo de Mensajes', title_recordings: 'Grabaciones', title_reminders: 'Recordatorios', title_statsChannels: 'Canales de Estadísticas', title_premium: 'Suscripciones Premium', title_colors: 'Colores de Interfaz',
                stat_totalMembers: 'Miembros Totales', stat_verifiedUsers: 'Usuarios Verificados', stat_bots: 'Bots', stat_admins: 'Administradores', stat_moderators: 'Moderadores', heading_memberOverview: 'Resumen de Miembros',
                panel_allMemberTypes: '📊 Todos los Tipos de Miembros', panel_serverStaff: '👑 Personal del Servidor', panel_botConfig: '⚙️ Configuración del Bot', panel_roleManagement: '👥 Gestión de Roles', panel_channels: '📝 Canales', panel_featureToggles: '✨ Funciones',
                commandPrefix: 'Prefijo de Comando', defaultLanguage: 'Idioma Predeterminado', label_botNickname: 'Apodo del Bot', label_botStatus: 'Estado del Bot', label_botActivity: 'Actividad del Bot', label_timezone: 'Zona Horaria (GMT)',
                label_adminRole: 'Rol de Administrador', label_modRole: 'Rol de Moderador', label_membersRole: 'Rol de Miembros', label_mutedRole: 'Rol de Silenciado',
                label_generalChannel: 'Canal General', label_announcementsChannel: 'Canal de Anuncios', label_welcomeChannel: 'Canal de Bienvenida',
                toggle_musicPlayer: 'Reproductor de Música', toggle_economySystem: 'Sistema de Economía', toggle_levelingSystem: 'Sistema de Niveles', toggle_welcomeMessages: 'Mensajes de Bienvenida', toggle_moderationTools: 'Herramientas de Moderación', toggle_socialNotifications: 'Notificaciones Sociales'
            },
            fr: {
                overlay_selectServer: 'Sélectionner un Serveur', overlay_selectServerDesc: 'Choisissez un serveur dans le menu ci-dessus pour afficher son tableau de bord et gérer les paramètres.',
                nav_main: 'PRINCIPAL', nav_core: 'BASE', nav_features: 'FONCTIONNALITÉS', nav_systems: 'SYSTÈMES', nav_monitoring: 'SURVEILLANCE', nav_advanced: 'AVANCÉ', nav_subscriptions: 'ABONNEMENTS', nav_tools: 'OUTILS',
                sidebar_dashboard: 'Tableau de bord', sidebar_settings: 'Paramètres', sidebar_logging: 'Journaux', sidebar_serverGuard: 'Garde du Serveur', sidebar_reactRoles: 'Rôles de Réaction', sidebar_roleCategories: 'Catégories de Rôles', sidebar_serverMessages: 'Messages du Serveur', sidebar_commands: 'Commandes', sidebar_components: 'Composants', sidebar_xpLevels: 'Niveaux XP', sidebar_leaderboards: 'Classements', sidebar_giveaways: 'Concours', sidebar_memberActivity: 'Activité des Membres', sidebar_socialNotifs: 'Notifications', sidebar_invites: 'Invitations', sidebar_messages: 'Messages', sidebar_recordings: 'Enregistrements', sidebar_reminders: 'Rappels', sidebar_stats: 'Statistiques', sidebar_premium: 'Premium', sidebar_colors: 'Couleurs',
                title_dashboard: 'Tableau de bord', subtitle_dashboard: 'Analyses du serveur en temps réel', title_settings: 'Paramètres', subtitle_settings: 'Configurer le bot et les préférences du serveur', title_logging: 'Journaux', title_serverGuard: 'Garde du Serveur', title_reactRoles: 'Rôles de Réaction', title_serverMessages: 'Messages du Serveur', title_customCommands: 'Commandes Personnalisées', title_components: 'Composants', title_xpLevels: 'Niveaux XP', title_leaderboards: 'Classements', title_giveaways: 'Concours', title_memberActivity: 'Activité des Membres', title_socialNotifs: 'Notifications Sociales', title_inviteTracking: 'Suivi des Invitations', title_messageCounting: 'Compteur de Messages', title_recordings: 'Enregistrements', title_reminders: 'Rappels', title_statsChannels: 'Canaux de Statistiques', title_premium: 'Abonnements Premium', title_colors: 'Couleurs de l\'Interface',
                stat_totalMembers: 'Membres Totaux', stat_verifiedUsers: 'Utilisateurs Vérifiés', stat_bots: 'Bots', stat_admins: 'Administrateurs', stat_moderators: 'Modérateurs', heading_memberOverview: 'Aperçu des Membres',
                panel_allMemberTypes: '📊 Tous les Types de Membres', panel_serverStaff: '👑 Personnel du Serveur', panel_botConfig: '⚙️ Configuration du Bot', panel_roleManagement: '👥 Gestion des Rôles', panel_channels: '📝 Canaux', panel_featureToggles: '✨ Fonctionnalités',
                commandPrefix: 'Préfixe de Commande', defaultLanguage: 'Langue par Défaut', label_botNickname: 'Surnom du Bot', label_botStatus: 'Statut du Bot', label_botActivity: 'Activité du Bot', label_timezone: 'Fuseau Horaire (GMT)',
                label_adminRole: 'Rôle Administrateur', label_modRole: 'Rôle Modérateur', label_membersRole: 'Rôle Membres', label_mutedRole: 'Rôle Muet',
                label_generalChannel: 'Canal Général', label_announcementsChannel: 'Canal d\'Annonces', label_welcomeChannel: 'Canal de Bienvenue',
                toggle_musicPlayer: 'Lecteur Musique', toggle_economySystem: 'Système Économique', toggle_levelingSystem: 'Système de Niveaux', toggle_welcomeMessages: 'Messages de Bienvenue', toggle_moderationTools: 'Outils de Modération', toggle_socialNotifications: 'Notifications Sociales'
            },
            de: {
                overlay_selectServer: 'Server auswählen', overlay_selectServerDesc: 'Wähle einen Server aus dem Dropdown oben, um das Dashboard zu sehen und Einstellungen zu verwalten.',
                nav_main: 'HAUPT', nav_core: 'KERN', nav_features: 'FUNKTIONEN', nav_systems: 'SYSTEME', nav_monitoring: 'ÜBERWACHUNG', nav_advanced: 'ERWEITERT', nav_subscriptions: 'ABONNEMENTS', nav_tools: 'WERKZEUGE',
                sidebar_dashboard: 'Dashboard', sidebar_settings: 'Einstellungen', sidebar_logging: 'Protokolle', sidebar_serverGuard: 'Server-Schutz', sidebar_reactRoles: 'Reaktionsrollen', sidebar_roleCategories: 'Rollenkategorien', sidebar_serverMessages: 'Servernachrichten', sidebar_commands: 'Befehle', sidebar_components: 'Komponenten', sidebar_xpLevels: 'XP-Stufen', sidebar_leaderboards: 'Bestenlisten', sidebar_giveaways: 'Verlosungen', sidebar_memberActivity: 'Mitgliederaktivität', sidebar_socialNotifs: 'Benachrichtigungen', sidebar_invites: 'Einladungen', sidebar_messages: 'Nachrichten', sidebar_recordings: 'Aufnahmen', sidebar_reminders: 'Erinnerungen', sidebar_stats: 'Statistiken', sidebar_premium: 'Premium', sidebar_colors: 'Farben',
                title_dashboard: 'Dashboard', subtitle_dashboard: 'Echtzeit-Serveranalysen', title_settings: 'Einstellungen', subtitle_settings: 'Bot-Einstellungen und Serverpräferenzen konfigurieren', title_logging: 'Protokolle', title_serverGuard: 'Server-Schutz', title_reactRoles: 'Reaktionsrollen', title_serverMessages: 'Servernachrichten', title_customCommands: 'Benutzerdefinierte Befehle', title_components: 'Komponenten', title_xpLevels: 'XP-Stufen', title_leaderboards: 'Bestenlisten', title_giveaways: 'Verlosungen', title_memberActivity: 'Mitgliederaktivität', title_socialNotifs: 'Soziale Benachrichtigungen', title_inviteTracking: 'Einladungsverfolgung', title_messageCounting: 'Nachrichtenzählung', title_recordings: 'Aufnahmen', title_reminders: 'Erinnerungen', title_statsChannels: 'Statistikkanäle', title_premium: 'Premium-Abonnements', title_colors: 'UI-Farben',
                stat_totalMembers: 'Gesamtmitglieder', stat_verifiedUsers: 'Verifizierte Benutzer', stat_bots: 'Bots', stat_admins: 'Administratoren', stat_moderators: 'Moderatoren', heading_memberOverview: 'Mitgliederübersicht',
                panel_allMemberTypes: '📊 Alle Mitgliedertypen', panel_serverStaff: '👑 Serverpersonal', panel_botConfig: '⚙️ Bot-Konfiguration', panel_roleManagement: '👥 Rollenverwaltung', panel_channels: '📝 Kanäle', panel_featureToggles: '✨ Funktionen',
                commandPrefix: 'Befehlspräfix', defaultLanguage: 'Standardsprache', label_botNickname: 'Bot-Spitzname', label_botStatus: 'Bot-Status', label_botActivity: 'Bot-Aktivität', label_timezone: 'Zeitzone (GMT)',
                label_adminRole: 'Admin-Rolle', label_modRole: 'Moderator-Rolle', label_membersRole: 'Mitglieder-Rolle', label_mutedRole: 'Stummgeschaltet-Rolle',
                label_generalChannel: 'Allgemeiner Kanal', label_announcementsChannel: 'Ankündigungskanal', label_welcomeChannel: 'Willkommenskanal',
                toggle_musicPlayer: 'Musikspieler', toggle_economySystem: 'Wirtschaftssystem', toggle_levelingSystem: 'Levelsystem', toggle_welcomeMessages: 'Willkommensnachrichten', toggle_moderationTools: 'Moderationstools', toggle_socialNotifications: 'Soziale Benachrichtigungen'
            },
            pt: {
                nav_main: 'PRINCIPAL', nav_core: 'NÚCLEO', nav_features: 'RECURSOS', nav_systems: 'SISTEMAS', nav_monitoring: 'MONITORAMENTO', nav_advanced: 'AVANÇADO', nav_subscriptions: 'ASSINATURAS', nav_tools: 'FERRAMENTAS',
                sidebar_dashboard: 'Painel', sidebar_settings: 'Configurações', sidebar_logging: 'Registros', sidebar_serverGuard: 'Guarda do Servidor', sidebar_reactRoles: 'Cargos de Reação', sidebar_roleCategories: 'Categorias de Cargos', sidebar_serverMessages: 'Mensagens do Servidor', sidebar_commands: 'Comandos', sidebar_components: 'Componentes', sidebar_xpLevels: 'Níveis XP', sidebar_leaderboards: 'Classificações', sidebar_giveaways: 'Sorteios', sidebar_memberActivity: 'Atividade de Membros', sidebar_socialNotifs: 'Notificações', sidebar_invites: 'Convites', sidebar_messages: 'Mensagens', sidebar_recordings: 'Gravações', sidebar_reminders: 'Lembretes', sidebar_stats: 'Estatísticas', sidebar_premium: 'Premium', sidebar_colors: 'Cores',
                title_dashboard: 'Painel', subtitle_dashboard: 'Análises do servidor em tempo real', title_settings: 'Configurações', subtitle_settings: 'Configurar bot e preferências do servidor',
                stat_totalMembers: 'Total de Membros', stat_verifiedUsers: 'Usuários Verificados', stat_bots: 'Bots', stat_admins: 'Administradores', stat_moderators: 'Moderadores', heading_memberOverview: 'Visão Geral dos Membros',
                panel_botConfig: '⚙️ Configuração do Bot', panel_roleManagement: '👥 Gerenciamento de Cargos', panel_channels: '📝 Canais', panel_featureToggles: '✨ Recursos',
                commandPrefix: 'Prefixo de Comando', defaultLanguage: 'Idioma Padrão', label_botNickname: 'Apelido do Bot', label_botStatus: 'Status do Bot', label_botActivity: 'Atividade do Bot', label_timezone: 'Fuso Horário (GMT)',
                label_adminRole: 'Cargo Admin', label_modRole: 'Cargo Moderador', label_membersRole: 'Cargo Membros', label_mutedRole: 'Cargo Silenciado',
                label_generalChannel: 'Canal Geral', label_announcementsChannel: 'Canal de Anúncios', label_welcomeChannel: 'Canal de Boas-Vindas',
                toggle_musicPlayer: 'Tocador de Música', toggle_economySystem: 'Sistema Econômico', toggle_levelingSystem: 'Sistema de Níveis', toggle_welcomeMessages: 'Mensagens de Boas-Vindas', toggle_moderationTools: 'Ferramentas de Moderação', toggle_socialNotifications: 'Notificações Sociais'
            },
            it: {
                nav_main: 'PRINCIPALE', nav_core: 'BASE', nav_features: 'FUNZIONALITÀ', nav_systems: 'SISTEMI', nav_monitoring: 'MONITORAGGIO', nav_advanced: 'AVANZATO', nav_subscriptions: 'ABBONAMENTI', nav_tools: 'STRUMENTI',
                sidebar_dashboard: 'Pannello', sidebar_settings: 'Impostazioni', sidebar_logging: 'Registri', sidebar_serverGuard: 'Guardia del Server', sidebar_reactRoles: 'Ruoli di Reazione', sidebar_roleCategories: 'Categorie Ruoli', sidebar_serverMessages: 'Messaggi del Server', sidebar_commands: 'Comandi', sidebar_components: 'Componenti', sidebar_xpLevels: 'Livelli XP', sidebar_leaderboards: 'Classifiche', sidebar_giveaways: 'Giveaway', sidebar_memberActivity: 'Attività Membri', sidebar_socialNotifs: 'Notifiche', sidebar_invites: 'Inviti', sidebar_messages: 'Messaggi', sidebar_recordings: 'Registrazioni', sidebar_reminders: 'Promemoria', sidebar_stats: 'Statistiche', sidebar_premium: 'Premium', sidebar_colors: 'Colori',
                title_dashboard: 'Pannello', subtitle_dashboard: 'Analisi del server in tempo reale', title_settings: 'Impostazioni', subtitle_settings: 'Configura il bot e le preferenze del server',
                stat_totalMembers: 'Membri Totali', stat_verifiedUsers: 'Utenti Verificati', stat_bots: 'Bot', stat_admins: 'Amministratori', stat_moderators: 'Moderatori', heading_memberOverview: 'Panoramica Membri',
                panel_botConfig: '⚙️ Configurazione Bot', panel_roleManagement: '👥 Gestione Ruoli', panel_channels: '📝 Canali', panel_featureToggles: '✨ Funzionalità',
                commandPrefix: 'Prefisso Comando', defaultLanguage: 'Lingua Predefinita', label_botNickname: 'Soprannome Bot', label_botStatus: 'Stato Bot', label_botActivity: 'Attività Bot', label_timezone: 'Fuso Orario (GMT)',
                label_adminRole: 'Ruolo Admin', label_modRole: 'Ruolo Moderatore', label_membersRole: 'Ruolo Membri', label_mutedRole: 'Ruolo Silenziato',
                toggle_musicPlayer: 'Lettore Musicale', toggle_economySystem: 'Sistema Economico', toggle_levelingSystem: 'Sistema di Livelli', toggle_welcomeMessages: 'Messaggi di Benvenuto', toggle_moderationTools: 'Strumenti di Moderazione', toggle_socialNotifications: 'Notifiche Sociali'
            },
            nl: {
                nav_main: 'HOOFD', nav_core: 'KERN', nav_features: 'FUNCTIES', nav_systems: 'SYSTEMEN', nav_monitoring: 'MONITORING', nav_advanced: 'GEAVANCEERD', nav_subscriptions: 'ABONNEMENTEN', nav_tools: 'GEREEDSCHAP',
                sidebar_dashboard: 'Dashboard', sidebar_settings: 'Instellingen', sidebar_logging: 'Logboeken', sidebar_serverGuard: 'Server Bewaker', sidebar_reactRoles: 'Reactie Rollen', sidebar_roleCategories: 'Rolcategorieën', sidebar_serverMessages: 'Serverberichten', sidebar_commands: 'Commando\'s', sidebar_components: 'Componenten', sidebar_xpLevels: 'XP Niveaus', sidebar_leaderboards: 'Ranglijsten', sidebar_giveaways: 'Weggeefacties', sidebar_memberActivity: 'Ledenactiviteit', sidebar_socialNotifs: 'Meldingen', sidebar_invites: 'Uitnodigingen', sidebar_messages: 'Berichten', sidebar_recordings: 'Opnames', sidebar_reminders: 'Herinneringen', sidebar_stats: 'Statistieken', sidebar_premium: 'Premium', sidebar_colors: 'Kleuren',
                title_dashboard: 'Dashboard', subtitle_dashboard: 'Realtime serveranalyses', title_settings: 'Instellingen', subtitle_settings: 'Bot-instellingen en servervoorkeuren configureren',
                stat_totalMembers: 'Totaal Leden', stat_verifiedUsers: 'Geverifieerde Gebruikers', stat_bots: 'Bots', stat_admins: 'Beheerders', stat_moderators: 'Moderatoren', heading_memberOverview: 'Ledenoverzicht',
                commandPrefix: 'Commandoprefix', defaultLanguage: 'Standaardtaal',
                toggle_musicPlayer: 'Muziekspeler', toggle_economySystem: 'Economiesysteem', toggle_levelingSystem: 'Nivellering', toggle_welcomeMessages: 'Welkomstberichten', toggle_moderationTools: 'Moderatietools', toggle_socialNotifications: 'Sociale Meldingen'
            },
            pl: {
                nav_main: 'GŁÓWNE', nav_core: 'RDZEŃ', nav_features: 'FUNKCJE', nav_systems: 'SYSTEMY', nav_monitoring: 'MONITORING', nav_advanced: 'ZAAWANSOWANE', nav_subscriptions: 'SUBSKRYPCJE', nav_tools: 'NARZĘDZIA',
                sidebar_dashboard: 'Panel', sidebar_settings: 'Ustawienia', sidebar_logging: 'Logi', sidebar_serverGuard: 'Strażnik Serwera', sidebar_reactRoles: 'Role Reakcji', sidebar_commands: 'Polecenia', sidebar_components: 'Komponenty', sidebar_xpLevels: 'Poziomy XP', sidebar_leaderboards: 'Rankingi', sidebar_giveaways: 'Konkursy', sidebar_memberActivity: 'Aktywność Członków', sidebar_invites: 'Zaproszenia', sidebar_messages: 'Wiadomości', sidebar_recordings: 'Nagrania', sidebar_reminders: 'Przypomnienia', sidebar_stats: 'Statystyki', sidebar_premium: 'Premium', sidebar_colors: 'Kolory',
                title_dashboard: 'Panel', subtitle_dashboard: 'Analiza serwera w czasie rzeczywistym', title_settings: 'Ustawienia', subtitle_settings: 'Konfiguracja bota i preferencji serwera',
                stat_totalMembers: 'Wszystkich Członków', stat_verifiedUsers: 'Zweryfikowani', stat_bots: 'Boty', stat_admins: 'Administratorzy', stat_moderators: 'Moderatorzy',
                commandPrefix: 'Prefiks Polecenia', defaultLanguage: 'Domyślny Język'
            },
            ru: {
                nav_main: 'ГЛАВНОЕ', nav_core: 'ОСНОВНОЕ', nav_features: 'ФУНКЦИИ', nav_systems: 'СИСТЕМЫ', nav_monitoring: 'МОНИТОРИНГ', nav_advanced: 'РАСШИРЕННОЕ', nav_subscriptions: 'ПОДПИСКИ', nav_tools: 'ИНСТРУМЕНТЫ',
                sidebar_dashboard: 'Панель', sidebar_settings: 'Настройки', sidebar_logging: 'Логи', sidebar_serverGuard: 'Защита Сервера', sidebar_reactRoles: 'Роли Реакций', sidebar_roleCategories: 'Категории Ролей', sidebar_serverMessages: 'Сообщения Сервера', sidebar_commands: 'Команды', sidebar_components: 'Компоненты', sidebar_xpLevels: 'Уровни XP', sidebar_leaderboards: 'Рейтинги', sidebar_giveaways: 'Розыгрыши', sidebar_memberActivity: 'Активность Участников', sidebar_socialNotifs: 'Уведомления', sidebar_invites: 'Приглашения', sidebar_messages: 'Сообщения', sidebar_recordings: 'Записи', sidebar_reminders: 'Напоминания', sidebar_stats: 'Статистика', sidebar_premium: 'Премиум', sidebar_colors: 'Цвета',
                title_dashboard: 'Панель', subtitle_dashboard: 'Аналитика сервера в реальном времени', title_settings: 'Настройки', subtitle_settings: 'Настройка бота и предпочтений сервера',
                stat_totalMembers: 'Всего Участников', stat_verifiedUsers: 'Проверенные', stat_bots: 'Боты', stat_admins: 'Администраторы', stat_moderators: 'Модераторы', heading_memberOverview: 'Обзор Участников',
                panel_botConfig: '⚙️ Конфигурация Бота', panel_roleManagement: '👥 Управление Ролями', panel_channels: '📝 Каналы', panel_featureToggles: '✨ Функции',
                commandPrefix: 'Префикс Команды', defaultLanguage: 'Язык по Умолчанию', label_botNickname: 'Ник Бота', label_botStatus: 'Статус Бота', label_botActivity: 'Активность Бота', label_timezone: 'Часовой Пояс (GMT)',
                label_adminRole: 'Роль Администратора', label_modRole: 'Роль Модератора', label_membersRole: 'Роль Участников', label_mutedRole: 'Роль Мута',
                toggle_musicPlayer: 'Музыкальный Плеер', toggle_economySystem: 'Экономическая Система', toggle_levelingSystem: 'Система Уровней', toggle_welcomeMessages: 'Приветственные Сообщения', toggle_moderationTools: 'Инструменты Модерации', toggle_socialNotifications: 'Социальные Уведомления'
            },
            ja: {
                nav_main: 'メイン', nav_core: 'コア', nav_features: '機能', nav_systems: 'システム', nav_monitoring: 'モニタリング', nav_advanced: '詳細', nav_subscriptions: 'サブスクリプション', nav_tools: 'ツール',
                sidebar_dashboard: 'ダッシュボード', sidebar_settings: '設定', sidebar_logging: 'ログ', sidebar_serverGuard: 'サーバーガード', sidebar_reactRoles: 'リアクションロール', sidebar_roleCategories: 'ロールカテゴリ', sidebar_serverMessages: 'サーバーメッセージ', sidebar_commands: 'コマンド', sidebar_components: 'コンポーネント', sidebar_xpLevels: 'XPレベル', sidebar_leaderboards: 'リーダーボード', sidebar_giveaways: 'プレゼント', sidebar_memberActivity: 'メンバー活動', sidebar_socialNotifs: '通知', sidebar_invites: '招待', sidebar_messages: 'メッセージ', sidebar_recordings: '録音', sidebar_reminders: 'リマインダー', sidebar_stats: '統計', sidebar_premium: 'プレミアム', sidebar_colors: '色',
                title_dashboard: 'ダッシュボード', subtitle_dashboard: 'リアルタイムサーバー分析', title_settings: '設定', subtitle_settings: 'ボットの設定とサーバーの環境設定',
                stat_totalMembers: '合計メンバー', stat_verifiedUsers: '認証済みユーザー', stat_bots: 'ボット', stat_admins: '管理者', stat_moderators: 'モデレーター', heading_memberOverview: 'メンバー概要',
                commandPrefix: 'コマンドプレフィックス', defaultLanguage: 'デフォルト言語'
            },
            ko: {
                nav_main: '메인', nav_core: '코어', nav_features: '기능', nav_systems: '시스템', nav_monitoring: '모니터링', nav_advanced: '고급', nav_subscriptions: '구독', nav_tools: '도구',
                sidebar_dashboard: '대시보드', sidebar_settings: '설정', sidebar_logging: '로그', sidebar_serverGuard: '서버 가드', sidebar_reactRoles: '반응 역할', sidebar_commands: '명령어', sidebar_components: '구성요소', sidebar_xpLevels: 'XP 레벨', sidebar_leaderboards: '리더보드', sidebar_giveaways: '경품', sidebar_memberActivity: '멤버 활동', sidebar_invites: '초대', sidebar_messages: '메시지', sidebar_recordings: '녹음', sidebar_reminders: '알림', sidebar_stats: '통계', sidebar_premium: '프리미엄', sidebar_colors: '색상',
                title_dashboard: '대시보드', subtitle_dashboard: '실시간 서버 분석', title_settings: '설정', subtitle_settings: '봇 설정 및 서버 환경설정',
                stat_totalMembers: '전체 멤버', stat_verifiedUsers: '인증된 사용자', stat_bots: '봇', stat_admins: '관리자', stat_moderators: '모더레이터',
                commandPrefix: '명령어 접두사', defaultLanguage: '기본 언어'
            },
            zh: {
                nav_main: '主要', nav_core: '核心', nav_features: '功能', nav_systems: '系统', nav_monitoring: '监控', nav_advanced: '高级', nav_subscriptions: '订阅', nav_tools: '工具',
                sidebar_dashboard: '仪表板', sidebar_settings: '设置', sidebar_logging: '日志', sidebar_serverGuard: '服务器守护', sidebar_reactRoles: '反应角色', sidebar_roleCategories: '角色分类', sidebar_serverMessages: '服务器消息', sidebar_commands: '命令', sidebar_components: '组件', sidebar_xpLevels: 'XP等级', sidebar_leaderboards: '排行榜', sidebar_giveaways: '抽奖', sidebar_memberActivity: '成员活动', sidebar_socialNotifs: '通知', sidebar_invites: '邀请', sidebar_messages: '消息', sidebar_recordings: '录音', sidebar_reminders: '提醒', sidebar_stats: '统计', sidebar_premium: '高级版', sidebar_colors: '颜色',
                title_dashboard: '仪表板', subtitle_dashboard: '实时服务器分析', title_settings: '设置', subtitle_settings: '配置机器人设置和服务器偏好',
                stat_totalMembers: '总成员', stat_verifiedUsers: '已验证用户', stat_bots: '机器人', stat_admins: '管理员', stat_moderators: '版主', heading_memberOverview: '成员概览',
                commandPrefix: '命令前缀', defaultLanguage: '默认语言'
            },
            ar: {
                nav_main: 'رئيسي', nav_core: 'أساسي', nav_features: 'الميزات', nav_systems: 'الأنظمة', nav_monitoring: 'المراقبة', nav_advanced: 'متقدم', nav_subscriptions: 'الاشتراكات', nav_tools: 'الأدوات',
                sidebar_dashboard: 'لوحة القيادة', sidebar_settings: 'الإعدادات', sidebar_logging: 'السجلات', sidebar_serverGuard: 'حارس الخادم', sidebar_reactRoles: 'أدوار التفاعل', sidebar_commands: 'الأوامر', sidebar_components: 'المكونات', sidebar_xpLevels: 'مستويات XP', sidebar_leaderboards: 'لوحات المتصدرين', sidebar_giveaways: 'الهدايا', sidebar_memberActivity: 'نشاط الأعضاء', sidebar_invites: 'الدعوات', sidebar_messages: 'الرسائل', sidebar_recordings: 'التسجيلات', sidebar_reminders: 'التذكيرات', sidebar_stats: 'الإحصائيات', sidebar_premium: 'بريميوم', sidebar_colors: 'الألوان',
                title_dashboard: 'لوحة القيادة', subtitle_dashboard: 'تحليلات الخادم في الوقت الفعلي', title_settings: 'الإعدادات',
                stat_totalMembers: 'إجمالي الأعضاء', stat_verifiedUsers: 'المستخدمون الموثقون', stat_bots: 'البوتات', stat_admins: 'المشرفون', stat_moderators: 'المراقبون',
                commandPrefix: 'بادئة الأمر', defaultLanguage: 'اللغة الافتراضية'
            },
            hi: {
                nav_main: 'मुख्य', nav_core: 'कोर', nav_features: 'सुविधाएँ', nav_systems: 'सिस्टम', nav_monitoring: 'निगरानी', nav_advanced: 'उन्नत', nav_subscriptions: 'सदस्यता', nav_tools: 'उपकरण',
                sidebar_dashboard: 'डैशबोर्ड', sidebar_settings: 'सेटिंग्स', sidebar_logging: 'लॉग', sidebar_serverGuard: 'सर्वर गार्ड', sidebar_commands: 'कमांड', sidebar_memberActivity: 'सदस्य गतिविधि', sidebar_messages: 'संदेश', sidebar_premium: 'प्रीमियम', sidebar_colors: 'रंग',
                title_dashboard: 'डैशबोर्ड', subtitle_dashboard: 'रीयल-टाइम सर्वर एनालिटिक्स', title_settings: 'सेटिंग्स',
                stat_totalMembers: 'कुल सदस्य', stat_verifiedUsers: 'सत्यापित उपयोगकर्ता', stat_bots: 'बॉट', stat_admins: 'व्यवस्थापक', stat_moderators: 'मॉडरेटर',
                commandPrefix: 'कमांड प्रीफ़िक्स', defaultLanguage: 'डिफ़ॉल्ट भाषा'
            },
            tr: {
                nav_main: 'ANA', nav_core: 'ÇEKIRDEK', nav_features: 'ÖZELLİKLER', nav_systems: 'SİSTEMLER', nav_monitoring: 'İZLEME', nav_advanced: 'GELİŞMİŞ', nav_subscriptions: 'ABONELİKLER', nav_tools: 'ARAÇLAR',
                sidebar_dashboard: 'Gösterge Paneli', sidebar_settings: 'Ayarlar', sidebar_logging: 'Günlükler', sidebar_serverGuard: 'Sunucu Koruması', sidebar_reactRoles: 'Tepki Rolleri', sidebar_commands: 'Komutlar', sidebar_components: 'Bileşenler', sidebar_xpLevels: 'XP Seviyeleri', sidebar_leaderboards: 'Sıralamalar', sidebar_giveaways: 'Çekilişler', sidebar_memberActivity: 'Üye Etkinliği', sidebar_invites: 'Davetler', sidebar_messages: 'Mesajlar', sidebar_recordings: 'Kayıtlar', sidebar_reminders: 'Hatırlatıcılar', sidebar_stats: 'İstatistikler', sidebar_premium: 'Premium', sidebar_colors: 'Renkler',
                title_dashboard: 'Gösterge Paneli', subtitle_dashboard: 'Gerçek zamanlı sunucu analitiği', title_settings: 'Ayarlar',
                stat_totalMembers: 'Toplam Üyeler', stat_verifiedUsers: 'Doğrulanmış Kullanıcılar', stat_bots: 'Botlar', stat_admins: 'Yöneticiler', stat_moderators: 'Moderatörler',
                commandPrefix: 'Komut Öneki', defaultLanguage: 'Varsayılan Dil'
            },
            sv: { sidebar_dashboard: 'Kontrollpanel', sidebar_settings: 'Inställningar', stat_totalMembers: 'Totalt Medlemmar', stat_verifiedUsers: 'Verifierade', stat_bots: 'Botar', stat_admins: 'Administratörer', stat_moderators: 'Moderatorer', commandPrefix: 'Kommandoprefix', defaultLanguage: 'Standardspråk', title_dashboard: 'Kontrollpanel', title_settings: 'Inställningar' },
            da: { sidebar_dashboard: 'Kontrolpanel', sidebar_settings: 'Indstillinger', stat_totalMembers: 'Samlet Medlemmer', stat_verifiedUsers: 'Verificerede', stat_bots: 'Bots', stat_admins: 'Administratorer', stat_moderators: 'Moderatorer', commandPrefix: 'Kommandopræfiks', defaultLanguage: 'Standardsprog', title_dashboard: 'Kontrolpanel', title_settings: 'Indstillinger' },
            no: { sidebar_dashboard: 'Kontrollpanel', sidebar_settings: 'Innstillinger', stat_totalMembers: 'Totalt Medlemmer', stat_verifiedUsers: 'Verifiserte', stat_bots: 'Boter', stat_admins: 'Administratorer', stat_moderators: 'Moderatorer', commandPrefix: 'Kommandoprefiks', defaultLanguage: 'Standardspråk', title_dashboard: 'Kontrollpanel', title_settings: 'Innstillinger' },
            fi: { sidebar_dashboard: 'Hallintapaneeli', sidebar_settings: 'Asetukset', stat_totalMembers: 'Jäseniä Yhteensä', stat_verifiedUsers: 'Vahvistetut', stat_bots: 'Botit', stat_admins: 'Ylläpitäjät', stat_moderators: 'Moderaattorit', commandPrefix: 'Komentoetuliite', defaultLanguage: 'Oletuskieli', title_dashboard: 'Hallintapaneeli', title_settings: 'Asetukset' },
            cs: { sidebar_dashboard: 'Nástěnka', sidebar_settings: 'Nastavení', stat_totalMembers: 'Celkem Členů', stat_verifiedUsers: 'Ověření', stat_bots: 'Boti', stat_admins: 'Administrátoři', stat_moderators: 'Moderátoři', commandPrefix: 'Příkazový Prefix', defaultLanguage: 'Výchozí Jazyk', title_dashboard: 'Nástěnka', title_settings: 'Nastavení' },
            ro: { sidebar_dashboard: 'Panou', sidebar_settings: 'Setări', stat_totalMembers: 'Total Membri', stat_verifiedUsers: 'Verificați', stat_bots: 'Boți', stat_admins: 'Administratori', stat_moderators: 'Moderatori', commandPrefix: 'Prefix Comandă', defaultLanguage: 'Limba Implicită', title_dashboard: 'Panou', title_settings: 'Setări' },
            hu: { sidebar_dashboard: 'Vezérlőpult', sidebar_settings: 'Beállítások', stat_totalMembers: 'Összes Tag', stat_verifiedUsers: 'Ellenőrzött', stat_bots: 'Botok', stat_admins: 'Adminisztrátorok', stat_moderators: 'Moderátorok', commandPrefix: 'Parancs Előtag', defaultLanguage: 'Alapértelmezett Nyelv', title_dashboard: 'Vezérlőpult', title_settings: 'Beállítások' },
            uk: { sidebar_dashboard: 'Панель', sidebar_settings: 'Налаштування', stat_totalMembers: 'Всього Учасників', stat_verifiedUsers: 'Перевірені', stat_bots: 'Боти', stat_admins: 'Адміністратори', stat_moderators: 'Модератори', commandPrefix: 'Префікс Команди', defaultLanguage: 'Мова за Замовчуванням', title_dashboard: 'Панель', title_settings: 'Налаштування' },
            th: { sidebar_dashboard: 'แดชบอร์ด', sidebar_settings: 'การตั้งค่า', stat_totalMembers: 'สมาชิกทั้งหมด', stat_verifiedUsers: 'ยืนยันแล้ว', stat_bots: 'บอท', stat_admins: 'ผู้ดูแล', stat_moderators: 'ผู้ตรวจสอบ', commandPrefix: 'คำนำหน้าคำสั่ง', defaultLanguage: 'ภาษาเริ่มต้น', title_dashboard: 'แดชบอร์ด', title_settings: 'การตั้งค่า' },
            vi: { sidebar_dashboard: 'Bảng điều khiển', sidebar_settings: 'Cài đặt', stat_totalMembers: 'Tổng Thành Viên', stat_verifiedUsers: 'Đã Xác Minh', stat_bots: 'Bot', stat_admins: 'Quản Trị', stat_moderators: 'Điều Hành', commandPrefix: 'Tiền Tố Lệnh', defaultLanguage: 'Ngôn Ngữ Mặc Định', title_dashboard: 'Bảng Điều Khiển', title_settings: 'Cài Đặt' },
            id: { sidebar_dashboard: 'Dasbor', sidebar_settings: 'Pengaturan', stat_totalMembers: 'Total Anggota', stat_verifiedUsers: 'Terverifikasi', stat_bots: 'Bot', stat_admins: 'Administrator', stat_moderators: 'Moderator', commandPrefix: 'Awalan Perintah', defaultLanguage: 'Bahasa Default', title_dashboard: 'Dasbor', title_settings: 'Pengaturan' },
            ms: { sidebar_dashboard: 'Papan Pemuka', sidebar_settings: 'Tetapan', stat_totalMembers: 'Jumlah Ahli', stat_verifiedUsers: 'Disahkan', stat_bots: 'Bot', stat_admins: 'Pentadbir', stat_moderators: 'Moderator', commandPrefix: 'Awalan Arahan', defaultLanguage: 'Bahasa Lalai', title_dashboard: 'Papan Pemuka', title_settings: 'Tetapan' },
            el: { sidebar_dashboard: 'Πίνακας', sidebar_settings: 'Ρυθμίσεις', stat_totalMembers: 'Σύνολο Μελών', stat_verifiedUsers: 'Επαληθευμένοι', stat_bots: 'Μπότ', stat_admins: 'Διαχειριστές', stat_moderators: 'Συντονιστές', commandPrefix: 'Πρόθεμα Εντολής', defaultLanguage: 'Προεπιλεγμένη Γλώσσα', title_dashboard: 'Πίνακας', title_settings: 'Ρυθμίσεις' },
            bg: { sidebar_dashboard: 'Табло', sidebar_settings: 'Настройки', stat_totalMembers: 'Общо Членове', stat_verifiedUsers: 'Проверени', stat_bots: 'Ботове', stat_admins: 'Администратори', stat_moderators: 'Модератори', commandPrefix: 'Префикс на Команда', defaultLanguage: 'Език по Подразбиране', title_dashboard: 'Табло', title_settings: 'Настройки' },
            hr: { sidebar_dashboard: 'Nadzorna ploča', sidebar_settings: 'Postavke', stat_totalMembers: 'Ukupno Članova', stat_verifiedUsers: 'Verificirani', stat_bots: 'Botovi', stat_admins: 'Administratori', stat_moderators: 'Moderatori', commandPrefix: 'Prefiks Naredbe', defaultLanguage: 'Zadani Jezik', title_dashboard: 'Nadzorna Ploča', title_settings: 'Postavke' }
        };

        let currentLanguage = localStorage.getItem('dashboardLanguage') || 'en';
        const englishDefaults = {};

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('dashboardLanguage', lang);
            applyLanguage(lang);
        }

        function applyLanguage(lang) {
            const dict = translations[lang] || {};
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                // Capture original English text on first encounter
                if (!englishDefaults[key]) {
                    englishDefaults[key] = el.textContent;
                }
                if (lang === 'en') {
                    // Restore original English text
                    el.textContent = englishDefaults[key];
                } else if (dict[key]) {
                    el.textContent = dict[key];
                }
                // else: no translation for this key in this lang — keep current text
            });
            // Update the language selector to reflect current choice
            const sel = document.getElementById('languageSelect');
            if (sel) sel.value = lang;
        }

        // ========== CUSTOM MULTI-SELECT COMPONENT ==========
        function initCustomMultiSelect(container) {
            if (container._cmsInit) return; // already initialized
            container._cmsInit = true;
            container._options = []; // {value, text, color, selected}
            const placeholder = container.dataset.placeholder || 'Select...';

            // Build inner HTML
            container.innerHTML = `
                <div class="cms-trigger">
                    <div class="cms-trigger-text"><span style="color:inherit">${placeholder}</span></div>
                    <span class="cms-arrow">▼</span>
                </div>
                <div class="cms-dropdown">
                    <div class="cms-search"><input type="text" placeholder="Search roles..." /></div>
                    <div class="cms-options"></div>
                </div>
            `;

            const trigger = container.querySelector('.cms-trigger');
            const dropdown = container.querySelector('.cms-dropdown');
            const searchInput = container.querySelector('.cms-search input');
            const optionsList = container.querySelector('.cms-options');

            // Toggle open/close
            trigger.addEventListener('click', (e) => {
                if (e.target.classList.contains('cms-tag-x')) return; // handled separately
                // Close others
                document.querySelectorAll('.custom-multiselect.open').forEach(el => {
                    if (el !== container) el.classList.remove('open');
                });
                container.classList.toggle('open');
                if (container.classList.contains('open')) {
                    setTimeout(() => searchInput.focus(), 50);
                }
            });

            // Close on outside click
            document.addEventListener('click', (e) => {
                if (!container.contains(e.target)) {
                    container.classList.remove('open');
                }
            });

            // Search/filter
            searchInput.addEventListener('input', () => {
                const q = searchInput.value.toLowerCase();
                optionsList.querySelectorAll('.cms-option').forEach(opt => {
                    const text = opt.dataset.text.toLowerCase();
                    opt.style.display = text.includes(q) ? '' : 'none';
                });
                // Show empty message if nothing matches
                const visible = optionsList.querySelectorAll('.cms-option:not([style*="display: none"])');
                let empty = optionsList.querySelector('.cms-empty');
                if (visible.length === 0) {
                    if (!empty) { empty = document.createElement('div'); empty.className = 'cms-empty'; empty.textContent = 'No roles found'; optionsList.appendChild(empty); }
                    empty.style.display = '';
                } else if (empty) {
                    empty.style.display = 'none';
                }
            });

            // Prevent dropdown close on search click
            searchInput.addEventListener('click', (e) => e.stopPropagation());

            // Render methods
            container._renderOptions = function() {
                optionsList.innerHTML = '';
                if (container._options.length === 0) {
                    optionsList.innerHTML = '<div class="cms-empty">No roles available</div>';
                    return;
                }
                container._options.forEach((opt, i) => {
                    const div = document.createElement('div');
                    div.className = 'cms-option' + (opt.selected ? ' selected' : '');
                    div.dataset.value = opt.value;
                    div.dataset.text = opt.text;
                    div.dataset.index = i;
                    const colorDot = opt.color && opt.color !== '#000000'
                        ? `<span class="cms-role-color" style="background:${opt.color}"></span>` : '';
                    div.innerHTML = `<span class="cms-check">${opt.selected ? '✓' : ''}</span>${colorDot}<span>${opt.text}</span>`;
                    div.addEventListener('click', (e) => {
                        e.stopPropagation();
                        opt.selected = !opt.selected;
                        div.classList.toggle('selected', opt.selected);
                        div.querySelector('.cms-check').textContent = opt.selected ? '✓' : '';
                        container._updateTrigger();
                    });
                    optionsList.appendChild(div);
                });
                searchInput.value = '';
            };

            container._updateTrigger = function() {
                const triggerText = container.querySelector('.cms-trigger-text');
                const selected = container._options.filter(o => o.selected);
                if (selected.length === 0) {
                    triggerText.innerHTML = `<span style="color:inherit">${placeholder}</span>`;
                    return;
                }
                const maxTags = 4;
                let html = '';
                selected.slice(0, maxTags).forEach(o => {
                    html += `<span class="cms-tag">${o.text}<span class="cms-tag-x" data-value="${o.value}">✕</span></span>`;
                });
                if (selected.length > maxTags) {
                    html += `<span class="cms-overflow">+${selected.length - maxTags} more</span>`;
                }
                triggerText.innerHTML = html;
                // Bind tag remove buttons
                triggerText.querySelectorAll('.cms-tag-x').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const val = btn.dataset.value;
                        const opt = container._options.find(o => o.value === val);
                        if (opt) {
                            opt.selected = false;
                            container._renderOptions();
                            container._updateTrigger();
                        }
                    });
                });
            };

            // Public API: set options (array of {value, text, color?})
            container.setOptions = function(options) {
                const prevSelected = container._options.filter(o => o.selected).map(o => o.value);
                container._options = options.map(o => ({
                    value: o.value,
                    text: o.text,
                    color: o.color || null,
                    selected: prevSelected.includes(o.value)
                }));
                container._renderOptions();
                container._updateTrigger();
            };

            // Public API: get selected values [{value, text}]
            container.getSelected = function() {
                return container._options.filter(o => o.selected).map(o => ({ value: o.value, text: o.text }));
            };

            // Public API: clear selections
            container.clearSelection = function() {
                container._options.forEach(o => o.selected = false);
                container._renderOptions();
                container._updateTrigger();
            };

            // Public API: compatibility with old code checking .multiple
            container.multiple = true;
            Object.defineProperty(container, 'selectedOptions', {
                get: function() {
                    return container._options.filter(o => o.selected).map(o => ({
                        value: o.value,
                        text: o.text,
                        textContent: o.text
                    }));
                }
            });
            Object.defineProperty(container, 'options', {
                get: function() {
                    return container._options.map(o => ({
                        value: o.value,
                        text: o.text,
                        textContent: o.text,
                        selected: o.selected
                    }));
                }
            });
        }

        // Initialize all custom multi-selects on the page
        function initAllCustomMultiSelects() {
            document.querySelectorAll('.custom-multiselect').forEach(el => initCustomMultiSelect(el));
        }
        initAllCustomMultiSelects();

        // ========== LOAD ROLES & CHANNELS INTO DROPDOWNS ==========
        async function loadServerRolesAndChannels(guildId) {
            try {
                const [rolesRes, channelsRes] = await Promise.all([
                    fetch('/api/roles/' + guildId, { credentials: 'include' }),
                    fetch('/api/channels/' + guildId, { credentials: 'include' })
                ]);

                if (rolesRes.ok) {
                    const { roles } = await rolesRes.json();
                    const roleSelects = ['adminRoleSelect', 'modRoleSelect', 'membersRoleSelect', 'mutedRoleSelect', 'rr_roleSelect', 'gr_roleSelect', 'wp_roleSelect', 'pl_roleSelect', 'cc_roleSelect'];
                    roleSelects.forEach(selectId => {
                        const sel = document.getElementById(selectId);
                        if (!sel) return;

                        // Custom multi-select component
                        if (sel.classList.contains('custom-multiselect')) {
                            initCustomMultiSelect(sel);
                            const options = roles.map(role => {
                                let color = null;
                                if (role.color) {
                                    const hex = '#' + role.color.toString(16).padStart(6, '0');
                                    if (hex !== '#000000') color = hex;
                                }
                                return { value: role.id, text: role.name, color };
                            });
                            sel.setOptions(options);
                            return;
                        }

                        // Native select fallback
                        const isMulti = sel.multiple;
                        const currentVal = isMulti ? Array.from(sel.selectedOptions).map(o => o.value) : sel.value;
                        // For multi-selects, no placeholder; for single-selects, keep placeholder
                        if (isMulti) {
                            sel.innerHTML = '';
                        } else {
                            sel.innerHTML = '<option value="">' + (sel.options[0]?.textContent || 'Select role...') + '</option>';
                        }
                        roles.forEach(role => {
                            const opt = document.createElement('option');
                            opt.value = role.id;
                            opt.textContent = role.name;
                            if (role.color) {
                                const hex = '#' + role.color.toString(16).padStart(6, '0');
                                if (hex !== '#000000') opt.style.color = hex;
                            }
                            sel.appendChild(opt);
                        });
                        if (isMulti) {
                            currentVal.forEach(v => { const o = sel.querySelector('option[value="' + v + '"]'); if (o) o.selected = true; });
                        } else {
                            if (currentVal) sel.value = currentVal;
                        }
                    });
                }

                if (channelsRes.ok) {
                    const { channels } = await channelsRes.json();
                    const channelSelects = ['generalChannelSelect', 'announcementsChannelSelect', 'welcomeChannelSelect', 'messageLogChannelSelect', 'modLogChannelSelect', 'sg_auditLogChannel', 'rr_channelSelect', 'rr_postChannel', 'sc_channelSelect'];
                    channelSelects.forEach(selectId => {
                        const sel = document.getElementById(selectId);
                        if (!sel) return;
                        const currentVal = sel.value;
                        sel.innerHTML = '<option value="">' + sel.options[0].textContent + '</option>';
                        channels.forEach(ch => {
                            const opt = document.createElement('option');
                            opt.value = ch.id;
                            opt.textContent = '#' + ch.name;
                            sel.appendChild(opt);
                        });
                        if (currentVal) sel.value = currentVal;
                    });
                }
            } catch (e) {
                console.error('Error loading roles/channels:', e);
            }
        }

        // ========== LOAD SAVED SETTINGS FOR A SERVER ==========
        async function loadServerSettings(guildId) {
            try {
                const res = await fetch('/api/config/' + guildId, { credentials: 'include' });
                if (!res.ok) return;
                const config = await res.json();

                // Restore role selections
                if (config.adminRole) { const s = document.getElementById('adminRoleSelect'); if (s) s.value = config.adminRole; }
                if (config.modRole) { const s = document.getElementById('modRoleSelect'); if (s) s.value = config.modRole; }
                if (config.membersRole) { const s = document.getElementById('membersRoleSelect'); if (s) s.value = config.membersRole; }
                if (config.mutedRole) { const s = document.getElementById('mutedRoleSelect'); if (s) s.value = config.mutedRole; }

                // Restore channel selections
                if (config.generalChannel) { const s = document.getElementById('generalChannelSelect'); if (s) s.value = config.generalChannel; }
                if (config.announcementsChannel) { const s = document.getElementById('announcementsChannelSelect'); if (s) s.value = config.announcementsChannel; }
                if (config.welcomeChannel) { const s = document.getElementById('welcomeChannelSelect'); if (s) s.value = config.welcomeChannel; }

                // Restore language
                const savedLang = config.language || 'en';
                const sel = document.getElementById('languageSelect');
                if (sel) sel.value = savedLang;
                currentLanguage = savedLang;
                localStorage.setItem('dashboardLanguage', savedLang);
                applyLanguage(savedLang);

                // Restore feature toggles
                const toggleKeys = ['musicPlayer', 'economySystem', 'levelingSystem', 'welcomeMessages', 'moderationTools', 'socialNotifications'];
                toggleKeys.forEach(key => {
                    const cb = document.getElementById('toggle_' + key);
                    if (cb && config[key] !== undefined) cb.checked = config[key];
                });
            } catch (e) {
                console.error('Error loading server settings:', e);
            }
        }

        function toggleDarkMode() {
            const isDarkMode = !document.body.classList.contains('light-mode');
            const newMode = isDarkMode ? 'light' : 'dark';
            
            if (newMode === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('modeIcon').textContent = '☀️';
                localStorage.setItem('theme', 'light');
            } else {
                document.body.classList.remove('light-mode');
                document.getElementById('modeIcon').textContent = '🌙';
                localStorage.setItem('theme', 'dark');
            }

            // Re-render chart with correct theme colors
            if (typeof loadMemberGraphs === 'function') {
                try { loadMemberGraphs(); } catch(e) {}
            }
        }

        function toggleProfileMenu() {
            const menu = document.getElementById('profileMenu');
            menu.classList.toggle('active');
        }

        function updateServerBtnIcon(serverName, iconUrl, iconProxyUrl) {
            const btnIcon = document.getElementById('serverBtnIcon');
            if (!btnIcon) return;
            if (iconUrl) {
                const src = iconProxyUrl || iconUrl;
                btnIcon.innerHTML = `<img src="${src}" alt="" style="width:100%;height:100%;object-fit:cover;">`;
                const img = btnIcon.querySelector('img');
                if (img) {
                    img.onerror = function() {
                        btnIcon.textContent = serverName.charAt(0).toUpperCase();
                    };
                }
            } else {
                btnIcon.textContent = serverName ? serverName.charAt(0).toUpperCase() : '?';
            }
        }

        function toggleServerDropdown() {
            const menu = document.getElementById('serverDropdownMenu');
            const isActive = menu.classList.contains('active');
            
            if (!isActive) {
                loadServerList();
            }
            
            menu.classList.toggle('active');
        }

        async function loadServerList() {
            try {
                const serversList = document.getElementById('serversList');
                serversList.innerHTML = '<div style="padding: 1rem; text-align: center; color: rgba(255, 255, 255, 0.5); font-size: 0.8rem;">Loading servers...</div>';
                
                const res = await fetch('/api/creator/servers', { credentials: 'include' });
                if (!res.ok) {
                    serversList.innerHTML = '<div style="padding: 1rem; color: #ff6b6b; font-size: 0.8rem;">Error loading servers</div>';
                    return;
                }
                
                const data = await res.json();
                
                if (!data.servers || data.servers.length === 0) {
                    serversList.innerHTML = '<div style="padding: 1rem; color: rgba(255, 255, 255, 0.5); font-size: 0.8rem;">No servers found</div>';
                    return;
                }
                
                const currentServerId = localStorage.getItem('selectedServerId');
                serversList.innerHTML = '';
                
                data.servers.forEach(server => {
                    const item = document.createElement('div');
                    item.className = `server-menu-item ${server.id === currentServerId ? 'active' : ''}`;
                    item.onclick = () => selectServer(server.id, server.name, server.icon, server.iconProxy);
                    let iconContent;
                    if (server.icon) {
                        const imgSrc = server.iconProxy || server.icon;
                        iconContent = `<img src="${imgSrc}" alt="" style="width:100%;height:100%;object-fit:cover;border-radius:50%;">`;
                    } else {
                        iconContent = server.name.charAt(0).toUpperCase();
                    }
                    const memberText = server.memberCount ? `${server.memberCount} members` : '';
                    item.innerHTML = `
                        <div class="server-menu-icon">${iconContent}</div>
                        <div class="server-menu-info">
                            <div class="server-menu-name">${server.name}</div>
                            <div class="server-menu-members">${memberText}</div>
                        </div>
                    `;
                    // Handle image load errors
                    const img = item.querySelector('.server-menu-icon img');
                    if (img) {
                        img.onerror = function() {
                            this.parentElement.textContent = server.name.charAt(0).toUpperCase();
                        };
                    }
                    serversList.appendChild(item);
                });
            } catch (err) {
                console.error('Failed to load servers:', err);
                document.getElementById('serversList').innerHTML = '<div style="padding: 1rem; color: #ff6b6b; font-size: 0.8rem;">Failed to load servers</div>';
            }
        }

        function showServerOverlay() {
            const overlay = document.getElementById('serverSelectOverlay');
            if (overlay) overlay.classList.remove('hidden');
        }

        function hideServerOverlay() {
            const overlay = document.getElementById('serverSelectOverlay');
            if (overlay) overlay.classList.add('hidden');
        }

        async function selectServer(serverId, serverName, iconUrl, iconProxyUrl) {
            localStorage.setItem('selectedServerId', serverId);
            document.getElementById('serverDisplayName').textContent = serverName;
            document.getElementById('serverDropdownMenu').classList.remove('active');
            
            // Update button icon
            updateServerBtnIcon(serverName, iconUrl, iconProxyUrl);
            
            // Hide the overlay — server is now selected
            hideServerOverlay();
            
            console.log('🔄 Server switched to:', serverName, '(' + serverId + ')');
            
            // Load ALL data for the selected server
            await loadServerRolesAndChannels(serverId);
            await loadServerSettings(serverId);
            await loadLogging();
            await loadServerGuard();
            await loadRoleCategories(serverId);
            await loadMemberGraphs();
            await loadMemberEvents();
            await loadStaffMembers(serverId);

            // Re-capture original values now that server data is loaded
            setupUnsavedDetection();
        }

        // Staff Members Panel
        async function loadStaffMembers(guildId) {
            const panel = document.getElementById('staffPanel');
            if (!panel) return;
            panel.innerHTML = '<div style="color: rgba(255,255,255,0.5); padding: 1rem; text-align: center; font-size: 0.85rem;">Loading staff...</div>';

            try {
                const res = await fetch(`/api/staff-members/${guildId}`, { credentials: 'include' });
                if (!res.ok) {
                    panel.innerHTML = '<div style="color: #ff6b6b; padding: 1rem; text-align: center; font-size: 0.85rem;">Failed to load staff</div>';
                    return;
                }
                const data = await res.json();
                let html = '';

                // Admins section
                html += '<div class="staff-section-label">Admins (' + data.admins.length + ')</div>';
                if (data.admins.length === 0) {
                    html += '<div style="color: rgba(255,255,255,0.4); font-size: 0.8rem; padding: 0.5rem;">No admins found</div>';
                } else {
                    data.admins.forEach(m => {
                        html += renderStaffMember(m, guildId, 'admin');
                    });
                }

                html += '<div class="staff-divider"></div>';

                // Mods section
                html += '<div class="staff-section-label">Moderators (' + data.mods.length + ')</div>';
                if (data.mods.length === 0) {
                    html += '<div style="color: rgba(255,255,255,0.4); font-size: 0.8rem; padding: 0.5rem;">No moderators found</div>';
                } else {
                    data.mods.forEach(m => {
                        html += renderStaffMember(m, guildId, 'mod');
                    });
                }

                panel.innerHTML = html;
            } catch (err) {
                console.error('Failed to load staff:', err);
                panel.innerHTML = '<div style="color: #ff6b6b; padding: 1rem; text-align: center; font-size: 0.85rem;">Error loading staff</div>';
            }
        }

        function renderStaffMember(member, guildId, type) {
            const avatarHtml = member.avatar
                ? `<img src="/api/image?url=${encodeURIComponent(member.avatar)}" alt="" onerror="this.outerHTML='${member.displayName.charAt(0).toUpperCase()}'">`
                : member.displayName.charAt(0).toUpperCase();

            const ownerBadge = member.isOwner ? '<span class="staff-owner-badge">Owner</span>' : '';

            const roleTags = member.roles.map(r =>
                `<span class="staff-role-tag">${r.name}</span>`
            ).join('');

            // Build revoke buttons per-role
            let revokeHtml = '';
            if (!member.isOwner && member.canRevoke && member.roles.length > 0) {
                revokeHtml = member.roles.map(r =>
                    `<button class="staff-revoke-btn" onclick="revokeRole('${guildId}', '${member.id}', '${r.id}', this)" title="Remove ${r.name}">Revoke ${r.name}</button>`
                ).join(' ');
            } else if (member.isOwner) {
                revokeHtml = '<span style="font-size:0.65rem;color:rgba(255,255,255,0.3);">Owner</span>';
            } else if (!member.canRevoke) {
                revokeHtml = '<span style="font-size:0.65rem;color:rgba(255,255,255,0.3);">Higher role</span>';
            }

            return `
                <div class="staff-member">
                    <div class="staff-avatar">${avatarHtml}</div>
                    <div class="staff-info">
                        <div class="staff-name">${member.displayName} ${ownerBadge}</div>
                        <div class="staff-roles">${roleTags}</div>
                    </div>
                    <div style="display:flex;flex-wrap:wrap;gap:4px;">${revokeHtml}</div>
                </div>
            `;
        }

        async function revokeRole(guildId, memberId, roleId, btn) {
            if (!confirm('Are you sure you want to revoke this role? This action will take effect immediately in Discord.')) return;

            btn.disabled = true;
            btn.textContent = '...';

            try {
                const res = await fetch(`/api/revoke-role/${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ memberId, roleId })
                });

                const data = await res.json();
                if (res.ok && data.success) {
                    btn.textContent = 'Revoked';
                    btn.style.background = 'rgba(0,200,100,0.2)';
                    btn.style.borderColor = 'rgba(0,200,100,0.4)';
                    btn.style.color = '#00c864';
                    // Refresh staff list and stats after a short delay
                    setTimeout(async () => {
                        await loadStaffMembers(guildId);
                        await loadMemberGraphs();
                    }, 1000);
                } else {
                    alert('Failed: ' + (data.error || 'Unknown error'));
                    btn.disabled = false;
                    btn.textContent = 'Revoke';
                }
            } catch (err) {
                alert('Error: ' + err.message);
                btn.disabled = false;
                btn.textContent = 'Revoke';
            }
        }

        // Store current guild for category management
        let currentGuildId = localStorage.getItem('selectedServerId');
        let currentCategories = {};

        async function loadRoleCategories(guildId) {
            currentGuildId = guildId;
            try {
                console.log('🔵 Fetching categories for guildId:', guildId);
                const res = await fetch(`/api/config/role-categories?guildId=${guildId}`, { credentials: 'include' });
                console.log('🔵 Categories API response status:', res.status);
                
                if (res.ok) {
                    const categories = await res.json();
                    console.log('🔵 Categories fetched:', categories);
                    currentCategories = categories;
                    const categoryOptions = Object.keys(categories);
                    console.log('🔵 Category names:', categoryOptions);
                    
                    // Update all category dropdowns
                    document.querySelectorAll('select[name="category"]').forEach(select => {
                        console.log('🔵 Updating dropdown with id:', select.id);
                        const currentValue = select.value;
                        select.innerHTML = '<option>-- Select Category --</option>';
                        categoryOptions.forEach(catName => {
                            const opt = document.createElement('option');
                            opt.value = catName;
                            opt.textContent = catName;
                            select.appendChild(opt);
                            console.log('🔵 Added option:', catName);
                        });
                        if (currentValue && categoryOptions.includes(currentValue)) {
                            select.value = currentValue;
                        }
                    });
                    
                    console.log('✅ Loaded categories for server:', categoryOptions);
                } else {
                    console.error('🔴 API returned status:', res.status);
                }
            } catch (err) {
                console.error('🔴 Failed to load categories:', err);
            }
        }

        let currentEditingRoles = [];

        function loadCategoryDetails() {
            const categoryName = document.getElementById('editCategorySelect').value;
            const detailsDiv = document.getElementById('categoryDetails');
            
            if (categoryName === '-- Select Category --' || !currentCategories[categoryName]) {
                detailsDiv.style.display = 'none';
                return;
            }
            
            const categoryData = currentCategories[categoryName];
            document.getElementById('editCategoryName').value = categoryName || '';
            document.getElementById('editCategoryMessage').value = categoryData.message || '';
            document.getElementById('editCategoryChannel').value = categoryData.channel || '';
            document.getElementById('newRoleInput').value = '';
            
            // Store and display roles
            currentEditingRoles = categoryData.roles || [];
            displayRolesList();
            
            detailsDiv.style.display = 'block';
        }

        function displayRolesList() {
            const rolesList = document.getElementById('rolesList');
            
            if (currentEditingRoles.length === 0) {
                rolesList.innerHTML = '<div style="color: rgba(255, 255, 255, 0.5); font-size: 0.8rem; padding: 0.5rem;">No roles yet</div>';
                return;
            }
            
            rolesList.innerHTML = '';
            currentEditingRoles.forEach((role, index) => {
                const roleEl = document.createElement('div');
                roleEl.style.cssText = `
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem;
                    background: rgba(var(--theme-color), 0.1);
                    border-radius: 4px;
                    margin-bottom: 0.5rem;
                    font-size: 0.85rem;
                `;
                
                const roleFormat = role.startsWith('@') ? role : `@${role}`;
                roleEl.innerHTML = `
                    <span>${roleFormat} - ${role.replace('@', '')}</span>
                    <button onclick="removeRoleFromCategory(${index})" style="background: rgba(255, 107, 107, 0.3); border: none; color: #ff6b6b; padding: 0.25rem 0.5rem; border-radius: 3px; cursor: pointer; font-size: 0.75rem;">Remove</button>
                `;
                rolesList.appendChild(roleEl);
            });
        }

        function addRoleToCategory() {
            const input = document.getElementById('newRoleInput');
            let roleName = input.value.trim();
            
            if (!roleName) {
                alert('Please enter a role name');
                return;
            }
            
            // Remove @ if user included it
            roleName = roleName.replace(/^@/, '');
            
            // Check for duplicates
            if (currentEditingRoles.some(r => r.toLowerCase() === roleName.toLowerCase())) {
                alert('This role is already added');
                return;
            }
            
            currentEditingRoles.push(roleName);
            input.value = '';
            displayRolesList();
        }

        function removeRoleFromCategory(index) {
            currentEditingRoles.splice(index, 1);
            displayRolesList();
        }

        async function quickSetup(setupType) {
            const setupNames = {
                'gaming': 'Gaming Roles',
                'watchparty': 'Watch Party',
                'platform': 'Platform Roles',
                'removeRoles': 'Remove Roles',
                'levelRoles': 'Level Roles (1-100)'
            };

            const loadingMsg = `⏳ Setting up ${setupNames[setupType]}...`;
            alert(loadingMsg);

            try {
                const res = await fetch(`/api/quick-setup/${setupType}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ guildId: currentGuildId }),
                    credentials: 'include'
                });

                const data = await res.json();
                
                if (res.ok) {
                    alert(`✅ ${setupNames[setupType]} setup complete!\n\n${data.message || ''}`);
                } else {
                    alert(`❌ Setup failed: ${data.error || 'Unknown error'}`);
                }
            } catch (err) {
                console.error('Error:', err);
                alert(`❌ Failed to setup ${setupNames[setupType]}`);
            }
        }

        let creatingCategoryRoles = [];

        function addRoleWhileCreating() {
            const input = document.getElementById('creatingRoleInput');
            let roleName = input.value.trim();
            
            if (!roleName) {
                alert('Please enter a role name');
                return;
            }
            
            roleName = roleName.replace(/^@/, '');
            
            if (creatingCategoryRoles.some(r => r.toLowerCase() === roleName.toLowerCase())) {
                alert('This role is already added');
                return;
            }
            
            creatingCategoryRoles.push(roleName);
            input.value = '';
            displayCreatingRolesList();
        }

        function removeRoleWhileCreating(index) {
            creatingCategoryRoles.splice(index, 1);
            displayCreatingRolesList();
        }

        function displayCreatingRolesList() {
            const rolesList = document.getElementById('creatingRolesList');
            
            if (creatingCategoryRoles.length === 0) {
                rolesList.innerHTML = '<div style="color: rgba(255, 255, 255, 0.5); font-size: 0.8rem; padding: 0.5rem;">Add roles below</div>';
                return;
            }
            
            rolesList.innerHTML = '';
            creatingCategoryRoles.forEach((role, index) => {
                const roleEl = document.createElement('div');
                roleEl.style.cssText = `
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem;
                    background: rgba(var(--theme-color), 0.1);
                    border-radius: 4px;
                    margin-bottom: 0.5rem;
                    font-size: 0.85rem;
                `;
                
                const roleFormat = role.startsWith('@') ? role : `@${role}`;
                roleEl.innerHTML = `
                    <span>${roleFormat} - ${role.replace('@', '')}</span>
                    <button onclick="removeRoleWhileCreating(${index})" style="background: rgba(255, 107, 107, 0.3); border: none; color: #ff6b6b; padding: 0.25rem 0.5rem; border-radius: 3px; cursor: pointer; font-size: 0.75rem;">Remove</button>
                `;
                rolesList.appendChild(roleEl);
            });
        }

        async function createRoleCategory() {
            // Get guild ID from localStorage (most up-to-date source)
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            // Check if server is selected
            if (!guildId) {
                alert('❌ Please select a server first from the dropdown');
                return;
            }

            const name = document.getElementById('categoryName').value.trim();
            const message = document.getElementById('categoryMessage').value.trim();
            
            if (!name) {
                alert('❌ Please enter a category name');
                return;
            }
            
            // Gather selected roles from multi-select as {name, id} objects
            const sel = document.getElementById('cc_roleSelect');
            let selectedRoles = [];
            if (sel && sel.classList.contains('custom-multiselect') && sel.getSelected) {
                selectedRoles = sel.getSelected().map(o => ({ name: o.text.trim(), id: o.value }));
            } else if (sel) {
                selectedRoles = Array.from(sel.selectedOptions).map(o => ({ name: o.textContent.trim(), id: o.value }));
            }
            
            if (selectedRoles.length === 0) {
                alert('❌ Please select at least one role');
                return;
            }
            
            try {
                const url = `/api/config/role-categories?guildId=${guildId}`;
                const payload = {
                    categoryName: name,
                    message: message || 'Select a role below',
                    roles: selectedRoles
                };
                
                console.log('🔵 Creating category:', { url, payload, guildId, rolesCount: creatingCategoryRoles.length });
                
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('🔵 API Response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    alert(`✅ Category "${name}" created with ${selectedRoles.length} roles!`);
                    // Clear form
                    document.getElementById('categoryName').value = '';
                    document.getElementById('categoryMessage').value = '';
                    // Deselect all options in multi-select
                    if (sel && sel.clearSelection) sel.clearSelection();
                    else if (sel) Array.from(sel.options).forEach(o => o.selected = false);
                    
                    // Reload all category displays
                    await loadRoleCategories(guildId);
                    await loadReactRoles();
                } else {
                    alert(`❌ Error: ${data.error || 'Failed to create category'}`);
                    console.error('🔴 API Error:', data);
                }
            } catch (err) {
                console.error('🔴 Error creating category:', err);
                alert(`❌ Error: ${err.message}`);
            }
        }

        async function saveCategoryChanges() {
            // Get guild ID from localStorage (most up-to-date source)
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            if (!guildId) {
                alert('❌ Please select a server first from the dropdown');
                return;
            }

            const oldName = document.getElementById('editCategorySelect').value;
            const newName = document.getElementById('editCategoryName').value.trim();
            const message = document.getElementById('editCategoryMessage').value.trim();
            
            if (!newName) {
                alert('❌ Please enter a category name');
                return;
            }
            
            if (currentEditingRoles.length === 0) {
                alert('❌ Please add at least one role to this category');
                return;
            }
            
            try {
                const url = `/api/config/role-categories?guildId=${guildId}`;
                const payload = {
                    oldCategoryName: oldName,
                    categoryName: newName,
                    message: message || 'Select a role below',
                    roles: currentEditingRoles
                };

                console.log('🔵 Updating category:', { url, payload, guildId, rolesCount: currentEditingRoles.length });
                
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('🔵 API Response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    alert(`✅ Category "${newName}" updated with ${currentEditingRoles.length} roles!`);
                    await loadRoleCategories(guildId);
                } else {
                    alert(`❌ Error: ${data.error || 'Failed to update category'}`);
                    console.error('🔴 API Error:', data);
                }
            } catch (err) {
                console.error('🔴 Error updating category:', err);
                alert(`❌ Error: ${err.message}`);
            }
        }

        async function postCategoryToChannel() {
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            if (!guildId) {
                alert('❌ Please select a server first');
                return;
            }
            
            const categoryName = document.getElementById('editCategorySelect').value;
            if (categoryName === '-- Select Category --' || !categoryName) {
                alert('❌ Please select a category first');
                return;
            }
            
            const channelId = prompt('📤 Enter the Channel ID to post this category selector to:\n(You can get it by right-clicking the channel in Discord)');
            if (!channelId) return;
            
            try {
                console.log('🔵 Posting category to channel:', { categoryName, channelId, guildId });
                
                const res = await fetch(`/api/post-category?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ categoryName, channelId }),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('🔵 Post response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    alert(`✅ Category posted to channel!\n\nMessage ID: ${data.messageId}`);
                } else {
                    alert(`❌ Error: ${data.error || 'Failed to post'}`);
                    console.error('🔴 Post Error:', data);
                }
            } catch (err) {
                console.error('🔴 Error posting category:', err);
                alert(`❌ Error: ${err.message}`);
            }
        }

        document.addEventListener('click', function(event) {
            const profileMenu = document.getElementById('profileMenu');
            const profile = document.querySelector('.user-profile');
            if (!profile.contains(event.target)) {
                profileMenu.classList.remove('active');
            }

            const serverDropdown = document.getElementById('serverDropdownMenu');
            const serverSelector = document.querySelector('.server-selector');
            if (!serverSelector.contains(event.target)) {
                serverDropdown.classList.remove('active');
            }
        });

        // ==================== MASTER HANDLERS FOR ALL TABS ====================
        async function loadTabConfig(configName) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return null;
            try {
                const res = await fetch(`/api/config/${configName}?guildId=${guildId}`, { credentials: 'include' });
                if (res.ok) return await res.json();
            } catch (e) { console.error('Error loading ' + configName + ':', e); }
            return {};
        }

        async function saveTabConfig(configName, data) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            try {
                const res = await fetch(`/api/config/${configName}?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                    credentials: 'include'
                });
                if (res.ok) return alert(`✅ ${configName} saved`);
                else alert(`❌ Failed to save ${configName}`);
            } catch (e) { alert('Error: ' + e.message); }
        }

        async function loadSettings() {
            const config = await loadTabConfig('settings');
            // Prefix is locked to "/" — do not overwrite
        }

        async function saveSettings() {
            // Prefix is locked to "/" — always save as /
            await saveTabConfig('settings', { prefix: '/' });
        }

        async function loadLogging() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
            const resp = await fetch('/api/config/' + guildId, { credentials: 'include' });
            if (!resp.ok) return;
            const fullConfig = await resp.json();
            const loggingObj = fullConfig.logging || {};
            const ml = loggingObj.messageLogging || {};
            const mod = loggingObj.moderationLogging || {};
            if (ml.logDeleted !== undefined) { const c = document.getElementById('log_deleted'); if (c) c.checked = ml.logDeleted; }
            if (ml.logEdited !== undefined) { const c = document.getElementById('log_edited'); if (c) c.checked = ml.logEdited; }
            if (ml.logBulkDelete !== undefined) { const c = document.getElementById('log_bulkDelete'); if (c) c.checked = ml.logBulkDelete; }
            if (ml.logChannel) { const s = document.getElementById('messageLogChannelSelect'); if (s) s.value = ml.logChannel; }
            if (mod.logBans !== undefined) { const c = document.getElementById('log_bans'); if (c) c.checked = mod.logBans; }
            if (mod.logKicks !== undefined) { const c = document.getElementById('log_kicks'); if (c) c.checked = mod.logKicks; }
            if (mod.logMutes !== undefined) { const c = document.getElementById('log_mutes'); if (c) c.checked = mod.logMutes; }
            if (mod.logWarns !== undefined) { const c = document.getElementById('log_warns'); if (c) c.checked = mod.logWarns; }
            if (mod.modLogChannel) { const s = document.getElementById('modLogChannelSelect'); if (s) s.value = mod.modLogChannel; }
            } catch (e) { console.error('Error loading logging:', e); }
        }

        async function saveLogging() {
            const data = {
                logDeleted: document.getElementById('log_deleted')?.checked ?? true,
                logEdited: document.getElementById('log_edited')?.checked ?? true,
                logBulkDelete: document.getElementById('log_bulkDelete')?.checked ?? false,
                logChannel: document.getElementById('messageLogChannelSelect')?.value || '',
                logBans: document.getElementById('log_bans')?.checked ?? true,
                logKicks: document.getElementById('log_kicks')?.checked ?? true,
                logMutes: document.getElementById('log_mutes')?.checked ?? true,
                logWarns: document.getElementById('log_warns')?.checked ?? true,
                modLogChannel: document.getElementById('modLogChannelSelect')?.value || ''
            };
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            try {
                const res = await fetch('/api/bot-config/logging?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                    credentials: 'include'
                });
                const result = await res.json();
                if (result.success) alert('✅ Logging settings saved!');
                else alert('❌ ' + (result.message || 'Failed'));
            } catch (e) { alert('Error: ' + e.message); }
        }

        async function loadServerGuard() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch('/api/config/' + guildId, { credentials: 'include' });
                if (!res.ok) return;
                const cfg = await res.json();
                const as = cfg.antiSpam || {};
                const rp = cfg.raidProtection || {};
                const pm = cfg.permissions || {};
                const an = cfg.antiNuke || {};
                const ls = cfg.linkScanning || {};
                const jg = cfg.joinGate || {};
                const rl = cfg.rateLimiting || {};
                const al = cfg.auditLog || {};
                const bu = cfg.backup || {};

                // Anti-Spam
                const el = (id, val) => { const e = document.getElementById(id); if (e) { if (e.type === 'checkbox') e.checked = val !== false; else e.value = val ?? e.value; } };
                el('sg_antiSpamEnabled', as.enabled);
                el('sg_antiSpamLimit', as.messagesPerLimit);
                el('sg_antiSpamAction', as.action);
                // Raid
                el('sg_raidEnabled', rp.enabled);
                el('sg_raidLimit', rp.usersPerLimit);
                el('sg_banRaidUsers', rp.banRaidUsers);
                // Permissions
                el('sg_membersOnly', pm.membersOnly);
                el('sg_adminsBypass', pm.adminsBypass);
                el('sg_allowDM', pm.allowDM);
                el('sg_confirmDangerous', pm.confirmDangerous);
                // Anti-Nuke
                el('sg_antiNukeEnabled', an.enabled);
                el('sg_antiNukeMode', an.mode);
                el('sg_antiNukeLimit', an.maxActions);
                // Link Scanning
                el('sg_linkScanEnabled', ls.enabled);
                el('sg_detectPhishing', ls.detectPhishing);
                el('sg_blockScamSites', ls.blockScamSites);
                el('sg_malwareDetection', ls.malwareDetection);
                // Join Gate
                el('sg_joinGateEnabled', jg.enabled);
                el('sg_accountAgeCheck', jg.accountAgeCheck);
                el('sg_minAccountAge', jg.minAccountAge);
                el('sg_suspiciousAvatars', jg.suspiciousAvatars);
                el('sg_usernameAnalysis', jg.usernameAnalysis);
                // Rate Limiting
                el('sg_rateLimitEnabled', rl.enabled);
                el('sg_rateLimitPerMin', rl.requestsPerMin);
                el('sg_dosProtection', rl.dosProtection);
                el('sg_rateLimitAction', rl.action);
                // Audit Log
                el('sg_auditLogEnabled', al.enabled);
                el('sg_auditLogChannel', al.channel);
                el('sg_logApiRequests', al.logApiRequests);
                el('sg_ipTracking', al.ipTracking);
                // Backup
                el('sg_autoBackup', bu.enabled);
                el('sg_backupFrequency', bu.frequency);
                el('sg_backupRetention', bu.retention);
            } catch (e) { console.error('Error loading server guard:', e); }
        }

        function collectServerGuardData() {
            const cb = id => document.getElementById(id)?.checked ?? false;
            const val = id => document.getElementById(id)?.value || '';
            return {
                antiSpam: { enabled: cb('sg_antiSpamEnabled'), messagesPerLimit: parseInt(val('sg_antiSpamLimit')) || 5, action: val('sg_antiSpamAction') || 'warn' },
                raidProtection: { enabled: cb('sg_raidEnabled'), usersPerLimit: parseInt(val('sg_raidLimit')) || 10, banRaidUsers: cb('sg_banRaidUsers') },
                permissions: { membersOnly: cb('sg_membersOnly'), adminsBypass: cb('sg_adminsBypass'), allowDM: cb('sg_allowDM'), confirmDangerous: cb('sg_confirmDangerous') },
                antiNuke: { enabled: cb('sg_antiNukeEnabled'), mode: val('sg_antiNukeMode') || 'monitor', maxActions: parseInt(val('sg_antiNukeLimit')) || 10 },
                linkScanning: { enabled: cb('sg_linkScanEnabled'), detectPhishing: cb('sg_detectPhishing'), blockScamSites: cb('sg_blockScamSites'), malwareDetection: cb('sg_malwareDetection') },
                joinGate: { enabled: cb('sg_joinGateEnabled'), accountAgeCheck: cb('sg_accountAgeCheck'), minAccountAge: parseInt(val('sg_minAccountAge')) || 3, suspiciousAvatars: cb('sg_suspiciousAvatars'), usernameAnalysis: cb('sg_usernameAnalysis') },
                rateLimiting: { enabled: cb('sg_rateLimitEnabled'), requestsPerMin: parseInt(val('sg_rateLimitPerMin')) || 100, dosProtection: cb('sg_dosProtection'), action: val('sg_rateLimitAction') || 'throttle' },
                auditLog: { enabled: cb('sg_auditLogEnabled'), channel: val('sg_auditLogChannel'), logApiRequests: cb('sg_logApiRequests'), ipTracking: cb('sg_ipTracking') },
                backup: { enabled: cb('sg_autoBackup'), frequency: val('sg_backupFrequency') || '6h', retention: parseInt(val('sg_backupRetention')) || 30 }
            };
        }

        async function loadReactRoles() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch('/api/config/' + guildId, { credentials: 'include' });
                if (!res.ok) return;
                const data = await res.json();
                const rr = data.reactRoles || {};
                // Restore settings checkboxes
                const am = document.getElementById('rr_allowMultiple');
                const ru = document.getElementById('rr_removeOnUnreact');
                const dm = document.getElementById('rr_dmConfirm');
                if (am) am.checked = rr.allowMultiple !== false;
                if (ru) ru.checked = rr.removeOnUnreact !== false;
                if (dm) dm.checked = !!rr.dmConfirm;
                // Render active roles
                renderReactRoles(rr.entries || []);
                // Render role categories in the categories panel
                renderRRCategories(data.roleCategories || {});
                // Populate setup category dropdown
                const scSel = document.getElementById('sc_categorySelect');
                if (scSel) {
                    const curVal = scSel.value;
                    scSel.innerHTML = '<option value="">Select a category...</option>';
                    Object.keys(data.roleCategories || {}).forEach(name => {
                        const cat = data.roleCategories[name];
                        const roles = Array.isArray(cat.roles) ? cat.roles : (Array.isArray(cat) ? cat : []);
                        const opt = document.createElement('option');
                        opt.value = name;
                        opt.textContent = '📁 ' + name + ' (' + roles.length + ' roles)';
                        scSel.appendChild(opt);
                    });
                    if (curVal) scSel.value = curVal;
                }
                // Render typed role lists (gaming, watchparty, platform)
                renderTypedRoles('game', data.gameRoles || []);
                renderTypedRoles('watchparty', data.watchPartyRoles || []);
                renderTypedRoles('platform', data.platformRoles || []);
            } catch (e) { console.error('loadReactRoles error:', e); }
        }

        function renderReactRoles(entries) {
            const container = document.getElementById('rr_activeList');
            if (!container) return;
            if (!entries.length) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.5); text-align: center; padding: 1rem;">No reaction roles configured yet</div>';
                return;
            }
            container.innerHTML = '';
            entries.forEach((entry, i) => {
                const row = document.createElement('div');
                row.style.cssText = 'display:flex; justify-content:space-between; align-items:center; padding:0.6rem 0.75rem; background:rgba(0,212,255,0.08); border-radius:8px; margin-bottom:0.5rem; border:1px solid rgba(0,212,255,0.15);';
                row.innerHTML = `
                    <div style="display:flex; align-items:center; gap:0.75rem;">
                        <span style="font-size:1.3rem;">${entry.emoji || '❓'}</span>
                        <div>
                            <div style="font-weight:600; color:#fff;">@${entry.roleName || entry.roleId}</div>
                            <div style="font-size:0.75rem; color:rgba(255,255,255,0.5);">Channel: #${entry.channelName || entry.channelId} &bull; Msg: ${entry.messageId}</div>
                        </div>
                    </div>
                    <button onclick="deleteReactRole(${i})" style="background:rgba(255,107,107,0.2); border:1px solid rgba(255,107,107,0.3); color:#ff6b6b; padding:0.3rem 0.75rem; border-radius:6px; cursor:pointer; font-size:0.8rem;">🗑️ Remove</button>
                `;
                container.appendChild(row);
            });
        }

        function renderRRCategories(categories) {
            const container = document.getElementById('rr_categoriesList');
            if (!container) return;
            const keys = Object.keys(categories);
            if (!keys.length) {
                container.innerHTML = '<div style="color: rgba(255,255,255,0.5); text-align: center; padding: 1rem;">No role categories configured</div>';
                return;
            }
            container.innerHTML = '';
            keys.forEach(name => {
                const cat = categories[name];
                const roles = Array.isArray(cat.roles) ? cat.roles : (Array.isArray(cat) ? cat : []);
                const el = document.createElement('div');
                el.style.cssText = 'display:flex; justify-content:space-between; align-items:center; padding:0.6rem 0.75rem; background:rgba(145,70,255,0.08); border-radius:8px; margin-bottom:0.5rem; border:1px solid rgba(145,70,255,0.15);';
                el.innerHTML = `
                    <div>
                        <div style="font-weight:600; color:#fff;">📁 ${name}</div>
                        <div style="font-size:0.75rem; color:rgba(255,255,255,0.5); margin-top:0.25rem;">${roles.length} role${roles.length !== 1 ? 's' : ''}: ${roles.map(r => typeof r === 'string' ? r : r.name).join(', ') || 'none'}</div>
                    </div>
                    <button onclick="deleteCategory('${name.replace(/'/g, "\\'")}')" style="background:rgba(255,107,107,0.2); border:1px solid rgba(255,107,107,0.3); color:#ff6b6b; padding:0.3rem 0.75rem; border-radius:6px; cursor:pointer; font-size:0.8rem;">🗑️ Delete</button>
                `;
                container.appendChild(el);
            });
        }

        async function setupCategory() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            const categoryName = document.getElementById('sc_categorySelect')?.value;
            const channelId = document.getElementById('sc_channelSelect')?.value;
            if (!categoryName) return alert('⚠️ Please select a category');
            if (!channelId) return alert('⚠️ Please select a channel');
            try {
                const res = await fetch('/api/bot-config/setup-category?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ categoryName, channelId }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    alert('✅ Category selector for "' + categoryName + '" posted!\n\n' + (data.message || ''));
                } else {
                    alert('❌ ' + (data.error || 'Failed to post category selector'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function deleteCategory(categoryName) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            if (!confirm('Delete category "' + categoryName + '"? This will remove it from the bot too.')) return;
            try {
                const res = await fetch('/api/bot-config/role-category/delete?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ categoryName }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    alert('✅ Category "' + categoryName + '" deleted');
                    loadReactRoles();
                    loadRoleCategories(guildId);
                } else {
                    alert('❌ ' + (data.message || 'Failed'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        function renderTypedRoles(type, roles) {
            const listIds = { game: 'gr_list', watchparty: 'wp_list', platform: 'pl_list' };
            const container = document.getElementById(listIds[type]);
            if (!container) return;
            if (!roles || !roles.length) {
                container.innerHTML = '<div style="color:rgba(255,255,255,0.4); font-size:0.8rem; text-align:center; padding:0.5rem;">No roles added yet</div>';
                return;
            }
            container.innerHTML = '';
            roles.forEach((role, i) => {
                const name = typeof role === 'string' ? role : role.name;
                const row = document.createElement('div');
                row.style.cssText = 'display:flex; justify-content:space-between; align-items:center; padding:0.45rem 0.6rem; background:rgba(0,212,255,0.06); border-radius:6px; margin-bottom:0.4rem; border:1px solid rgba(0,212,255,0.1);';
                row.innerHTML = `
                    <span style="font-size:0.85rem; color:#fff;">@${name}</span>
                    <button onclick="removeTypedRole('${type}', ${i})" style="background:rgba(255,107,107,0.2); border:1px solid rgba(255,107,107,0.3); color:#ff6b6b; padding:0.2rem 0.6rem; border-radius:5px; cursor:pointer; font-size:0.75rem;">✕</button>
                `;
                container.appendChild(row);
            });
        }

        async function addTypedRole(type) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            const selectIds = { game: 'gr_roleSelect', watchparty: 'wp_roleSelect', platform: 'pl_roleSelect' };
            const selectEl = document.getElementById(selectIds[type]);
            if (!selectEl) return;
            // Gather all selected options (works with both custom-multiselect and native select)
            let selected, roles;
            if (selectEl.classList.contains('custom-multiselect') && selectEl.getSelected) {
                selected = selectEl.getSelected();
                if (!selected.length) return alert('Please select at least one role');
                roles = selected.map(o => ({ roleId: o.value, roleName: o.text }));
            } else {
                selected = Array.from(selectEl.selectedOptions).filter(o => o.value);
                if (!selected.length) return alert('Please select at least one role');
                roles = selected.map(o => ({ roleId: o.value, roleName: o.text }));
            }
            try {
                const res = await fetch('/api/bot-config/typed-role/add?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, roles }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    // Clear selections
                    if (selectEl.clearSelection) selectEl.clearSelection();
                    else Array.from(selectEl.options).forEach(o => o.selected = false);
                    loadTypedRoles();
                    const count = data.added || roles.length;
                    if (count > 1) alert('✅ Added ' + count + ' roles!');
                } else {
                    alert('❌ ' + (data.error || data.message || 'Failed'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function removeTypedRole(type, index) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch('/api/bot-config/typed-role/remove?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, index }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) loadTypedRoles();
                else alert('❌ ' + (data.message || 'Failed'));
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function loadTypedRoles() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch('/api/config/' + guildId, { credentials: 'include' });
                if (!res.ok) return;
                const data = await res.json();
                renderTypedRoles('game', data.gameRoles || []);
                renderTypedRoles('watchparty', data.watchPartyRoles || []);
                renderTypedRoles('platform', data.platformRoles || []);
            } catch (e) { console.error('loadTypedRoles error:', e); }
        }

        async function addReactRole() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            const channelId = document.getElementById('rr_channelSelect')?.value;
            const messageId = document.getElementById('rr_messageId')?.value?.trim();
            const emoji = document.getElementById('rr_emoji')?.value?.trim();
            const roleId = document.getElementById('rr_roleSelect')?.value;
            if (!channelId || !messageId || !emoji || !roleId) return alert('Please fill in all fields: Channel, Message ID, Emoji, and Role');
            try {
                const res = await fetch('/api/bot-config/react-roles/add?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ channelId, messageId, emoji, roleId }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    alert('✅ Reaction role added! The bot will now add the reaction to the message.');
                    document.getElementById('rr_messageId').value = '';
                    document.getElementById('rr_emoji').value = '';
                    loadReactRoles();
                } else {
                    alert('❌ ' + (data.error || data.message || 'Failed to add reaction role'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function deleteReactRole(index) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            if (!confirm('Remove this reaction role?')) return;
            try {
                const res = await fetch('/api/bot-config/react-roles/remove?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ index }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    loadReactRoles();
                } else {
                    alert('❌ ' + (data.message || 'Failed to remove'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function postReactRoleMessage() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return alert('Select a server first');
            const channelId = document.getElementById('rr_postChannel')?.value;
            const title = document.getElementById('rr_postTitle')?.value?.trim();
            const description = document.getElementById('rr_postDesc')?.value?.trim();
            if (!channelId) return alert('Please select a channel to post to');
            if (!title) return alert('Please enter a title');
            try {
                const res = await fetch('/api/bot-config/react-roles/post?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ channelId, title, description }),
                    credentials: 'include'
                });
                const data = await res.json();
                if (data.success) {
                    alert('✅ Reaction role message posted! Message ID: ' + data.messageId + '\n\nNow add reaction roles using this message ID.');
                    document.getElementById('rr_messageId').value = data.messageId;
                } else {
                    alert('❌ ' + (data.error || data.message || 'Failed to post'));
                }
            } catch (e) { alert('❌ Error: ' + e.message); }
        }

        async function saveReactRoles() {
            // Settings only — entries are added/removed individually via addReactRole/deleteReactRole
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return { success: false };
            const settingsData = {
                allowMultiple: document.getElementById('rr_allowMultiple')?.checked ?? true,
                removeOnUnreact: document.getElementById('rr_removeOnUnreact')?.checked ?? true,
                dmConfirm: document.getElementById('rr_dmConfirm')?.checked ?? false
            };
            try {
                const res = await fetch('/api/bot-config/react-roles/settings?guildId=' + guildId, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settingsData),
                    credentials: 'include'
                });
                return await res.json();
            } catch (e) { return { success: false, message: e.message }; }
        }

        async function loadServerMessages() {
            const config = await loadTabConfig('server-messages');
            const ta = document.querySelector('#server-messages-section textarea');
            if (ta && config.welcomeMessage) ta.value = config.welcomeMessage;
        }

        async function saveServerMessages() {
            const welcomeMsg = document.querySelector('#server-messages-section textarea')?.value || '';
            await saveTabConfig('server-messages', { welcomeMessage: welcomeMsg });
        }

        async function loadCustomCommands() {
            await loadTabConfig('custom-commands');
        }

        async function saveCustomCommands() {
            const name = document.querySelector('#custom-commands-section input')?.value || '';
            const response = document.querySelector('#custom-commands-section textarea')?.value || '';
            if (!name || !response) return alert('Fill in all fields');
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch(`/api/commands/${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, response }),
                    credentials: 'include'
                });
                if (res.ok) {
                    alert('✅ Command created');
                    document.querySelector('#custom-commands-section input').value = '';
                    document.querySelector('#custom-commands-section textarea').value = '';
                } else {
                    alert('❌ Failed to create command');
                }
            } catch (e) { alert('Error: ' + e.message); }
        }

        async function loadXPLevels() {
            await loadTabConfig('xp-levels');
        }

        async function saveXPLevels() {
            const xpPerLevel = document.querySelector('#xp-levels-section input[placeholder="500"]')?.value || '500';
            await saveTabConfig('xp-levels', { xpPerLevel: parseInt(xpPerLevel) });
        }

        async function loadLeaderboards() {
            await loadTabConfig('leaderboards');
        }

        async function saveLeaderboards() {
            await saveTabConfig('leaderboards', { enabled: true });
        }

        async function loadGiveaways() {
            await loadTabConfig('giveaways');
        }

        async function createGiveaway() {
            const prize = document.querySelector('#giveaways-section input[placeholder*="Discord"]')?.value || '';
            const duration = document.querySelector('#giveaways-section input[placeholder*="minutes"]')?.value || '60';
            if (!prize) return alert('Enter a prize');
            await saveTabConfig('giveaways', { prize, duration: parseInt(duration), active: true });
        }

        async function loadSocialNotifs() {
            await loadTabConfig('social-notifs');
        }

        async function addStreamer() {
            await saveTabConfig('social-notifs', { enabled: true });
        }

        async function loadInviteTracking() {
            await loadTabConfig('invite-tracking');
        }

        async function saveInviteTracking() {
            await saveTabConfig('invite-tracking', { enabled: true });
        }

        async function loadMessageCounting() {
            await loadTabConfig('message-counting');
        }

        async function saveMessageCounting() {
            await saveTabConfig('message-counting', { enabled: true });
        }

        async function loadRecordings() {
            await loadTabConfig('recordings');
        }

        async function saveRecordings() {
            await saveTabConfig('recordings', { enabled: true });
        }

        async function loadReminders() {
            await loadTabConfig('reminders');
        }

        async function createReminder() {
            await saveTabConfig('reminders', { enabled: true });
        }

        async function loadStatisticChannels() {
            await loadTabConfig('statistics-channels');
        }

        async function addStatChannel() {
            await saveTabConfig('statistics-channels', { enabled: true });
        }

        // ========== ACTIVITY LOGGING FUNCTIONS - LIVE FROM SERVER ==========
        let activityLogs = [];
        let activityRefreshInterval = null;
        const MAX_LOGS = 500;

        function addActivityLog(category, message, severity = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const log = { timestamp, category, message, severity };
            activityLogs.unshift(log);
            
            if (activityLogs.length > MAX_LOGS) {
                activityLogs.pop();
            }
            localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
        }

        async function fetchLiveActivities() {
            try {
                const response = await fetch('/api/dashboard/activity', { credentials: 'include' });
                if (!response.ok) throw new Error('Failed to fetch activities');
                
                const data = await response.json();
                if (data.activities && data.activities.length > 0) {
                    // Map server activities to display format
                    activityLogs = data.activities.map(activity => ({
                        timestamp: activity.time || new Date().toLocaleTimeString(),
                        category: getCategoryFromIcon(activity.icon),
                        message: `${activity.text} - ${activity.action}`,
                        severity: getSeverityFromIcon(activity.icon),
                        icon: activity.icon
                    }));
                    displayActivityLogs();
                } else {
                    displayActivityLogs();
                }
            } catch (e) {
                console.log('Activity fetch error (normal if not logged in):', e.message);
                displayActivityLogs();
            }
        }

        function getCategoryFromIcon(icon) {
            const categoryMap = {
                '🎤': 'voice',
                '⚠️': 'moderation',
                '💰': 'economy',
                '📈': 'leveling',
                '🎵': 'music',
                '👤': 'members',
                '👥': 'members',
                '⚙️': 'config',
                '📢': 'alert',
                '🛡️': 'moderation'
            };
            return categoryMap[icon] || 'alert';
        }

        function getSeverityFromIcon(icon) {
            if (icon === '⚠️' || icon === '🛡️') return 'warning';
            if (icon === '❌' || icon === '🔴') return 'error';
            return 'info';
        }

        function displayActivityLogs() {
            const logsList = document.getElementById('activityLogsList');
            if (!logsList) return;
            
            if (activityLogs.length === 0) {
                logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">⏳ Waiting for activities... Messages will appear here as they happen</div>';
                return;
            }

            let html = activityLogs.map(log => {
                const icons = {
                    'voice': '🎤',
                    'moderation': '⚠️',
                    'economy': '💰',
                    'leveling': '📈',
                    'music': '🎵',
                    'members': '👥',
                    'config': '⚙️',
                    'alert': '📢'
                };
                const icon = icons[log.category] || log.icon || '📋';
                const color = log.severity === 'error' ? '#ff6b6b' : log.severity === 'warning' ? '#ffd700' : '#00d4ff';
                
                return `<div style="color: ${color}; margin: 0.5rem 0; padding: 0.5rem; border-left: 2px solid ${color}; padding-left: 0.75rem;">
                    [${log.timestamp}] ${icon} ${log.category.toUpperCase()}: ${log.message}
                </div>`;
            }).join('');
            
            logsList.innerHTML = html;
        }

        function filterActivityLogs() {
            displayActivityLogs();
        }

        function clearActivityLogs() {
            if (confirm('Clear all activity logs? This cannot be undone.')) {
                activityLogs = [];
                localStorage.removeItem('activityLogs');
                displayActivityLogs();
                alert('✅ Activity logs cleared');
            }
        }

        // Load logs from localStorage on startup
        function loadActivityLogs() {
            const saved = localStorage.getItem('activityLogs');
            if (saved) {
                try {
                    activityLogs = JSON.parse(saved);
                } catch (e) {
                    activityLogs = [];
                }
            }
            // Fetch latest from server
            fetchLiveActivities();
        }

        // Initialize activity logging with auto-refresh
        function initializeActivityLogging() {
            loadActivityLogs();
            
            // Refresh activities every 3 seconds for live updates
            if (activityRefreshInterval) clearInterval(activityRefreshInterval);
            activityRefreshInterval = setInterval(() => {
                fetchLiveActivities();
            }, 3000);
        }

        // Call on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeActivityLogging);
        } else {
            initializeActivityLogging();
        }

        function switchSection(sectionName) {
            console.log('🔵 switchSection:', sectionName);
            try {
                // 1. HIDE ALL - force display none on EVERY section
                const allSections = document.querySelectorAll('.content-section');
                allSections.forEach(s => {
                    s.style.display = 'none';
                    s.style.visibility = 'hidden';
                    s.style.zIndex = '0';
                    s.classList.remove('active');
                });
                
                // 2. DEACTIVATE all sidebar items
                document.querySelectorAll('.sidebar-item').forEach(i => {
                    i.classList.remove('active');
                });
                
                // 3. ACTIVATE the clicked sidebar item
                const activeItem = document.querySelector(`[data-section="${sectionName}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
                
                // 4. SHOW target section - FORCE IT
                const sectionId = sectionName + '-section';
                const section = document.getElementById(sectionId);
                
                if (section) {
                    section.style.display = 'block';
                    section.style.visibility = 'visible';
                    section.style.zIndex = '100';
                    section.classList.add('active');
                    console.log('   ✅ Section shown:', sectionName);
                    
                    // Scroll to top
                    section.scrollIntoView({ behavior: 'auto', block: 'start' });
                    
                    // Load tab-specific data
                    const loadMap = {
                        'dashboard': loadMemberGraphs,
                        'events': loadMemberEvents,
                        'settings': loadSettings,
                        'logging': loadLogging,
                        'server-guard': loadServerGuard,
                        'react-roles': loadReactRoles,
                        'server-messages': loadServerMessages,
                        'custom-commands': loadCustomCommands,
                        'xp-levels': loadXPLevels,
                        'leaderboards': loadLeaderboards,
                        'giveaways': loadGiveaways,
                        'social-notifs': loadSocialNotifs,
                        'invite-tracking': loadInviteTracking,
                        'message-counting': loadMessageCounting,
                        'recordings': loadRecordings,
                        'reminders': loadReminders,
                        'statistics-channels': loadStatisticChannels,
                        'role-categories': () => loadRoleCategories(localStorage.getItem('selectedServerId'))
                    };
                    
                    if (loadMap[sectionName]) {
                        try {
                            const loadFn = loadMap[sectionName];
                            if (typeof loadFn === 'function') loadFn();
                        } catch (e) {
                            console.error('Error loading ' + sectionName + ':', e);
                        }
                    }
                } else {
                    console.error('   ❌ Section NOT found:', sectionId);
                }
            } catch (err) {
                console.error('   ❌ ERROR:', err.message);
            }
        }
        
        // Legacy support for event listeners (backup)
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', function() {
                const section = this.dataset.section;
                switchSection(section);
            });
        });

        function logout() {
            fetch('/logout', { method: 'POST', credentials: 'include' })
                .then(() => window.location.href = '/login');
        }

        // Load Colors from LocalStorage
        function loadSavedColors() {
            // Load SAVED colors (persisted from last save)
            const themeColor = localStorage.getItem('savedThemeColor') || localStorage.getItem('themeColor') || '#00d4ff';
            const cyanAccent = localStorage.getItem('savedAccentCyan') || localStorage.getItem('accentCyan') || '#00d4ff';
            const purpleAccent = localStorage.getItem('savedAccentPurple') || localStorage.getItem('accentPurple') || '#9146ff';
            const pinkAccent = localStorage.getItem('savedAccentPink') || localStorage.getItem('accentPink') || '#ff69b4';
            const textColor = localStorage.getItem('savedTextColor') || localStorage.getItem('textColor') || '#ffffff';

            // Apply colors to CSS
            const themeRgb = hexToRgb(themeColor);
            document.documentElement.style.setProperty('--theme-color', themeRgb);
            document.documentElement.style.setProperty('--accent-cyan', cyanAccent);
            document.documentElement.style.setProperty('--accent-purple', purpleAccent);
            document.documentElement.style.setProperty('--accent-pink', pinkAccent);
            document.documentElement.style.setProperty('--text-color', textColor);

            // Update input values and labels
            if (document.getElementById('themeColorPicker')) {
                document.getElementById('themeColorPicker').value = themeColor;
                document.getElementById('themeColorLabel').textContent = `${themeColor.toUpperCase()} (Custom)`;
            }
            if (document.getElementById('cyanColorPicker')) {
                document.getElementById('cyanColorPicker').value = cyanAccent;
                document.getElementById('cyanColorLabel').textContent = cyanAccent.toUpperCase();
            }
            if (document.getElementById('purpleColorPicker')) {
                document.getElementById('purpleColorPicker').value = purpleAccent;
                document.getElementById('purpleColorLabel').textContent = purpleAccent.toUpperCase();
            }
            if (document.getElementById('pinkColorPicker')) {
                document.getElementById('pinkColorPicker').value = pinkAccent;
                document.getElementById('pinkColorLabel').textContent = pinkAccent.toUpperCase();
            }
            if (document.getElementById('textColorPicker')) {
                document.getElementById('textColorPicker').value = textColor;
                document.getElementById('textColorLabel').textContent = textColor.toUpperCase();
            }

            // Store as originalValues for unsaved changes detection
            originalValues['themeColorPicker'] = themeColor;
            originalValues['cyanColorPicker'] = cyanAccent;
            originalValues['purpleColorPicker'] = purpleAccent;
            originalValues['pinkColorPicker'] = pinkAccent;
            originalValues['textColorPicker'] = textColor;
        }

        window.addEventListener('load', async () => {
            // Load saved colors
            loadSavedColors();

            // Load saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'dark';
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('modeIcon').textContent = '☀️';
            } else {
                document.getElementById('modeIcon').textContent = '🌙';
            }

            try {
                const res = await fetch('/api/user', { credentials: 'include' });
                if (res.ok) {
                    const data = await res.json();
                    const user = data.user;
                    
                    // Display Discord username
                    const displayName = user.global_name || user.username || 'User';
                    document.getElementById('userName').textContent = displayName;
                    
                    // Set user avatar with Discord profile picture
                    const userAvatar = document.getElementById('userAvatar');
                    if (user.avatar) {
                        userAvatar.innerHTML = `<img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128" alt="${displayName}" style="width: 100%; height: 100%; border-radius: 50%;">`;
                    } else {
                        const initial = displayName.charAt(0).toUpperCase();
                        userAvatar.textContent = initial;
                    }
                    
                    // Set user role/status
                    document.getElementById('userRole').textContent = 'Authenticated';
                    
                    // Clear any previously saved server — user must choose each session
                    localStorage.removeItem('selectedServerId');
                    document.getElementById('serverDisplayName').textContent = 'Select Server';
                    updateServerBtnIcon(null, null, null);
                    
                    // Show the blur overlay prompting server selection
                    showServerOverlay();
                } else {
                    // Not authenticated or other error - show login prompt
                    if (res.status === 401) {
                        // Replace main content with login CTA
                        const container = document.querySelector('.container') || document.body;
                        container.innerHTML = `
                            <div style="text-align:center;padding:4rem;">
                                <h2 style="color:#fff;margin-bottom:1rem;">Please sign in to access the Admin Dashboard</h2>
                                <p style="color:#ccc;margin-bottom:1.5rem;">Click the button below to login with Discord (admins only).</p>
                                <a href="/login" class="btn btn-primary" style="padding:0.8rem 1.6rem;border-radius:10px;">Login with Discord</a>
                            </div>
                        `;
                    } else {
                        console.error('Failed to load user data:', res.status, res.statusText);
                        const container = document.querySelector('.container') || document.body;
                        container.insertAdjacentHTML('afterbegin', `<div style="color:#ff6b6b;padding:1rem;border-radius:8px;margin-bottom:1rem;">Error loading dashboard data: ${res.status} ${res.statusText}</div>`);
                    }
                }
            } catch (err) {
                console.error('Failed to load user:', err);
                window.location.href = '/login';
            }
        });

        // Color Theme Functions
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : '0, 212, 255';
        }

        function changeThemeColor(color) {
            const rgb = hexToRgb(color);
            document.documentElement.style.setProperty('--theme-color', rgb);
            document.getElementById('themeColorPicker').value = color;
            document.getElementById('themeColorLabel').textContent = `${color.toUpperCase()} (Custom)`;
            localStorage.setItem('themeColor', color);
            showUnsavedNotification();
            checkIfChangesReverted();
        }

        function changeCyanAccent(color) {
            document.documentElement.style.setProperty('--accent-cyan', color);
            document.getElementById('cyanColorPicker').value = color;
            document.getElementById('cyanColorLabel').textContent = color.toUpperCase();
            localStorage.setItem('accentCyan', color);
            showUnsavedNotification();
            checkIfChangesReverted();
        }

        function changePurpleAccent(color) {
            document.documentElement.style.setProperty('--accent-purple', color);
            document.getElementById('purpleColorPicker').value = color;
            document.getElementById('purpleColorLabel').textContent = color.toUpperCase();
            localStorage.setItem('accentPurple', color);
            showUnsavedNotification();
            checkIfChangesReverted();
        }

        function changePinkAccent(color) {
            document.documentElement.style.setProperty('--accent-pink', color);
            document.getElementById('pinkColorPicker').value = color;
            document.getElementById('pinkColorLabel').textContent = color.toUpperCase();
            localStorage.setItem('accentPink', color);
            showUnsavedNotification();
            checkIfChangesReverted();
        }

        function changeTextColor(color) {
            document.documentElement.style.setProperty('--text-color', color);
            document.getElementById('textColorPicker').value = color;
            document.getElementById('textColorLabel').textContent = color.toUpperCase();
            localStorage.setItem('textColor', color);
            showUnsavedNotification();
            checkIfChangesReverted();
        }

        function resetColors() {
            // Reset only unsaved color changes - revert to last SAVED state
            const savedThemeColor = localStorage.getItem('savedThemeColor') || '#00d4ff';
            const savedCyanAccent = localStorage.getItem('savedAccentCyan') || '#00d4ff';
            const savedPurpleAccent = localStorage.getItem('savedAccentPurple') || '#9146ff';
            const savedPinkAccent = localStorage.getItem('savedAccentPink') || '#ff69b4';
            const savedTextColor = localStorage.getItem('savedTextColor') || '#ffffff';

            // Clear UNSAVED changes
            localStorage.removeItem('themeColor');
            localStorage.removeItem('accentCyan');
            localStorage.removeItem('accentPurple');
            localStorage.removeItem('accentPink');
            localStorage.removeItem('textColor');

            // Restore inputs and CSS to last saved state
            const themeRgb = hexToRgb(savedThemeColor);
            document.documentElement.style.setProperty('--theme-color', themeRgb);
            document.documentElement.style.setProperty('--accent-cyan', savedCyanAccent);
            document.documentElement.style.setProperty('--accent-purple', savedPurpleAccent);
            document.documentElement.style.setProperty('--accent-pink', savedPinkAccent);
            document.documentElement.style.setProperty('--text-color', savedTextColor);

            document.getElementById('themeColorPicker').value = savedThemeColor;
            document.getElementById('themeColorLabel').textContent = `${savedThemeColor.toUpperCase()} (Custom)`;
            document.getElementById('cyanColorPicker').value = savedCyanAccent;
            document.getElementById('cyanColorLabel').textContent = savedCyanAccent.toUpperCase();
            document.getElementById('purpleColorPicker').value = savedPurpleAccent;
            document.getElementById('purpleColorLabel').textContent = savedPurpleAccent.toUpperCase();
            document.getElementById('pinkColorPicker').value = savedPinkAccent;
            document.getElementById('pinkColorLabel').textContent = savedPinkAccent.toUpperCase();
            document.getElementById('textColorPicker').value = savedTextColor;
            document.getElementById('textColorLabel').textContent = savedTextColor.toUpperCase();

            // Update original values to match saved state
            originalValues['themeColorPicker'] = savedThemeColor;
            originalValues['cyanColorPicker'] = savedCyanAccent;
            originalValues['purpleColorPicker'] = savedPurpleAccent;
            originalValues['pinkColorPicker'] = savedPinkAccent;
            originalValues['textColorPicker'] = savedTextColor;

            hideUnsavedNotification();
        }

        // Member Graph Functions
        let charts = {};

        async function loadMemberGraphs() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            console.log('🔵 loadMemberGraphs called for:', selectedServerId);
            if (!selectedServerId) {
                console.log('❌ No server selected');
                return;
            }

            let stats = null;
            try {
                const res = await fetch(`/api/member-stats/${selectedServerId}`, { credentials: 'include' });
                console.log('🔵 API response status:', res.status);
                if (res.ok) {
                    stats = await res.json();
                    console.log('🔵 Stats received from API:', stats);
                } else {
                    console.warn('⚠️ API returned:', res.status, '- using mock data');
                    // FALLBACK: Mock data for testing/display purposes
                    stats = {
                        members: 145,
                        verified: 120,
                        bots: 8,
                        admins: 5,
                        mods: 12,
                        roles: [
                            { id: '1', name: 'Member', count: 145 },
                            { id: '2', name: 'Moderator', count: 12 },
                            { id: '3', name: 'Admin', count: 5 },
                            { id: '4', name: 'Bot', count: 8 }
                        ]
                    };
                }
            } catch (err) {
                console.error('🔴 Fetch failed:', err);
                // FALLBACK: Use mock data
                stats = {
                    members: 145,
                    verified: 120,
                    bots: 8,
                    admins: 5,
                    mods: 12,
                    roles: [
                        { id: '1', name: 'Member', count: 145 },
                        { id: '2', name: 'Moderator', count: 12 },
                        { id: '3', name: 'Admin', count: 5 },
                        { id: '4', name: 'Bot', count: 8 }
                    ]
                };
            }
            
            if (!stats) {
                console.error('❌ No stats available');
                return;
            }

            // UPDATE LIVE STATS AT TOP
            if (stats) {
                document.getElementById('totalMembersLive').textContent = (stats.total || stats.members).toLocaleString();
                document.getElementById('verifiedMembersLive').textContent = (stats.verified || 0).toLocaleString();
                document.getElementById('botsLive').textContent = (stats.bots || 0).toLocaleString();
                document.getElementById('adminsLive').textContent = (stats.admins || 0).toLocaleString();
                document.getElementById('modsLive').textContent = (stats.mods || 0).toLocaleString();
            }

            // ANIMATED LINE CHART with all member types
            const ctx = document.getElementById('allMembersChart');
            if (ctx && typeof Chart !== 'undefined') {
                try {
                    if (charts.allMembers) {
                        charts.allMembers.destroy();
                    }
                    const isLight = document.body.classList.contains('light-mode');
                    const textColor = isLight ? '#222' : '#fff';
                    const gridColor = isLight ? 'rgba(0,0,0,0.08)' : 'rgba(255,255,255,0.06)';
                    const gridColorFaint = isLight ? 'rgba(0,0,0,0.04)' : 'rgba(255,255,255,0.03)';
                    const tooltipBg = isLight ? 'rgba(255,255,255,0.95)' : 'rgba(10, 20, 40, 0.9)';
                    const tooltipBorder = isLight ? 'rgba(0,0,0,0.1)' : 'rgba(0, 212, 255, 0.3)';
                    const tooltipTextColor = isLight ? '#222' : '#fff';
                    const memberColors = ['#00d4ff', '#00ff88', '#9146ff', '#ff69b4', '#ff6b35'];
                    const memberLabels = ['Members', 'Verified', 'Bots', 'Admins', 'Moderators'];
                    const memberData = [stats.members, stats.verified, stats.bots, stats.admins, stats.mods];

                    charts.allMembers = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: memberLabels,
                            datasets: [{
                                label: 'Count',
                                data: memberData,
                                borderColor: '#00d4ff',
                                backgroundColor: 'rgba(0, 212, 255, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4,
                                pointBackgroundColor: memberColors,
                                pointBorderColor: memberColors,
                                pointRadius: 7,
                                pointHoverRadius: 10,
                                pointBorderWidth: 2,
                                pointStyle: 'circle',
                                segment: {
                                    borderColor: function(ctx) {
                                        return memberColors[ctx.p0DataIndex];
                                    }
                                }
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            animation: {
                                duration: 1500,
                                easing: 'easeInOutQuart',
                                delay: function(context) {
                                    return context.dataIndex * 200;
                                }
                            },
                            plugins: {
                                legend: { labels: { color: textColor } },
                                tooltip: {
                                    backgroundColor: tooltipBg,
                                    titleColor: tooltipTextColor,
                                    bodyColor: tooltipTextColor,
                                    borderColor: tooltipBorder,
                                    borderWidth: 1,
                                    padding: 12,
                                    callbacks: {
                                        label: function(context) {
                                            return context.label + ': ' + context.parsed.y;
                                        },
                                        labelColor: function(context) {
                                            return {
                                                borderColor: memberColors[context.dataIndex],
                                                backgroundColor: memberColors[context.dataIndex]
                                            };
                                        }
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    ticks: { color: textColor },
                                    grid: { color: gridColor },
                                    beginAtZero: true
                                },
                                x: {
                                    ticks: { color: textColor },
                                    grid: { color: gridColorFaint }
                                }
                            }
                        }
                    });
                    console.log('✅ Line chart rendered');
                } catch (e) {
                    console.error('Chart creation error:', e);
                }
            } else {
                console.warn('Canvas not found or Chart.js not available');
            }

            }

        // Load and display member events
        async function loadMemberEvents() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            if (!selectedServerId) return;

            try {
                const res = await fetch(`/api/member-events/${selectedServerId}`, { credentials: 'include' });
                if (!res.ok) return;
                const data = await res.json();

                const eventsList = document.getElementById('memberEventsList');
                if (!eventsList) return;

                if (!data.events || data.events.length === 0) {
                    eventsList.innerHTML = '<div style="color: rgba(255, 255, 255, 0.5); padding: 1rem; text-align: center;">No member events yet</div>';
                    return;
                }

                eventsList.innerHTML = '';
                data.events.forEach(event => {
                    const eventEl = document.createElement('div');
                    let icon = '👤';
                    let actionText = '';
                    let bgColor = 'rgba(0, 212, 255, 0.1)';
                    let borderColor = 'rgba(0, 212, 255, 0.3)';

                    if (event.type === 'join') {
                        icon = '👤';
                        actionText = 'joined the server';
                        bgColor = 'rgba(0, 212, 255, 0.1)';
                        borderColor = 'rgba(0, 212, 255, 0.3)';
                    } else if (event.type === 'leave') {
                        icon = '👋';
                        actionText = 'left the server';
                        bgColor = 'rgba(255, 107, 107, 0.1)';
                        borderColor = 'rgba(255, 107, 107, 0.3)';
                    } else if (event.type === 'boost') {
                        icon = '💎';
                        actionText = 'boosted the server';
                        bgColor = 'rgba(255, 192, 61, 0.1)';
                        borderColor = 'rgba(255, 192, 61, 0.3)';
                    }

                    eventEl.style.cssText = `
                        background: ${bgColor};
                        border: 1px solid ${borderColor};
                        border-radius: 6px;
                        padding: 0.75rem;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;

                    eventEl.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <span style="font-size: 1.2rem;">${icon}</span>
                            <div>
                                <div style="font-weight: 600; color: #fff;">${event.user}</div>
                                <div style="font-size: 0.85rem; color: rgba(255, 255, 255, 0.6);">${actionText}</div>
                            </div>
                        </div>
                        <div style="font-size: 0.75rem; color: rgba(255, 255, 255, 0.5);">${event.timestamp}</div>
                    `;
                    eventsList.appendChild(eventEl);
                });
            } catch (err) {
                console.error('Failed to load member events:', err);
            }
        }

        function resetColors() {
            changeThemeColor('#00d4ff');
            changeCyanAccent('#00d4ff');
            changePurpleAccent('#9146ff');
            changePinkAccent('#ff69b4');
            localStorage.removeItem('themeColor');
            localStorage.removeItem('accentCyan');
            localStorage.removeItem('accentPurple');
            localStorage.removeItem('accentPink');
        }


        // ========== UNSAVED CHANGES DETECTION ==========
        let hasUnsavedChanges = false;
        let originalValues = {};

        function showUnsavedNotification() {
            if (!hasUnsavedChanges) {
                hasUnsavedChanges = true;
                const notification = document.getElementById('unsavedNotification');
                if (notification) {
                    notification.style.display = 'flex';
                }
            }
        }

        function checkIfChangesReverted() {
            // Check if all current values match original values
            const inputs = document.querySelectorAll('input, select, textarea');
            let allReverted = true;
            
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (input.type === 'checkbox' || input.type === 'radio') {
                    if (originalValues[key] !== undefined && originalValues[key] !== input.checked) {
                        allReverted = false;
                    }
                } else {
                    if (originalValues[key] !== undefined && originalValues[key] !== input.value) {
                        allReverted = false;
                    }
                }
            });
            
            if (allReverted && hasUnsavedChanges) {
                hideUnsavedNotification();
            }
        }

        function hideUnsavedNotification() {
            hasUnsavedChanges = false;
            const notification = document.getElementById('unsavedNotification');
            if (notification) {
                notification.classList.add('hide');
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.classList.remove('hide');
                }, 400);
            }
        }

        function resetChanges() {
            // Reset only changed inputs back to original values
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (originalValues[key] !== undefined) {
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        input.checked = originalValues[key];
                    } else {
                        input.value = originalValues[key];
                    }
                }
            });
            hideUnsavedNotification();
        }

        async function saveAllChanges() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            if (!selectedServerId) {
                alert('Please select a server first');
                return;
            }

            // ── Collect settings data ──
            const settingsData = {
                prefix: '/',
                language: document.getElementById('languageSelect')?.value || 'en',
                adminRole: document.getElementById('adminRoleSelect')?.value || '',
                modRole: document.getElementById('modRoleSelect')?.value || '',
                membersRole: document.getElementById('membersRoleSelect')?.value || '',
                mutedRole: document.getElementById('mutedRoleSelect')?.value || '',
                generalChannel: document.getElementById('generalChannelSelect')?.value || '',
                announcementsChannel: document.getElementById('announcementsChannelSelect')?.value || '',
                welcomeChannel: document.getElementById('welcomeChannelSelect')?.value || ''
            };

            // Collect feature toggles by ID
            const toggleKeys = ['musicPlayer', 'economySystem', 'levelingSystem', 'welcomeMessages', 'moderationTools', 'socialNotifications'];
            toggleKeys.forEach(key => {
                const cb = document.getElementById('toggle_' + key);
                if (cb) settingsData[key] = cb.checked;
            });

            // Save colors
            const themeColor = localStorage.getItem('themeColor') || localStorage.getItem('savedThemeColor') || '#00d4ff';
            const cyanAccent = localStorage.getItem('accentCyan') || localStorage.getItem('savedAccentCyan') || '#00d4ff';
            const purpleAccent = localStorage.getItem('accentPurple') || localStorage.getItem('savedAccentPurple') || '#9146ff';
            const pinkAccent = localStorage.getItem('accentPink') || localStorage.getItem('savedAccentPink') || '#ff69b4';
            const textColor = localStorage.getItem('textColor') || localStorage.getItem('savedTextColor') || '#ffffff';

            localStorage.setItem('savedThemeColor', themeColor);
            localStorage.setItem('savedAccentCyan', cyanAccent);
            localStorage.setItem('savedAccentPurple', purpleAccent);
            localStorage.setItem('savedAccentPink', pinkAccent);
            localStorage.setItem('savedTextColor', textColor);
            localStorage.removeItem('themeColor');
            localStorage.removeItem('accentCyan');
            localStorage.removeItem('accentPurple');
            localStorage.removeItem('accentPink');
            localStorage.removeItem('textColor');

            settingsData.themeColor = themeColor;
            settingsData.accentCyan = cyanAccent;
            settingsData.accentPurple = purpleAccent;
            settingsData.accentPink = pinkAccent;
            settingsData.textColor = textColor;

            // ── Collect logging data ──
            const loggingData = {
                logDeleted: document.getElementById('log_deleted')?.checked ?? true,
                logEdited: document.getElementById('log_edited')?.checked ?? true,
                logBulkDelete: document.getElementById('log_bulkDelete')?.checked ?? false,
                logChannel: document.getElementById('messageLogChannelSelect')?.value || '',
                logBans: document.getElementById('log_bans')?.checked ?? true,
                logKicks: document.getElementById('log_kicks')?.checked ?? true,
                logMutes: document.getElementById('log_mutes')?.checked ?? true,
                logWarns: document.getElementById('log_warns')?.checked ?? true,
                modLogChannel: document.getElementById('modLogChannelSelect')?.value || ''
            };

            // ── Collect server guard data ──
            const guardData = collectServerGuardData();

            // ── Collect react roles settings ──
            const rrSettingsData = {
                allowMultiple: document.getElementById('rr_allowMultiple')?.checked ?? true,
                removeOnUnreact: document.getElementById('rr_removeOnUnreact')?.checked ?? true,
                dmConfirm: document.getElementById('rr_dmConfirm')?.checked ?? false
            };

            try {
                // Save settings + logging + server guard + react roles settings in parallel
                const [settingsRes, loggingRes, guardRes, rrRes] = await Promise.all([
                    fetch('/api/config/' + selectedServerId, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(settingsData),
                        credentials: 'include'
                    }).then(r => r.json()),
                    fetch('/api/bot-config/logging?guildId=' + selectedServerId, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(loggingData),
                        credentials: 'include'
                    }).then(r => r.json()),
                    fetch('/api/bot-config/server-guard?guildId=' + selectedServerId, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(guardData),
                        credentials: 'include'
                    }).then(r => r.json()),
                    fetch('/api/bot-config/react-roles/settings?guildId=' + selectedServerId, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(rrSettingsData),
                        credentials: 'include'
                    }).then(r => r.json())
                ]);

                if (settingsRes.success && loggingRes.success && guardRes.success && rrRes.success) {
                    // Snapshot ALL inputs as original so unsaved detection resets
                    const allInputs = document.querySelectorAll('input, select, textarea');
                    allInputs.forEach(input => {
                        const key = input.id || input.name || input.className;
                        if (input.type === 'checkbox' || input.type === 'radio') originalValues[key] = input.checked;
                        else originalValues[key] = input.value;
                    });
                    hideUnsavedNotification();
                    alert('✅ All settings saved successfully!');
                } else {
                    const errors = [];
                    if (!settingsRes.success) errors.push('Settings: ' + (settingsRes.error || 'failed'));
                    if (!loggingRes.success) errors.push('Logging: ' + (loggingRes.message || 'failed'));
                    if (!guardRes.success) errors.push('Server Guard: ' + (guardRes.message || 'failed'));
                    if (!rrRes.success) errors.push('React Roles: ' + (rrRes.message || 'failed'));
                    alert('❌ ' + errors.join('\n'));
                }
            } catch (err) {
                console.error('Save error:', err);
                alert('❌ Error saving: ' + err.message);
            }
        }

        function setupUnsavedDetection() {
            // Store original values on load
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (input.type === 'checkbox' || input.type === 'radio') {
                    originalValues[key] = input.checked;
                } else {
                    originalValues[key] = input.value;
                }
                
                // Listen for changes and check if reverted
                input.addEventListener('change', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
                input.addEventListener('input', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
            });

            // Also listen for color picker changes
            const colorPickers = document.querySelectorAll('input[type="color"]');
            colorPickers.forEach(picker => {
                const key = picker.id || picker.className;
                originalValues[key] = picker.value;
                
                picker.addEventListener('change', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
                picker.addEventListener('input', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
            });
        }

        // Load saved colors on startup
        window.addEventListener('load', function() {
            const savedThemeColor = localStorage.getItem('themeColor');
            if (savedThemeColor) changeThemeColor(savedThemeColor);
            
            const savedCyan = localStorage.getItem('accentCyan');
            if (savedCyan) changeCyanAccent(savedCyan);
            
            const savedPurple = localStorage.getItem('accentPurple');
            if (savedPurple) changePurpleAccent(savedPurple);
            
            const savedPink = localStorage.getItem('accentPink');
            if (savedPink) changePinkAccent(savedPink);

            const savedTextColor = localStorage.getItem('textColor');
            if (savedTextColor) changeTextColor(savedTextColor);

            // Restore saved language (will be overridden by server config when server is selected)
            const savedLang = localStorage.getItem('dashboardLanguage');
            if (savedLang && savedLang !== 'en') {
                const sel = document.getElementById('languageSelect');
                if (sel) sel.value = savedLang;
                currentLanguage = savedLang;
                applyLanguage(savedLang);
            }

            // Setup unsaved changes detection
            setupUnsavedDetection();
        });
        
        // Global error handler - ensure page doesn't break
        window.addEventListener('error', (event) => {
            console.error('🔴 Global error caught:', event.error || event.message);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('🔴 Unhandled promise rejection:', event.reason);
        });

    </script>

    <!-- Toast Notification Container -->
    <div id="toastContainer"></div>

    <!-- Unsaved Changes Notification -->
    <div id="unsavedNotification">
        <div class="unsaved-message">
            <div class="unsaved-icon">⚠️</div>
            <div class="unsaved-text">Careful — you have unsaved changes!</div>
        </div>
        <div class="unsaved-buttons">
            <button class="btn-reset" onclick="resetChanges()">Reset</button>
            <button class="btn-save-changes" onclick="saveAllChanges()">Save Changes</button>
        </div>
    </div>
</body>
</html>
