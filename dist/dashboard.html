<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPIDEY BOT - Admin Dashboard</title>
    <style>
        :root {
            --theme-color: 0, 220, 255;
            --text-color: #ffffff;
            --bg-primary: #0a0c1f;
            --bg-secondary: #151a35;
            --accent-cyan: #00e6ff;
            --accent-purple: #a855f7;
            --accent-pink: #ff1493;
            --accent-green: #00ff66;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #0a0c1f 0%, #1a0a3a 15%, #2d0a4d 30%, #3a0047 45%, #0f1a4d 60%, #1a0a3a 75%, #2d1a4d 90%, #0a0c1f 100%);
            color: var(--text-color);
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
            min-height: 100vh;
            background-attachment: fixed;
        }

        body.light-mode {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            background: var(--bg-primary);
        }

        body.light-mode .header {
            background: linear-gradient(135deg, rgba(145, 70, 255, 0.08) 0%, rgba(0, 212, 255, 0.05) 100%);
            border-bottom-color: rgba(var(--theme-color), 0.1);
        }

        body.light-mode .header-title,
        body.light-mode .user-name {
            color: #ffffff;
        }

        body.light-mode .user-role {
            color: #ffffff;
        }

        body.light-mode .sidebar {
            background: var(--bg-primary);
            border-right-color: rgba(var(--theme-color), 0.1);
        }

        body.light-mode .sidebar-section-title {
            color: #ffffff;
        }

        body.light-mode .sidebar-item {
            color: #ffffff;
        }

        body.light-mode .sidebar-item:hover {
            background: rgba(var(--theme-color), 0.08);
            color: #ffffff;
        }

        body.light-mode .sidebar-item.active {
            color: #ffffff;
        }

        body.light-mode .content-area {
            background: var(--bg-primary);
        }

        body.light-mode .content-title {
            color: rgba(0, 0, 0, 0.95);
        }

        body.light-mode .content-subtitle {
            color: #ffffff;
        }

        body.light-mode .panel {
            background: var(--bg-secondary);
            border-color: rgba(var(--theme-color), 0.15);
        }

        body.light-mode .panel-title {
            color: rgba(0, 0, 0, 0.95);
        }

        body.light-mode .form-label {
            color: #ffffff;
        }

        body.light-mode .form-input {
            background: rgba(0, 0, 0, 0.05);
            border-color: rgba(var(--theme-color), 0.2);
            color: #ffffff;
        }

        body.light-mode .form-input:focus {
            background: rgba(0, 0, 0, 0.08);
            border-color: rgba(var(--theme-color), 0.4);
        }

        body.light-mode .color-label {
            color: #ffffff;
        }

        body.light-mode .color-preset {
            border-color: #ffffff;
        }

        body.light-mode .server-dropdown-btn {
            color: #ffffff;
        }

        body.light-mode .server-menu-item {
            color: #ffffff;
        }

        body.light-mode .server-menu-item:hover {
            color: #ffffff;
        }

        body.light-mode .server-menu-item.active {
            color: var(--accent-cyan);
        }

        body.light-mode .panel-header {
            border-bottom-color: #ffffff;
        }

        body.light-mode .color-picker-wrapper {
            background: transparent;
        }

        .dashboard-wrapper {
            display: flex;
            height: 100vh;
            flex-direction: column;
            background: transparent;
        }

        /* Header */
        .header {
            background: rgba(10, 20, 40, 0.25);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(var(--theme-color), 0.2);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-logo {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .header-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
        }

        .color-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .color-picker {
            width: 60px;
            height: 50px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .color-picker:hover {
            transform: scale(1.05);
        }

        .color-label {
            font-size: 0.95rem;
            color: rgba(var(--theme-color), 0.9);
            font-weight: 500;
            min-width: 120px;
        }

        .color-preset {
            width: 50px;
            height: 50px;
            border: 2px solid rgb(255, 255, 255);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-preset:hover {
            transform: scale(1.1);
            border-color: rgb(255, 255, 255);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.4);
        }

        .btn-secondary {
            background: rgba(var(--theme-color), 0.15);
            border: 1px solid rgba(var(--theme-color), 0.4);
            color: rgba(var(--theme-color), 1);
        }

        .btn-secondary:hover {
            background: rgba(var(--theme-color), 0.25);
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: rgb(255, 255, 255);
        }

        .server-selector {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .server-icons-container {
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .server-icon-btn {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            background: rgba(var(--theme-color), 0.15);
            border: 2px solid rgba(var(--theme-color), 0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            color: rgb(255, 255, 255);
            transition: all 0.3s ease;
            position: relative;
        }

        .server-icon-btn:hover {
            transform: scale(1.1);
            background: rgba(var(--theme-color), 0.25);
            border-color: rgba(var(--theme-color), 0.6);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.4);
        }

        .server-icon-btn.active {
            background: rgba(var(--theme-color), 0.3);
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(var(--theme-color), 0.6);
        }

        .server-icon-btn img {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            object-fit: cover;
        }

        .server-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            min-width: 150px;
        }

        .current-server-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: rgb(255, 255, 255);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .server-count {
            font-size: 0.7rem;
            color: rgb(255, 255, 255);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .mode-toggle {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.1);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .mode-toggle:hover {
            background: rgba(var(--theme-color), 0.2);
            border-color: rgba(var(--theme-color), 0.4);
        }

        body.light-mode .mode-toggle {
            background: rgba(var(--theme-color), 0.08);
            border-color: rgba(var(--theme-color), 0.15);
        }

        body.light-mode .mode-toggle:hover {
            background: rgba(var(--theme-color), 0.15);
            border-color: rgba(var(--theme-color), 0.3);
        }

        .notification-icon {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.1);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .notification-icon:hover {
            background: rgba(var(--theme-color), 0.2);
            border-color: rgba(var(--theme-color), 0.4);
        }

        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 20px;
            height: 20px;
            background: #ff4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            position: relative;
            padding: 0 0.5rem;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            border: 2px solid var(--accent-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            background-size: cover;
            background-position: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 0.15rem;
            min-width: 100px;
            flex-shrink: 0;
        }

        .user-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.1;
        }

        .user-role {
            font-size: 0.65rem;
            color: rgb(255, 255, 255);
            white-space: nowrap;
            line-height: 1.1;
        }

        .profile-dropdown-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgb(255, 255, 255);
            font-size: 0.75rem;
            flex-shrink: 0;
            margin-left: 0.25rem;
        }

        .profile-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 8px;
            margin-top: 0.5rem;
            min-width: 180px;
            display: none;
            z-index: 9999 !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        .profile-menu.active {
            display: block;
        }

        .profile-menu-item {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(var(--theme-color), 0.1);
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgb(255, 255, 255);
        }

        .profile-menu-item:last-child {
            border-bottom: none;
        }

        .profile-menu-item:hover {
            background: rgba(var(--theme-color), 0.1);
            color: rgba(255, 255, 255, 0.95);
        }

        .profile-menu-item.logout {
            color: #ff6b6b;
        }

        /* Main Container */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 220px;
            background: rgba(10, 20, 40, 0.2);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(var(--theme-color), 0.2);
            overflow-y: auto;
            padding: 1.5rem 0;
            box-shadow: 8px 0 32px rgba(0, 0, 0, 0.2);
        }

        .sidebar-section {
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }

        .sidebar-section-title {
            font-size: 0.65rem;
            text-transform: uppercase;
            color: rgb(255, 255, 255);
            letter-spacing: 1px;
            padding: 0 1rem 0.75rem;
            font-weight: 700;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-item {
            padding: 0.6rem 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: rgb(255, 255, 255);
            display: flex;
            align-items: center;
            gap: 0.65rem;
            margin: 0.2rem 0.5rem;
            border-radius: 6px;
            font-size: 0.85rem;
            position: relative;
        }

        .sidebar-item:hover {
            background: rgba(var(--theme-color), 0.1);
            color: rgb(255, 255, 255);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(145, 70, 255, 0.3) 0%, rgba(0, 212, 255, 0.2) 100%);
            color: var(--accent-cyan);
            border-left: 3px solid var(--accent-cyan);
            padding-left: calc(0.75rem - 3px);
        }

        .sidebar-item-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .sidebar-item-icon svg {
            width: 100%;
            height: 100%;
            stroke: currentColor;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: transparent;
        }

        .content-header {
            margin-bottom: 2rem;
        }

        .content-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 0.5rem;
        }

        .content-subtitle {
            font-size: 0.9rem;
            color: rgb(255, 255, 255);
        }

        /* Grid Layout */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin-top: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .content-grid.wide {
            grid-template-columns: 2fr 1fr;
        }

        #settings-section .content-grid,
        #logging-section .content-grid,
        #server-guard-section .content-grid,
        #react-roles-section .content-grid,
        #role-categories-section .content-grid,
        #server-messages-section .content-grid,
        #custom-commands-section .content-grid,
        #components-section .content-grid,
        #xp-levels-section .content-grid,
        #leaderboards-section .content-grid,
        #invite-tracking-section .content-grid,
        #message-counting-section .content-grid,
        #statistics-channels-section .content-grid,
        #giveaways-section .content-grid,
        #social-notifs-section .content-grid,
        #reminders-section .content-grid,
        #recordings-section .content-grid {
            grid-template-columns: 1fr;
        }

        /* Panels */
        .panel {
            background: rgba(20, 30, 60, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(var(--theme-color), 0.2);
            border-radius: 10px;
            padding: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        #settings-section .panel,
        #logging-section .panel,
        #server-guard-section .panel,
        #react-roles-section .panel,
        #role-categories-section .panel,
        #server-messages-section .panel,
        #custom-commands-section .panel,
        #components-section .panel,
        #xp-levels-section .panel,
        #leaderboards-section .panel,
        #invite-tracking-section .panel,
        #message-counting-section .panel,
        #statistics-channels-section .panel,
        #giveaways-section .panel,
        #social-notifs-section .panel,
        #reminders-section .panel,
        #recordings-section .panel {
            padding: 0.9rem;
        }

        .panel:hover {
            background: rgba(20, 30, 60, 0.35);
            border-color: rgba(var(--theme-color), 0.4);
            box-shadow: 0 8px 32px rgba(var(--theme-color), 0.15);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            padding-bottom: 0.6rem;
            border-bottom: 1px solid rgba(var(--theme-color), 0.15);
        }

        .panel-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
        }

        #settings-section .panel-title,
        #logging-section .panel-title,
        #server-guard-section .panel-title,
        #react-roles-section .panel-title,
        #role-categories-section .panel-title,
        #server-messages-section .panel-title,
        #custom-commands-section .panel-title,
        #components-section .panel-title,
        #xp-levels-section .panel-title,
        #leaderboards-section .panel-title,
        #invite-tracking-section .panel-title,
        #message-counting-section .panel-title,
        #statistics-channels-section .panel-title,
        #giveaways-section .panel-title,
        #social-notifs-section .panel-title,
        #reminders-section .panel-title,
        #recordings-section .panel-title {
            font-size: 0.85rem;
        }

        .panel-icon {
            width: 32px;
            height: 32px;
            background: rgba(var(--theme-color), 0.15);
            border: 1px solid rgba(var(--theme-color), 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .panel-icon:hover {
            background: rgba(var(--theme-color), 0.25);
            border-color: rgba(var(--theme-color), 0.5);
        }

        .panel-content {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        #settings-section .panel-content,
        #logging-section .panel-content,
        #server-guard-section .panel-content,
        #react-roles-section .panel-content,
        #role-categories-section .panel-content,
        #server-messages-section .panel-content,
        #custom-commands-section .panel-content,
        #components-section .panel-content,
        #xp-levels-section .panel-content,
        #leaderboards-section .panel-content,
        #invite-tracking-section .panel-content,
        #message-counting-section .panel-content,
        #statistics-channels-section .panel-content,
        #giveaways-section .panel-content,
        #social-notifs-section .panel-content,
        #reminders-section .panel-content,
        #recordings-section .panel-content {
            gap: 0.5rem;
        }

        /* Form Elements */
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .form-label {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.65);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        #settings-section .form-label,
        #logging-section .form-label,
        #server-guard-section .form-label,
        #react-roles-section .form-label,
        #role-categories-section .form-label,
        #server-messages-section .form-label,
        #custom-commands-section .form-label,
        #components-section .form-label,
        #xp-levels-section .form-label,
        #leaderboards-section .form-label,
        #invite-tracking-section .form-label,
        #message-counting-section .form-label,
        #statistics-channels-section .form-label,
        #giveaways-section .form-label,
        #social-notifs-section .form-label,
        #reminders-section .form-label,
        #recordings-section .form-label {
            font-size: 0.65rem;
            color: rgb(255, 255, 255);
        }

        .form-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(var(--theme-color), 0.2);
            padding: 0.4rem 0.5rem;
            border-radius: 5px;
            color: rgb(255, 255, 255);
            font-size: 0.75rem;
            transition: all 0.2s ease;
            height: 28px;
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(var(--theme-color), 0.5);
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 12px rgba(var(--theme-color), 0.15);
        }

        /* Dropdown Option Styling */
        .form-input option {
            background: #1a1a2e;
            color: #fff;
            padding: 0.5rem;
        }

        .form-input option:checked {
            background: linear-gradient(rgba(0, 212, 255, 0.3), rgba(0, 212, 255, 0.3));
            color: #fff;
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        select option {
            background: #0f1623;
            color: #fff;
            padding: 0.6rem 0.8rem;
            border: none;
        }

        select option:checked {
            background: rgba(0, 212, 255, 0.3);
            color: #fff;
        }

        .form-input {
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        .glass-select {
            background: rgba(20, 30, 60, 0.4) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 212, 255, 0.3) !important;
            color: #fff !important;
        }

        .glass-select:hover {
            background: rgba(20, 30, 60, 0.5) !important;
            border-color: rgba(0, 212, 255, 0.5) !important;
        }

        .glass-select:focus {
            background: rgba(20, 30, 60, 0.6) !important;
            border-color: rgba(0, 212, 255, 0.6) !important;
            box-shadow: 0 0 12px rgba(0, 212, 255, 0.2) !important;
        }

        .panel-content {
            max-height: 100%;
            overflow: visible;
            position: relative;
            z-index: auto;
        }

        /* Buttons */
        .btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            height: 28px;
            width: 100%;
            justify-content: center;
        }

        #settings-section .btn,
        #logging-section .btn,
        #server-guard-section .btn,
        #react-roles-section .btn,
        #role-categories-section .btn,
        #server-messages-section .btn,
        #custom-commands-section .btn,
        #components-section .btn,
        #xp-levels-section .btn,
        #leaderboards-section .btn,
        #invite-tracking-section .btn,
        #message-counting-section .btn,
        #statistics-channels-section .btn,
        #giveaways-section .btn,
        #social-notifs-section .btn,
        #reminders-section .btn,
        #recordings-section .btn {
            font-size: 0.65rem;
            height: 26px;
            padding: 0.3rem 0.6rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-cyan) 100%);
            color: rgba(255, 255, 255, 0.95);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(145, 70, 255, 0.3);
        }

        .btn-secondary {
            background: rgba(var(--theme-color), 0.15);
            color: rgb(255, 255, 255);
            border: 1px solid rgba(var(--theme-color), 0.3);
        }

        .btn-secondary:hover {
            background: rgba(var(--theme-color), 0.25);
            border-color: rgba(var(--theme-color), 0.5);
        }

        /* Unsaved Changes Notification */
        #unsavedNotification {
            display: none;
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 165, 0, 0.4);
            border-radius: 20px;
            padding: 0.75rem 1.5rem;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            gap: 1.5rem;
            animation: slideUp 0.4s ease-out;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 20px rgba(255, 165, 0, 0.1);
            max-width: calc(100% - 2rem);
        }

        #unsavedNotification.hide {
            animation: slideDown 0.4s ease-in;
        }

        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            to {
                transform: translateX(-50%) translateY(100%);
                opacity: 0;
            }
        }

        .unsaved-message {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex: 1;
        }

        .unsaved-icon {
            font-size: 1rem;
            color: #ff9500;
            flex-shrink: 0;
        }

        .unsaved-text {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .unsaved-buttons {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-shrink: 0;
        }

        .btn-reset {
            background: rgb(255, 255, 255);
            color: rgb(255, 255, 255);
            border: 1px solid rgb(255, 255, 255);
            padding: 0.4rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .btn-reset:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgb(255, 255, 255);
            transform: translateY(-1px);
        }

        .btn-save-changes {
            background: rgba(34, 197, 94, 0.8);
            color: #fff;
            border: none;
            padding: 0.4rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.2);
        }

        .btn-save-changes:hover {
            background: rgba(34, 197, 94, 1);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.3);
        }

        .content-section {
            display: none !important;
            visibility: hidden !important;
            min-height: 100vh;
            position: relative;
            z-index: 0 !important;
        }

        .content-section.active {
            display: block !important;
            visibility: visible !important;
            z-index: 100 !important;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(var(--theme-color), 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(var(--theme-color), 0.4);
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        .graph-container {
            position: relative;
            height: 350px;
            margin-bottom: 1.5rem;
            width: 100%;
            display: block;
        }

        .graph-container canvas {
            max-height: 350px !important;
            height: 350px !important;
            width: 100% !important;
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            pointer-events: none;
        }

        .toast {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.95), rgba(255, 20, 147, 0.95));
            border: 1px solid rgba(0, 230, 255, 0.3);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            margin-bottom: 0.75rem;
            color: #ffffff;
            font-weight: 500;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: slideIn 0.3s ease-out;
            pointer-events: all;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            max-width: 400px;
            min-width: 300px;
        }

        .toast.success {
            border-color: rgba(0, 255, 102, 0.4);
            background: linear-gradient(135deg, rgba(0, 128, 64, 0.95), rgba(0, 200, 100, 0.95));
        }

        .toast.error {
            border-color: rgba(255, 50, 50, 0.4);
            background: linear-gradient(135deg, rgba(150, 50, 50, 0.95), rgba(220, 50, 50, 0.95));
        }

        .toast.info {
            border-color: rgba(0, 230, 255, 0.4);
            background: linear-gradient(135deg, rgba(50, 100, 150, 0.95), rgba(0, 150, 200, 0.95));
        }

        .toast-header {
            font-weight: 700;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toast-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .toast-text {
            font-size: 0.9rem;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .toast.remove {
            animation: slideOut 0.3s ease-out forwards;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>
    <div class="dashboard-wrapper">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="header-logo">
                    <img src="/assets/spidey-logo.png" alt="SPIDEY BOT Logo" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22%3E%3Ccircle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%239146ff%22/%3E%3Ctext x=%2250%22 y=%2250%22 font-size=%2240%22 font-weight=%22bold%22 text-anchor=%22middle%22 dy=%22.3em%22 fill=%22%23fff%22%3EðŸ•·ï¸%3C/text%3E%3C/svg%3E'" />
                </div>
                
                <div class="server-selector">
                    <div class="server-icons-container" id="serverIconsContainer">
                        <div style="text-align: center; color: rgb(255, 255, 255);">Loading servers...</div>
                    </div>
                    <div class="server-info">
                        <div class="current-server-name" id="serverDisplayName">Select Server</div>
                        <div class="server-count" id="serverCountDisplay">0 servers</div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark/Light Mode">
                    <span id="modeIcon">ðŸŒ™</span>
                </div>
                
                <div class="user-profile" onclick="toggleProfileMenu()">
                    <div class="user-avatar" id="userAvatar">D</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-role" id="userRole">Admin</div>
                    </div>
                    <div class="profile-dropdown-icon">â‹®</div>
                    
                    <div class="profile-menu" id="profileMenu">
                        <div class="profile-menu-item logout" onclick="logout()">Log Out</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-section-title">MAIN</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item active" data-section="dashboard" onclick="switchSection('dashboard')">
                            <span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg></span>
                            <span>Dashboard</span>
                        </li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">CORE</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="settings" onclick="switchSection('settings')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M12 1v2m0 14v2M22 12h-2M4 12H2M19.8 4.2l-1.4 1.4M5.6 18.4l-1.4 1.4M19.8 19.8l-1.4-1.4M5.6 5.6l-1.4-1.4"/></svg></span><span>Settings</span></li>
                        <li class="sidebar-item" data-section="logging" onclick="switchSection('logging')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 2H7a2 2 0 00-2 2v16a2 2 0 002 2h10a2 2 0 002-2V4a2 2 0 00-2-2h-2M9 7h6M9 13h6M9 19h2"/></svg></span><span>Logging</span></li>
                        <li class="sidebar-item" data-section="server-guard" onclick="switchSection('server-guard')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 1l7 3.5v5.5c0 4-7 7-7 7s-7-3-7-7V4.5L12 1z"/></svg></span><span>Server Guard</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">FEATURES</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="react-roles" onclick="switchSection('react-roles')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg></span><span>React Roles</span></li>
                        <li class="sidebar-item" data-section="role-categories" onclick="switchSection('role-categories')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h5a2 2 0 012 2z"/></svg></span><span>Role Categories</span></li>
                        <li class="sidebar-item" data-section="admin-activity" onclick="switchSection('admin-activity')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 1l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 1z"/></svg></span><span>Admin Activity</span></li>
                        <li class="sidebar-item" data-section="server-messages" onclick="switchSection('server-messages')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg></span><span>Server Messages</span></li>
                        <li class="sidebar-item" data-section="custom-commands" onclick="switchSection('custom-commands')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4l6 6m-6-6l-6 6"/></svg></span><span>Commands</span></li>
                        <li class="sidebar-item" data-section="components" onclick="switchSection('components')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="8.5" y="11.5" width="7" height="7"/></svg></span><span>Components</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">SYSTEMS</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="xp-levels" onclick="switchSection('xp-levels')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg></span><span>XP Levels</span></li>
                        <li class="sidebar-item" data-section="leaderboards" onclick="switchSection('leaderboards')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 9l6-7 6 7M3 12h18v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8z"/></svg></span><span>Leaderboards</span></li>
                        <li class="sidebar-item" data-section="giveaways" onclick="switchSection('giveaways')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M12 11v6M9 14h6"/></svg></span><span>Giveaways</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">MONITORING</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="events" onclick="switchSection('events')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="9"/><polyline points="12 6 12 12 16 14"/></svg></span><span>Member Activity</span></li>
                        <li class="sidebar-item" data-section="social-notifs" onclick="switchSection('social-notifs')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2l3 6h6l-5 4 2 6-6-4-6 4 2-6-5-4h6l3-6z"/></svg></span><span>Social Notifs</span></li>
                        <li class="sidebar-item" data-section="invite-tracking" onclick="switchSection('invite-tracking')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></span><span>Invites</span></li>
                        <li class="sidebar-item" data-section="message-counting" onclick="switchSection('message-counting')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg></span><span>Messages</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">ADVANCED</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="recordings" onclick="switchSection('recordings')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg></span><span>Recordings</span></li>
                        <li class="sidebar-item" data-section="reminders" onclick="switchSection('reminders')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="9"/><polyline points="12 6 12 12 16 14"/></svg></span><span>Reminders</span></li>
                        <li class="sidebar-item" data-section="statistics-channels" onclick="switchSection('statistics-channels')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="7" width="3" height="14"/><rect x="10" y="3" width="3" height="18"/><rect x="17" y="10" width="3" height="11"/></svg></span><span>Stats</span></li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-title">SUPPORT</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-section="donations" onclick="switchSection('donations')"><span class="sidebar-item-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"/></svg></span><span>Donate</span></li>
                    </ul>
                </div>

            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Section -->
                <div id="dashboard-section" class="content-section active">
                    <div class="content-header">
                        <div class="content-title">Dashboard</div>
                        <div class="content-subtitle">Real-time server analytics</div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div style="background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Total Members</div>
                                <div id="totalMembersLive" style="font-size: 2rem; font-weight: 700; color: #00d4ff;">0</div>
                            </div>
                            <div style="background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Verified Users</div>
                                <div id="verifiedMembersLive" style="font-size: 2rem; font-weight: 700; color: #00ff88;">0</div>
                            </div>
                            <div style="background: rgba(145,70,255,0.1); border: 1px solid rgba(145,70,255,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Bots</div>
                                <div id="botsLive" style="font-size: 2rem; font-weight: 700; color: #9146ff;">0</div>
                            </div>
                            <div style="background: rgba(255,105,180,0.1); border: 1px solid rgba(255,105,180,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Admins</div>
                                <div id="adminsLive" style="font-size: 2rem; font-weight: 700; color: #ff69b4;">0</div>
                            </div>
                            <div style="background: rgba(255,107,53,0.1); border: 1px solid rgba(255,107,53,0.3); border-radius: 8px; padding: 1.5rem; text-align: center;">
                                <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 0.5rem;">Moderators</div>
                                <div id="modsLive" style="font-size: 2rem; font-weight: 700; color: #ff6b35;">0</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 2rem;">
                        <div style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: rgba(255,255,255,0.9);">Member Overview</div>
                        <div class="content-grid wide">
                            <div class="panel">
                                <div class="panel-header"><div class="panel-title">ðŸ“Š All Member Types</div></div>
                                <div class="panel-content">
                                    <div class="graph-container"><canvas id="allMembersChart" width="400" height="350"></canvas></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Member Events Section -->
                <div id="events-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Member Activity</div>
                        <div class="content-subtitle">Live member events: joins, leaves, invites, and boosts</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1 / -1;">
                            <div class="panel-header"><div class="panel-title">ðŸ“œ Recent Member Events</div></div>
                            <div class="panel-content">
                                <div id="memberEventsList" style="display: flex; flex-direction: column; gap: 0.75rem; max-height: 400px; overflow-y: auto;">
                                    <div style="color: rgb(255, 255, 255); padding: 1rem; text-align: center;">Loading events...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">âš™ï¸ Settings</div>
                        <div class="content-subtitle">Configure bot settings and server preferences</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">âš™ï¸ Bot Configuration</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Command Prefix</div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <input type="text" id="commandPrefixInput" class="form-input" placeholder="//" value="//" style="flex: 1;"/>
                                        <button onclick="updateBotSetting('prefix', document.getElementById('commandPrefixInput').value)" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600;">Update</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Bot Nickname</div>
                                    <input type="text" class="form-input" placeholder="SPIDEY BOT" value="SPIDEY BOT" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Bot Status</div>
                                    <select class="form-input" disabled style="opacity: 0.6; cursor: not-allowed;">
                                        <option selected>Online</option>
                                        <option>Idle</option>
                                        <option>Do Not Disturb</option>
                                        <option>Invisible</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Bot Activity</div>
                                    <input type="text" class="form-input" placeholder="e.g., with commands // help" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Default Language</div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <select id="defaultLanguageSelect" class="form-input" style="flex: 1;">
                                            <option value="English" selected>English</option>
                                            <option value="Spanish">Spanish</option>
                                            <option value="French">French</option>
                                            <option value="German">German</option>
                                            <option value="Portuguese">Portuguese</option>
                                        </select>
                                        <button onclick="updateBotSetting('language', document.getElementById('defaultLanguageSelect').value)" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600;">Update</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Timezone (GMT)</div>
                                    <input type="text" class="form-input" placeholder="GMT" value="GMT" disabled style="opacity: 0.6; cursor: not-allowed;"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ‘¥ Role Management</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Admin Role</div>
                                    <select id="adminRoleSelect" class="form-input">
                                        <option value="">Select admin role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Moderator Role</div>
                                    <select id="moderatorRoleSelect" class="form-input">
                                        <option value="">Select moderator role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Members Role</div>
                                    <select id="membersRoleSelect" class="form-input">
                                        <option value="">Select members role...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Muted Role</div>
                                    <select id="mutedRoleSelect" class="form-input">
                                        <option value="">Select muted role...</option>
                                    </select>
                                </div>
                                <button onclick="updateRoles()" style="width: 100%; padding: 0.75rem 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600; margin-top: 1rem;">Update All Roles</button>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ Channels</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">General Channel</div>
                                    <select id="generalChannelSelect" class="form-input">
                                        <option value="">Select general channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Announcements Channel</div>
                                    <select id="announcementsChannelSelect" class="form-input">
                                        <option value="">Select announcements channel...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Welcome Channel</div>
                                    <select id="welcomeChannelSelect" class="form-input">
                                        <option value="">Select welcome channel...</option>
                                    </select>
                                </div>
                                <button onclick="updateChannels()" style="width: 100%; padding: 0.75rem 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600; margin-top: 1rem;">Update All Channels</button>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Logging Section -->
                <div id="logging-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Logging</div>
                        <div class="content-subtitle">Configure logging channels</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ Message Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logDeletedCheck" type="checkbox" checked/> Log Deleted Messages</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logEditedCheck" type="checkbox" checked/> Log Edited Messages</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logBulkDeleteCheck" type="checkbox"/> Log Bulk Deletes</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Log Channel</div>
                                    <input id="messageLogChannelInput" type="text" class="form-input" placeholder="Select log channel"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ‘¤ Moderation Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logBansCheck" type="checkbox" checked/> Log Bans</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logKicksCheck" type="checkbox" checked/> Log Kicks</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logMutesCheck" type="checkbox" checked/> Log Mutes</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="logWarnsCheck" type="checkbox" checked/> Log Warns</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Moderation Log Channel</div>
                                    <input id="modLogChannelInput" type="text" class="form-input" placeholder="Select mod log channel"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button onclick="updateAllLogging()" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600; margin-top: 1rem; font-size: 1rem;">Update All Logging Settings</button>
                </div>

                <!-- Server Guard Section -->
                <div id="server-guard-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Server Guard</div>
                        <div class="content-subtitle">Anti-spam and raid protection</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ›¡ï¸ Anti-Spam</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="antiSpamCheck" type="checkbox" checked/> Enable Anti-Spam</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Messages per 5s</div>
                                    <input id="antiSpamLimitInput" type="number" class="form-input" placeholder="5" value="5"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Action</div>
                                    <select id="antiSpamActionSelect" class="form-input">
                                        <option>Warn</option>
                                        <option>Mute</option>
                                        <option>Kick</option>
                                        <option>Ban</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">âš ï¸ Raid Protection</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="raidProtectionCheck" type="checkbox" checked/> Enable Raid Detection</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Users per 10s</div>
                                    <input id="raidLimitInput" type="number" class="form-input" placeholder="10" value="10"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="banRaidUsersCheck" type="checkbox"/> Ban Raid Users</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ” Permissions</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="membersOnlyCheck" type="checkbox" checked/> <span>Only @Members can use commands</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="adminsBypassCheck" type="checkbox" checked/> <span>Admins bypass all restrictions</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="allowDMCheck" type="checkbox"/> <span>Allow DM commands</span></label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="confirmDangerousCheck" type="checkbox" checked/> <span>Require confirmation for dangerous actions</span></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸš¨ Anti-Nuke System</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Anti-Nuke</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Staff Activity Monitoring</div>
                                    <select class="form-input">
                                        <option>24/7 Monitoring</option>
                                        <option>Alert Only</option>
                                        <option>Auto-Lockdown</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Actions per 30s</div>
                                    <input type="number" class="form-input" placeholder="10" value="10"/>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ”— Link Scanning</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Link Scanning</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Detect Phishing</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Block Scam Sites</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Malware Detection</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸšª Advanced Join Gate</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Join Gate</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Account Age Check</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Min Account Age (days)</div>
                                    <input type="number" class="form-input" placeholder="3" value="3"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Detect Suspicious Avatars</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Username Analysis</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Rate Limiting</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Rate Limiting</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Requests per Minute</div>
                                    <input type="number" class="form-input" placeholder="100" value="100"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> DoS Protection</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Response on Limit</div>
                                    <select class="form-input">
                                        <option>Throttle</option>
                                        <option>Temporary Block</option>
                                        <option>Kick</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ Audit Logging</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Audit Logs</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Audit Log Channel</div>
                                    <input type="text" class="form-input" placeholder="Select audit log channel"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Log All API Requests</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Include IP Tracking</label>
                                </div>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ’¾ Backup System</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Auto-Backup Enabled</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Backup Frequency</div>
                                    <select class="form-input">
                                        <option>Every 6 Hours</option>
                                        <option>Daily</option>
                                        <option>Weekly</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Retention Period</div>
                                    <input type="number" class="form-input" placeholder="30" value="30"/>
                                    <div style="font-size: 0.7rem; color: rgb(255, 255, 255); margin-top: 0.2rem;">days</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button onclick="updateAllServerGuard()" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600; margin-top: 1rem; font-size: 1rem;">Update All Server Guard Settings</button>
                </div>

                <!-- React Roles Section -->
                <div id="react-roles-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">React Roles</div>
                        <div class="content-subtitle">Reaction-based role assignment</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ’Ž Create Reaction Role</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Message ID</div>
                                    <input type="text" class="form-input" placeholder="Enter message ID"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Emoji</div>
                                    <input type="text" class="form-input" placeholder="Enter emoji"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Role</div>
                                    <input type="text" class="form-input" placeholder="Select role"/>
                                </div>
                                <button class="btn btn-primary" onclick="createReactRole()">Add Reaction Role</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">âš™ï¸ Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Allow Multiple Roles</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> Require Message Reaction</label>
                                </div>
                                <button class="btn btn-primary" onclick="saveLogging()">Save Settings</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Setup Section -->
                <div id="quick-setup-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">âš¡ Quick Setup Commands</div>
                        <div class="content-subtitle">One-click setup for popular role features</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ® Gaming Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send gaming role selector message with button interaction</p>
                                <button class="btn btn-primary" onclick="quickSetup('gaming')" style="width: 100%;">Post Gaming Roles Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ¬ Watch Party</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send watch party role selector message</p>
                                <button class="btn btn-primary" onclick="quickSetup('watchparty')" style="width: 100%;">Post Watch Party Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ’» Platform Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send platform role selector message</p>
                                <button class="btn btn-primary" onclick="quickSetup('platform')" style="width: 100%;">Post Platform Selector</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ—‘ï¸ Remove Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Send role removal message for members</p>
                                <button class="btn btn-primary" onclick="quickSetup('removeRoles')" style="width: 100%;">Post Remove Roles</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ–ï¸ Auto Level Roles</div></div>
                            <div class="panel-content">
                                <p style="margin: 0 0 1rem 0; color: rgba(255,255,255,0.7);">Create 100 level roles with emoji badges (takes a moment)</p>
                                <button class="btn btn-primary" onclick="quickSetup('levelRoles')" style="width: 100%;">Create Level Roles 1-100</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Role Categories Section -->
                <div id="role-categories-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">ðŸŽ­ Role Activity</div>
                        <div class="content-subtitle">Track all role creation and modifications</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header">
                                <div class="panel-title">ðŸ“ Role Activity Logs</div>
                                <button class="btn btn-primary" onclick="clearRoleActivityLogs()" style="padding: 0.4rem 0.8rem; font-size: 0.85rem;">ðŸ—‘ï¸ Clear</button>
                            </div>
                            <div class="panel-content">
                                <div id="roleActivityLogsList" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 1rem; min-height: 300px; max-height: 600px; overflow-y: auto; font-family: 'Monaco', 'Courier New', monospace; font-size: 0.85rem; line-height: 1.6;">
                                    <div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">
                                        â³ Waiting for role activities... Messages will appear here as roles are created or modified
                                    </div>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); margin-top: 0.75rem; display: block;">
                                    ðŸ“Œ Shows all role creation, deletion, and modification events | Auto-updates every 3 seconds
                                </small>
                            </div>
                        </div>

                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Role Stats</div></div>
                            <div class="panel-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem;">
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statRolesCreated">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Roles Created</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statRolesDeleted">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Roles Deleted</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statRolesModified">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Roles Modified</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statCategoriesCreated">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Categories Created</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Admin Activity Section -->
                <div id="admin-activity-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">ðŸ‘® Admin Activity</div>
                        <div class="content-subtitle">Track all admin actions and server modifications</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header">
                                <div class="panel-title">ðŸ“‹ Admin Action Log</div>
                                <button class="btn btn-primary" onclick="clearAdminActivityLogs()" style="padding: 0.4rem 0.8rem; font-size: 0.85rem;">ðŸ—‘ï¸ Clear</button>
                            </div>
                            <div class="panel-content">
                                <div id="adminActivityLogsList" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 1rem; min-height: 400px; max-height: 700px; overflow-y: auto; font-family: 'Monaco', 'Courier New', monospace; font-size: 0.85rem; line-height: 1.8;">
                                    <div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 3rem 0;">â³ Waiting for admin actions...</div>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); margin-top: 0.75rem; display: block;">
                                    ðŸ“Œ Shows all role, channel, and permission changes | Auto-updates every 3 seconds
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Server Messages Section -->
                <div id="server-messages-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Server Messages</div>
                        <div class="content-subtitle">Welcome and goodbye messages</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“¨ Welcome Message</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="enableWelcomeCheck" type="checkbox" checked/> <span>Enable Welcome Messages</span></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Welcome Message</div>
                                    <textarea id="welcomeMessageInput" class="form-input" rows="3" placeholder="Welcome {user}! You are member #{count}">Welcome {user}! You are member #{count} in our server. Have fun!</textarea>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); display: block; margin-top: 0.5rem;">Use {user} for username, {count} for member number</small>
                                <button onclick="updateServerMessages()" style="width: 100%; padding: 0.75rem 1rem; background: linear-gradient(135deg, #a855f7, #ff1493); border: none; color: white; border-radius: 0.375rem; cursor: pointer; font-weight: 600; margin-top: 1rem;">Update Messages</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ‘‹ Goodbye Message</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input id="enableGoodbyeCheck" type="checkbox" checked/> <span>Enable Goodbye Messages</span></label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Goodbye Message</div>
                                    <textarea id="goodbyeMessageInput" class="form-input" rows="3" placeholder="{user} has left the server...">{user} has left the server. We hope to see you again!</textarea>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); display: block; margin-top: 0.5rem;">Use {user} for username</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activities Section -->
                <div id="custom-commands-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">ðŸ“Š Recent Activities</div>
                        <div class="content-subtitle">Real-time tracking of all bot activities and events</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header" onclick="toggleFilterDropdown()" style="cursor: pointer;">
                                <div class="panel-title">ðŸ” <span id="filterToggleText">Show</span> Filter Logs</div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <span id="filterToggleIcon" style="transition: transform 0.3s;">â–¼</span>
                                    <button class="btn btn-primary" onclick="clearActivityLogs(event)" style="padding: 0.4rem 0.8rem; font-size: 0.85rem;">ðŸ—‘ï¸ Clear</button>
                                </div>
                            </div>
                            <div id="filterLogsContent" class="panel-content" style="display: none;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem;">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸŽ¤ Voice Events
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> âš ï¸ Moderation
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸ’° Economy
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸ“ˆ Leveling
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸŽµ Music
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸ‘¥ Members
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> âš™ï¸ Config Changes
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" checked onchange="filterActivityLogs()"> ðŸ“¢ Alerts
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header"><div class="panel-title">ðŸ“‹ Recent Activities</div></div>
                            <div class="panel-content">
                                <div id="activityLogsList" style="background: rgba(0, 0, 0, 0.3); border-radius: 6px; padding: 1rem; min-height: 300px; max-height: 600px; overflow-y: auto; font-family: 'Monaco', 'Courier New', monospace; font-size: 0.85rem; line-height: 1.6;">
                                    <div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">
                                        â³ Waiting for activities... Messages will appear here as they happen
                                    </div>
                                </div>
                                <small style="color: rgba(255,255,255,0.5); margin-top: 0.75rem; display: block;">
                                    ðŸ“Œ Auto-updates every 5 seconds | Maximum 500 logs stored | Older entries archived automatically
                                </small>
                            </div>
                        </div>

                        <div class="panel" style="grid-column: 1/-1;">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Log Statistics</div></div>
                            <div class="panel-content">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem;">
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statTotalLogs">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Total Logs</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statModeration">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Mod Actions</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statMembers">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Members Joined</div>
                                    </div>
                                    <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 4px; padding: 0.75rem; text-align: center;">
                                        <div style="font-size: 1.5rem; font-weight: bold; color: #00d4ff;" id="statLevelUps">0</div>
                                        <div style="color: rgba(255,255,255,0.6); font-size: 0.8rem; margin-top: 0.25rem;">Level Ups</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Components Section -->
                <div id="components-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Components</div>
                        <div class="content-subtitle">Manage bot components and features</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ§© Available Components</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Music Player</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Moderation</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Economy System</label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Leveling/XP</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- XP Levels Section -->
                <div id="xp-levels-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">XP Levels</div>
                        <div class="content-subtitle">Configure leveling system</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">â­ XP Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">XP per Message</div>
                                    <input type="number" class="form-input" placeholder="10-30" value="15"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP for Voice (per minute)</div>
                                    <input type="number" class="form-input" placeholder="1-5" value="2"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP per Level</div>
                                    <input type="number" class="form-input" placeholder="500" value="500"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveXPLevels()">Update</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ¯ Level Roles</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Level</div>
                                    <input type="number" class="form-input" placeholder="e.g., 10"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Role</div>
                                    <input type="text" class="form-input" placeholder="Select role"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveXPLevels()">Add Level Role</button>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid" style="margin-top: 2rem;">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ¯ Leveling Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">XP per Message</div>
                                    <input type="number" class="form-input" placeholder="10-30" value="10"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">XP to Level Up</div>
                                    <input type="number" class="form-input" placeholder="500" value="500"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Level</div>
                                    <input type="number" class="form-input" placeholder="100" value="100"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> <span>Auto-assign level roles</span></label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Leaderboards Section -->
                <div id="leaderboards-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Leaderboards</div>
                        <div class="content-subtitle">Configure leaderboard display</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ† Leaderboard Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Leaderboard</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Display Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Update Frequency</div>
                                    <select class="form-input">
                                        <option>Every Hour</option>
                                        <option>Every 6 Hours</option>
                                        <option>Daily</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Top Users to Show</div>
                                    <input type="number" class="form-input" placeholder="10" value="10"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveLogging()">Save Settings</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Giveaways Section -->
                <div id="giveaways-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Giveaways</div>
                        <div class="content-subtitle">Manage giveaways</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽ Start New Giveaway</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Prize</div>
                                    <input type="text" class="form-input" placeholder="e.g., Discord Nitro"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Duration (minutes)</div>
                                    <input type="number" class="form-input" placeholder="60"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Winners</div>
                                    <input type="number" class="form-input" placeholder="1" value="1"/>
                                </div>
                                <button class="btn btn-primary" onclick="createGiveaway()">Start Giveaway</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Active Giveaways</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">No active giveaways</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Social Notifs Section -->
                <div id="social-notifs-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Social Notifications</div>
                        <div class="content-subtitle">Monitor Twitch, TikTok, Kick</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“¡ Add Streamer</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Platform</div>
                                    <select class="form-input">
                                        <option>Twitch</option>
                                        <option>TikTok</option>
                                        <option>Kick</option>
                                        <option>YouTube</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Username</div>
                                    <input type="text" class="form-input" placeholder="Enter username"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Notification Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <button class="btn btn-primary" onclick="addStreamer()">Add Streamer</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“‹ Monitored Accounts</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">No monitored accounts yet</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Invite Tracking Section -->
                <div id="invite-tracking-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Invite Tracking</div>
                        <div class="content-subtitle">Track member invites</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ”— Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Invite Tracking</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Log Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Track Invite Links</label>
                                </div>
                                <button class="btn btn-primary" onclick="saveLogging()">Save Settings</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Invite Leaderboard</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">Top inviters will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Message Counting Section -->
                <div id="message-counting-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Message Counting</div>
                        <div class="content-subtitle">Track message statistics</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ’­ Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Enable Message Counting</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Ignore Channels</div>
                                    <input type="text" class="form-input" placeholder="Channel list (comma separated)"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> Count Bot Messages</label>
                                </div>
                                <button class="btn btn-primary" onclick="saveLogging()">Save Settings</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ˆ Message Stats</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">Message statistics will appear here</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recordings Section -->
                <div id="recordings-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">ðŸŽ¤ Recordings</div>
                        <div class="content-subtitle">Manage voice recordings</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸŽšï¸ Recording Settings</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> Enable Voice Recording</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Storage Location</div>
                                    <input type="text" class="form-input" placeholder="Select storage path"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Max Recording Duration (minutes)</div>
                                    <input type="number" class="form-input" placeholder="60" value="60"/>
                                </div>
                                <button class="btn btn-primary" onclick="saveLogging()">Save Settings</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ Recording Library</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">No recordings yet</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reminders Section -->
                <div id="reminders-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Reminders</div>
                        <div class="content-subtitle">Configure reminders</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">â±ï¸ Create Reminder</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Reminder Title</div>
                                    <input type="text" class="form-input" placeholder="e.g., Daily Standup"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Message</div>
                                    <textarea class="form-input" placeholder="Reminder message" style="height: 80px;"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Time</div>
                                    <input type="time" class="form-input"/>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Repeat</div>
                                    <select class="form-input">
                                        <option>Once</option>
                                        <option>Daily</option>
                                        <option>Weekly</option>
                                        <option>Monthly</option>
                                    </select>
                                </div>
                                <button class="btn btn-primary" onclick="createReminder()">Create Reminder</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“… Scheduled Reminders</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">No scheduled reminders</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics Channels Section -->
                <div id="statistics-channels-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Statistics Channels</div>
                        <div class="content-subtitle">Display server statistics</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“ˆ Channel Statistics</div></div>
                            <div class="panel-content">
                                <div class="form-group">
                                    <div class="form-label">Statistic Type</div>
                                    <select class="form-input">
                                        <option>Member Count</option>
                                        <option>Bot Count</option>
                                        <option>Server Level</option>
                                        <option>Total Messages</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Channel</div>
                                    <input type="text" class="form-input" placeholder="Select channel"/>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox" checked/> Auto-Update</label>
                                </div>
                                <div class="form-group">
                                    <div class="form-label">Update Frequency (minutes)</div>
                                    <input type="number" class="form-input" placeholder="5" value="5"/>
                                </div>
                                <button class="btn btn-primary" onclick="addStatChannel()">Add Stat Channel</button>
                            </div>
                        </div>
                        <div class="panel">
                            <div class="panel-header"><div class="panel-title">ðŸ“Š Active Stats</div></div>
                            <div class="panel-content">
                                <div style="color: rgb(255, 255, 255); text-align: center; padding: 2rem;">No stat channels configured</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Donations Section -->
                <div id="donations-section" class="content-section">
                    <div class="content-header">
                        <div class="content-title">Support Us</div>
                        <div class="content-subtitle">Every donation is appreciated ðŸ’œ</div>
                    </div>
                    <div class="content-grid">
                        <div class="panel" style="grid-column: 1 / -1;">
                            <div class="panel-header"><div class="panel-title">â¤ï¸ Help Support SPIDEY BOT</div></div>
                            <div class="panel-content">
                                <div style="background: rgba(255, 105, 180, 0.1); border: 1px solid rgba(255, 105, 180, 0.3); border-radius: 8px; padding: 1.5rem; margin-bottom: 1.5rem;">
                                    <p style="color: rgb(255, 255, 255); line-height: 1.8; font-size: 0.95rem;">
                                        We're passionate about bringing you the best Discord bot experience with powerful features, reliable performance, and continuous improvements. Your donations help us cover hosting costs, fund development, and keep SPIDEY BOT running smoothly for thousands of servers worldwide.
                                    </p>
                                    <p style="color: rgb(255, 255, 255); line-height: 1.8; font-size: 0.9rem; margin-top: 1rem;">
                                        Every donationâ€”whether $1 or $100â€”is deeply appreciated and makes a real difference. Thank you for believing in our mission to create an incredible Discord bot community! ðŸ•·ï¸
                                    </p>
                                </div>
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=peterburke122000@gmail.com&no_recurring=0&item_name=Support+SPIDEY+BOT+Development&currency_code=USD" target="_blank" rel="noopener noreferrer" class="btn btn-primary" style="text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem;">
                                        <span>ðŸ…¿ï¸</span> <span>Donate via PayPal</span>
                                    </a>
                                </div>
                                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(var(--theme-color), 0.2);">
                                    <p style="color: rgb(255, 255, 255); font-size: 0.85rem;">
                                        ðŸ’¡ <strong>Tip:</strong> 100% of donations go directly to server maintenance, development, and feature improvements. No hidden fees or redirectsâ€”just pure support for your favorite bot.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        function switchSection(sectionName) {
            console.log('ðŸ”µ switchSection:', sectionName);
            try {
                // 1. HIDE ALL - force display none on EVERY section
                const allSections = document.querySelectorAll('.content-section');
                allSections.forEach(s => {
                    s.style.display = 'none';
                    s.style.visibility = 'hidden';
                    s.style.zIndex = '0';
                    s.classList.remove('active');
                });
                
                // 2. DEACTIVATE all sidebar items
                document.querySelectorAll('.sidebar-item').forEach(i => {
                    i.classList.remove('active');
                });
                
                // 3. ACTIVATE the clicked sidebar item
                const activeItem = document.querySelector(`[data-section="${sectionName}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
                
                // 4. SHOW target section - FORCE IT
                const sectionId = sectionName + '-section';
                const section = document.getElementById(sectionId);
                
                if (section) {
                    section.style.display = 'block';
                    section.style.visibility = 'visible';
                    section.style.zIndex = '100';
                    section.classList.add('active');
                    console.log('   âœ… Section shown:', sectionName);
                    
                    // Scroll to top
                    section.scrollIntoView({ behavior: 'auto', block: 'start' });
                    
                    // Load tab-specific data
                    const loadMap = {
                        'dashboard': loadMemberGraphs,
                        'events': loadMemberEvents,
                        'settings': loadSettings,
                        'logging': loadLogging,
                        'server-guard': loadServerGuard,
                        'react-roles': loadReactRoles,
                        'server-messages': loadServerMessages,
                        'custom-commands': loadCustomCommands,
                        'xp-levels': loadXPLevels,
                        'leaderboards': loadLeaderboards,
                        'giveaways': loadGiveaways,
                        'social-notifs': loadSocialNotifs,
                        'invite-tracking': loadInviteTracking,
                        'message-counting': loadMessageCounting,
                        'recordings': loadRecordings,
                        'reminders': loadReminders,
                        'statistics-channels': loadStatisticChannels,
                        'role-categories': () => { loadRoleCategories(localStorage.getItem('selectedServerId')); loadRoleActivityLogs(localStorage.getItem('selectedServerId')); },
                        'admin-activity': () => loadAdminActivityLogs(localStorage.getItem('selectedServerId')),
                        'colors': loadSavedColors,
                        'general-settings': () => loadChannels(localStorage.getItem('selectedServerId'))
                    };
                    
                    if (loadMap[sectionName]) {
                        try {
                            const loadFn = loadMap[sectionName];
                            if (typeof loadFn === 'function') loadFn();
                        } catch (e) {
                            console.error('Error loading ' + sectionName + ':', e);
                        }
                    }
                } else {
                    console.error('   âŒ Section NOT found:', sectionId);
                }
            } catch (err) {
                console.error('   âŒ ERROR:', err.message);
            }
        }

        function toggleDarkMode() {
            const isDarkMode = !document.body.classList.contains('light-mode');
            const newMode = isDarkMode ? 'light' : 'dark';
            
            if (newMode === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('modeIcon').textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'light');
            } else {
                document.body.classList.remove('light-mode');
                document.getElementById('modeIcon').textContent = 'ðŸŒ™';
                localStorage.setItem('theme', 'dark');
            }
        }

        function toggleProfileMenu() {
            const menu = document.getElementById('profileMenu');
            menu.classList.toggle('active');
        }

        async function loadServerList() {
            try {
                const container = document.getElementById('serverIconsContainer');
                container.innerHTML = '<div style="text-align: center; color: rgb(255, 255, 255);">Loading servers...</div>';
                
                const res = await fetch('/api/creator/servers', { credentials: 'include' });
                if (!res.ok) {
                    container.innerHTML = '<div style="text-align: center; color: #ff6b6b;">Error loading servers</div>';
                    return;
                }
                
                const data = await res.json();
                
                if (!data.servers || data.servers.length === 0) {
                    container.innerHTML = '<div style="text-align: center; color: rgb(255, 255, 255);">No servers found</div>';
                    return;
                }
                
                const currentServerId = localStorage.getItem('selectedServerId');
                container.innerHTML = '';
                
                data.servers.forEach(server => {
                    const btn = document.createElement('button');
                    btn.className = `server-icon-btn ${server.id === currentServerId ? 'active' : ''}`;
                    btn.onclick = () => selectServer(server.id, server.name);
                    btn.title = server.name;
                    if (server.icon) {
                        btn.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = server.icon;
                        img.alt = server.name;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.objectFit = 'cover';
                        img.style.borderRadius = '8px';
                        img.onerror = () => {
                            console.warn(`ðŸ–¼ï¸ Server icon failed, trying proxy: ${server.name}`);
                            if (server.iconProxy) {
                                img.src = server.iconProxy;
                                img.onerror = () => {
                                    btn.textContent = server.name.charAt(0).toUpperCase();
                                    console.warn(`ðŸ–¼ï¸ Server icon proxy failed for ${server.name}`);
                                };
                            } else {
                                btn.textContent = server.name.charAt(0).toUpperCase();
                            }
                        };
                        btn.appendChild(img);
                    } else {
                        btn.textContent = server.name.charAt(0).toUpperCase();
                    }
                    container.appendChild(btn);
                });
                
                document.getElementById('serverCountDisplay').textContent = `${data.servers.length} server${data.servers.length !== 1 ? 's' : ''}`;
            } catch (err) {
                console.error('Failed to load servers:', err);
                document.getElementById('serverIconsContainer').innerHTML = '<div style="text-align: center; color: #ff6b6b;">Error loading servers</div>';
            }
        }

        async function selectServer(serverId, serverName) {
            localStorage.setItem('selectedServerId', serverId);
            document.getElementById('serverDisplayName').textContent = serverName;
            
            // Update active state
            document.querySelectorAll('.server-icon-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.server-icon-btn').classList.add('active');
            
            console.log('ðŸ”„ Server switched to:', serverName, '(' + serverId + ')');
            
            // Load ALL data for the selected server
            await loadRoleCategories(serverId);
            await loadMemberGraphs();
            await loadMemberEvents();
            await loadChannels(serverId);
            await loadRoles(serverId);
        }

        async function loadRoles(guildId) {
            try {
                const res = await fetch(`/api/roles/${guildId}`, { credentials: 'include' });
                if (!res.ok) throw new Error('Failed to fetch roles');
                
                const data = await res.json();
                const roles = data.roles || [];
                
                // Populate all role dropdowns
                const selects = [
                    document.getElementById('adminRoleSelect'),
                    document.getElementById('moderatorRoleSelect'),
                    document.getElementById('membersRoleSelect'),
                    document.getElementById('mutedRoleSelect')
                ];
                
                selects.forEach(select => {
                    if (select) {
                        // Keep first option, remove others
                        while (select.options.length > 1) {
                            select.remove(1);
                        }
                        
                        // Add all roles
                        roles.forEach(role => {
                            const option = document.createElement('option');
                            option.value = role.id;
                            option.textContent = `@${role.name}`;
                            select.appendChild(option);
                        });
                    }
                });
                
                console.log('âœ… Loaded', roles.length, 'roles');
            } catch (err) {
                console.error('âŒ Failed to load roles:', err);
            }
        }

        async function loadChannels(guildId) {
            try {
                const res = await fetch(`/api/channels/${guildId}`, { credentials: 'include' });
                if (!res.ok) throw new Error('Failed to fetch channels');
                
                const data = await res.json();
                const channels = data.channels || [];
                
                // Clear existing options (keep placeholder)
                const selects = [
                    document.getElementById('generalChannelSelect'),
                    document.getElementById('announcementsChannelSelect'),
                    document.getElementById('welcomeChannelSelect')
                ];
                
                selects.forEach(select => {
                    if (select) {
                        // Keep first option, remove others
                        while (select.options.length > 1) {
                            select.remove(1);
                        }
                        
                        // Add all channels
                        channels.forEach(channel => {
                            const option = document.createElement('option');
                            option.value = channel.id;
                            option.textContent = `#${channel.name}`;
                            select.appendChild(option);
                        });
                    }
                });
                
                console.log('âœ… Loaded', channels.length, 'channels');
            } catch (err) {
                console.error('âŒ Failed to load channels:', err);
            }
        }
        
        // Load servers on page load - MUST happen immediately
        window.addEventListener('load', () => {
            loadServerList();
        });

        // Store current guild for category management
        let currentGuildId = localStorage.getItem('selectedServerId');
        let currentCategories = {};

        async function loadRoleCategories(guildId) {
            currentGuildId = guildId;
            try {
                console.log('ðŸ”µ Fetching categories for guildId:', guildId);
                const res = await fetch(`/api/config/role-categories?guildId=${guildId}`, { credentials: 'include' });
                console.log('ðŸ”µ Categories API response status:', res.status);
                
                if (res.ok) {
                    const categories = await res.json();
                    console.log('ðŸ”µ Raw categories response:', categories);
                    
                    // Filter out empty keys
                    const filteredCategories = {};
                    Object.keys(categories).forEach(key => {
                        if (key && key.trim() !== '') {
                            filteredCategories[key] = categories[key];
                        }
                    });
                    
                    currentCategories = filteredCategories;
                    const categoryOptions = Object.keys(filteredCategories).filter(k => k && k.trim() !== '');
                    console.log('ðŸ”µ Filtered categories:', categoryOptions);
                    
                    // Calculate and display role stats
                    let totalRolesCreated = 0;
                    let totalCategoriesModified = 0;
                    let totalCategoriesCreated = categoryOptions.length;
                    
                    categoryOptions.forEach(catName => {
                        const category = categories[catName];
                        if (category.roles && Array.isArray(category.roles)) {
                            totalRolesCreated += category.roles.length;
                        }
                        if (category.createdAt) totalCategoriesModified++;
                    });
                    
                    // Update stats display
                    const statCreated = document.getElementById('statRolesCreated');
                    const statDeleted = document.getElementById('statRolesDeleted');
                    const statModified = document.getElementById('statRolesModified');
                    const statCategoriesCreated = document.getElementById('statCategoriesCreated');
                    
                    if (statCreated) statCreated.textContent = totalRolesCreated;
                    if (statDeleted) statDeleted.textContent = '0';
                    if (statModified) statModified.textContent = totalCategoriesModified;
                    if (statCategoriesCreated) statCategoriesCreated.textContent = totalCategoriesCreated;
                    
                    console.log('ðŸ“Š Role Stats - Roles Created:', totalRolesCreated, 'Categories Created:', totalCategoriesCreated, 'Modified:', totalCategoriesModified);
                    
                    // Update all category dropdowns
                    document.querySelectorAll('select[name="category"]').forEach(select => {
                        console.log('ðŸ”µ Updating dropdown with id:', select.id);
                        const currentValue = select.value;
                        select.innerHTML = '<option>-- Select Category --</option>';
                        categoryOptions.forEach(catName => {
                            const opt = document.createElement('option');
                            opt.value = catName;
                            opt.textContent = catName;
                            select.appendChild(opt);
                            console.log('ðŸ”µ Added option:', catName);
                        });
                        if (currentValue && categoryOptions.includes(currentValue)) {
                            select.value = currentValue;
                        }
                    });
                    
                    console.log('âœ… Loaded categories for server:', categoryOptions);
                } else {
                    console.error('ðŸ”´ API returned status:', res.status);
                }
            } catch (err) {
                console.error('ðŸ”´ Failed to load categories:', err);
            }
        }

        let currentEditingRoles = [];

        function loadCategoryDetails() {
            const categoryName = document.getElementById('editCategorySelect').value;
            const detailsDiv = document.getElementById('categoryDetails');
            
            if (categoryName === '-- Select Category --' || !currentCategories[categoryName]) {
                detailsDiv.style.display = 'none';
                return;
            }
            
            const categoryData = currentCategories[categoryName];
            document.getElementById('editCategoryName').value = categoryName || '';
            document.getElementById('editCategoryMessage').value = categoryData.message || '';
            document.getElementById('editCategoryChannel').value = categoryData.channel || '';
            document.getElementById('newRoleInput').value = '';
            
            // Store and display roles
            currentEditingRoles = categoryData.roles || [];
            displayRolesList();
            
            detailsDiv.style.display = 'block';
        }

        function displayRolesList() {
            const rolesList = document.getElementById('rolesList');
            
            if (currentEditingRoles.length === 0) {
                rolesList.innerHTML = '<div style="color: rgb(255, 255, 255); font-size: 0.8rem; padding: 0.5rem;">No roles yet</div>';
                return;
            }
            
            rolesList.innerHTML = '';
            currentEditingRoles.forEach((role, index) => {
                const roleEl = document.createElement('div');
                roleEl.style.cssText = `
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem;
                    background: rgba(var(--theme-color), 0.1);
                    border-radius: 4px;
                    margin-bottom: 0.5rem;
                    font-size: 0.85rem;
                `;
                
                const roleFormat = role.startsWith('@') ? role : `@${role}`;
                roleEl.innerHTML = `
                    <span>${roleFormat} - ${role.replace('@', '')}</span>
                    <button onclick="removeRoleFromCategory(${index})" style="background: rgba(255, 107, 107, 0.3); border: none; color: #ff6b6b; padding: 0.25rem 0.5rem; border-radius: 3px; cursor: pointer; font-size: 0.75rem;">Remove</button>
                `;
                rolesList.appendChild(roleEl);
            });
        }

        function addRoleToCategory() {
            const input = document.getElementById('newRoleInput');
            let roleName = input.value.trim();
            
            if (!roleName) {
                showNotification('Please enter a role name', 'info');
                return;
            }
            
            // Remove @ if user included it
            roleName = roleName.replace(/^@/, '');
            
            // Check for duplicates
            if (currentEditingRoles.some(r => r.toLowerCase() === roleName.toLowerCase())) {
                showNotification('This role is already added', 'info');
                return;
            }
            
            currentEditingRoles.push(roleName);
            input.value = '';
            displayRolesList();
        }

        function removeRoleFromCategory(index) {
            currentEditingRoles.splice(index, 1);
            displayRolesList();
        }

        async function quickSetup(setupType) {
            const setupNames = {
                'gaming': 'Gaming Roles',
                'watchparty': 'Watch Party',
                'platform': 'Platform Roles',
                'removeRoles': 'Remove Roles',
                'levelRoles': 'Level Roles (1-100)'
            };

            const loadingMsg = `â³ Setting up ${setupNames[setupType]}...`;
            alert(loadingMsg);

            try {
                const res = await fetch(`/api/quick-setup/${setupType}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ guildId: currentGuildId }),
                    credentials: 'include'
                });

                const data = await res.json();
                
                if (res.ok) {
                    showNotification(`âœ… ${setupNames[setupType]} setup complete!\n\n${data.message || ''}`, 'success');
                } else {
                    showNotification(`âŒ Setup failed: ${data.error || 'Unknown error'}`, 'error');
                }
            } catch (err) {
                console.error('Error:', err);
                showNotification(`âŒ Failed to setup ${setupNames[setupType]}`, 'error');
            }
        }

        let creatingCategoryRoles = [];

        function addRoleWhileCreating() {
            const input = document.getElementById('creatingRoleInput');
            let roleName = input.value.trim();
            
            if (!roleName) {
                showNotification('Please enter a role name', 'info');
                return;
            }
            
            roleName = roleName.replace(/^@/, '');
            
            if (creatingCategoryRoles.some(r => r.toLowerCase() === roleName.toLowerCase())) {
                showNotification('This role is already added', 'info');
                return;
            }
            
            creatingCategoryRoles.push(roleName);
            input.value = '';
            displayCreatingRolesList();
        }

        function removeRoleWhileCreating(index) {
            creatingCategoryRoles.splice(index, 1);
            displayCreatingRolesList();
        }

        function displayCreatingRolesList() {
            const rolesList = document.getElementById('creatingRolesList');
            
            if (creatingCategoryRoles.length === 0) {
                rolesList.innerHTML = '<div style="color: rgb(255, 255, 255); font-size: 0.8rem; padding: 0.5rem;">Add roles below</div>';
                return;
            }
            
            rolesList.innerHTML = '';
            creatingCategoryRoles.forEach((role, index) => {
                const roleEl = document.createElement('div');
                roleEl.style.cssText = `
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 0.5rem;
                    background: rgba(var(--theme-color), 0.1);
                    border-radius: 4px;
                    margin-bottom: 0.5rem;
                    font-size: 0.85rem;
                `;
                
                const roleFormat = role.startsWith('@') ? role : `@${role}`;
                roleEl.innerHTML = `
                    <span>${roleFormat} - ${role.replace('@', '')}</span>
                    <button onclick="removeRoleWhileCreating(${index})" style="background: rgba(255, 107, 107, 0.3); border: none; color: #ff6b6b; padding: 0.25rem 0.5rem; border-radius: 3px; cursor: pointer; font-size: 0.75rem;">Remove</button>
                `;
                rolesList.appendChild(roleEl);
            });
        }

        async function createRoleCategory() {
            // Get guild ID from localStorage (most up-to-date source)
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            // Check if server is selected
            if (!guildId) {
                showNotification('âŒ Please select a server first from the dropdown', 'error');
                return;
            }

            const name = document.getElementById('categoryName').value.trim();
            const message = document.getElementById('categoryMessage').value.trim();
            
            if (!name) {
                showNotification('âŒ Please enter a category name', 'error');
                return;
            }
            
            if (creatingCategoryRoles.length === 0) {
                showNotification('âŒ Please add at least one role to this category', 'error');
                return;
            }
            
            try {
                const url = `/api/config/role-categories?guildId=${guildId}`;
                const payload = {
                    categoryName: name,
                    message: message || 'Select a role below',
                    roles: creatingCategoryRoles
                };
                
                console.log('ðŸ”µ Creating category:', { url, payload, guildId, rolesCount: creatingCategoryRoles.length });
                
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('ðŸ”µ API Response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    showNotification(`âœ… Category "${name}" created with ${creatingCategoryRoles.length} roles!`, 'success');
                    // Clear form
                    document.getElementById('categoryName').value = '';
                    document.getElementById('categoryMessage').value = '';
                    document.getElementById('creatingRoleInput').value = '';
                    creatingCategoryRoles = [];
                    displayCreatingRolesList();
                    
                    // Force reload categories with proper wait
                    console.log('ðŸ”µ Loading categories after creation...');
                    await new Promise(resolve => setTimeout(resolve, 100));
                    await loadRoleCategories(guildId);
                    
                    // Force select the newly created category
                    await new Promise(resolve => setTimeout(resolve, 200));
                    const select = document.getElementById('editCategorySelect');
                    if (select) {
                        const opts = Array.from(select.options).map(o => o.value);
                        console.log('ðŸ”µ Available options:', opts);
                        select.value = name;
                        if (select.value === name) {
                            console.log('âœ… Category selected:', name);
                            loadCategoryDetails();
                        }
                    }
                } else {
                    showNotification(`âŒ Error: ${data.error || 'Failed to create category'}`, 'error');
                    console.error('ðŸ”´ API Error:', data);
                }
            } catch (err) {
                console.error('ðŸ”´ Error creating category:', err);
                showNotification(`âŒ Error: ${err.message}`, 'error');
            }
        }

        async function saveCategoryChanges() {
            // Get guild ID from localStorage (most up-to-date source)
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            if (!guildId) {
                showNotification('âŒ Please select a server first from the dropdown', 'error');
                return;
            }

            const oldName = document.getElementById('editCategorySelect').value;
            const newName = document.getElementById('editCategoryName').value.trim();
            const message = document.getElementById('editCategoryMessage').value.trim();
            
            if (!newName) {
                showNotification('âŒ Please enter a category name', 'error');
                return;
            }
            
            if (currentEditingRoles.length === 0) {
                showNotification('âŒ Please add at least one role to this category', 'error');
                return;
            }
            
            try {
                const url = `/api/config/role-categories?guildId=${guildId}`;
                const payload = {
                    oldCategoryName: oldName,
                    categoryName: newName,
                    message: message || 'Select a role below',
                    roles: currentEditingRoles
                };

                console.log('ðŸ”µ Updating category:', { url, payload, guildId, rolesCount: currentEditingRoles.length });
                
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('ðŸ”µ API Response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    showNotification(`âœ… Category "${newName}" updated with ${currentEditingRoles.length} roles!`, 'success');
                    await loadRoleCategories(guildId);
                } else {
                    showNotification(`âŒ Error: ${data.error || 'Failed to update category'}`, 'error');
                    console.error('ðŸ”´ API Error:', data);
                }
            } catch (err) {
                console.error('ðŸ”´ Error updating category:', err);
                showNotification(`âŒ Error: ${err.message}`, 'error');
            }
        }

        async function postCategoryToChannel() {
            const guildId = localStorage.getItem('selectedServerId') || currentGuildId;
            
            if (!guildId) {
                showNotification('âŒ Please select a server first', 'error');
                return;
            }
            
            const categoryName = document.getElementById('editCategorySelect').value;
            if (categoryName === '-- Select Category --' || !categoryName) {
                showNotification('âŒ Please select a category first', 'error');
                return;
            }
            
            const channelId = prompt('ðŸ“¤ Enter the Channel ID to post this category selector to:\n(You can get it by right-clicking the channel in Discord)');
            if (!channelId) return;
            
            try {
                console.log('ðŸ”µ Posting category to channel:', { categoryName, channelId, guildId });
                
                const res = await fetch(`/api/post-category?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ categoryName, channelId }),
                    credentials: 'include'
                });
                
                const data = await res.json();
                console.log('ðŸ”µ Post response:', { status: res.status, data });
                
                if (res.ok && data.success) {
                    showNotification(`âœ… Category posted to channel!\n\nMessage ID: ${data.messageId}`, 'success');
                } else {
                    showNotification(`âŒ Error: ${data.error || 'Failed to post'}`, 'error');
                    console.error('ðŸ”´ Post Error:', data);
                }
            } catch (err) {
                console.error('ðŸ”´ Error posting category:', err);
                showNotification(`âŒ Error: ${err.message}`, 'error');
            }
        }

        document.addEventListener('click', function(event) {
            const profileMenu = document.getElementById('profileMenu');
            const profile = document.querySelector('.user-profile');
            if (!profile.contains(event.target)) {
                profileMenu.classList.remove('active');
            }

            const serverDropdown = document.getElementById('serverDropdownMenu');
            const serverSelector = document.querySelector('.server-selector');
            if (!serverSelector.contains(event.target)) {
                serverDropdown.classList.remove('active');
            }
        });

        // ==================== MASTER HANDLERS FOR ALL TABS ====================
        async function loadTabConfig(configName) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return null;
            try {
                const res = await fetch(`/api/config/${configName}?guildId=${guildId}`, { credentials: 'include' });
                if (res.ok) return await res.json();
            } catch (e) { console.error('Error loading ' + configName + ':', e); }
            return {};
        }

        async function saveTabConfig(configName, data) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return showNotification('Select a server first', 'info');
            try {
                const res = await fetch(`/api/config/${configName}?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                    credentials: 'include'
                });
                if (res.ok) return showNotification(`âœ… ${configName} saved`, 'success');
                else showNotification(`âŒ Failed to save ${configName}`, 'error');
            } catch (e) { alert('Error: ' + e.message); }
        }

        async function loadSettings() {
            const config = await loadTabConfig('settings');
            if (config) {
                document.querySelector('[placeholder="//"]').value = config.prefix || '//';
                
                // Load role selections
                if (config.adminRole) document.getElementById('adminRoleSelect').value = config.adminRole;
                if (config.moderatorRole) document.getElementById('moderatorRoleSelect').value = config.moderatorRole;
                if (config.membersRole) document.getElementById('membersRoleSelect').value = config.membersRole;
                if (config.mutedRole) document.getElementById('mutedRoleSelect').value = config.mutedRole;
                
                // Load channel selections
                if (config.generalChannel) document.getElementById('generalChannelSelect').value = config.generalChannel;
                if (config.announcementsChannel) document.getElementById('announcementsChannelSelect').value = config.announcementsChannel;
                if (config.welcomeChannel) document.getElementById('welcomeChannelSelect').value = config.welcomeChannel;
            }
        }

        async function saveSettings() {
            const prefix = document.querySelector('[placeholder="//"]')?.value || '//';
            const settings = {
                prefix,
                adminRole: document.getElementById('adminRoleSelect').value || '',
                moderatorRole: document.getElementById('moderatorRoleSelect').value || '',
                membersRole: document.getElementById('membersRoleSelect').value || '',
                mutedRole: document.getElementById('mutedRoleSelect').value || '',
                generalChannel: document.getElementById('generalChannelSelect').value || '',
                announcementsChannel: document.getElementById('announcementsChannelSelect').value || '',
                welcomeChannel: document.getElementById('welcomeChannelSelect').value || ''
            };
            await saveTabConfig('settings', settings);
        }
        
        // Auto-save when role/channel selections change
        document.addEventListener('DOMContentLoaded', () => {
            const selects = [
                'adminRoleSelect', 'moderatorRoleSelect', 'membersRoleSelect', 'mutedRoleSelect',
                'generalChannelSelect', 'announcementsChannelSelect', 'welcomeChannelSelect'
            ];
            selects.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('change', () => {
                        console.log('ðŸ’¾ Role/Channel changed, saving...');
                        saveSettings();
                    });
                }
            });
        });

        async function loadLogging() {
            const config = await loadTabConfig('logging');
            const chk = document.querySelector('#logging-section input[type="checkbox"]');
            if (chk && config.enabled) chk.checked = true;
        }

        async function saveLogging() {
            const enabled = document.querySelector('#logging-section input[type="checkbox"]')?.checked;
            await saveTabConfig('logging', { enabled });
        }

        async function loadServerGuard() {
            const config = await loadTabConfig('server-guard');
            const chk = document.querySelector('#server-guard-section input[type="checkbox"]');
            if (chk && config.enabled) chk.checked = true;
        }

        async function saveServerGuard() {
            const enabled = document.querySelector('#server-guard-section input[type="checkbox"]')?.checked;
            await saveTabConfig('server-guard', { enabled });
        }

        async function loadReactRoles() {
            await loadTabConfig('react-roles');
        }

        async function saveReactRoles() {
            await saveTabConfig('react-roles', { enabled: true });
        }

        async function createReactRole() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return showNotification('Select a server first', 'info');
            showNotification('âœ… Reaction role configuration saved', 'success');
        }

        async function loadServerMessages() {
            const config = await loadTabConfig('server-messages');
            const ta = document.querySelector('#server-messages-section textarea');
            if (ta && config.welcomeMessage) ta.value = config.welcomeMessage;
        }

        async function saveServerMessages() {
            const welcomeMsg = document.querySelector('#server-messages-section textarea')?.value || '';
            await saveTabConfig('server-messages', { welcomeMessage: welcomeMsg });
        }

        async function loadCustomCommands() {
            await loadTabConfig('custom-commands');
        }

        async function saveCustomCommands() {
            const name = document.querySelector('#custom-commands-section input')?.value || '';
            const response = document.querySelector('#custom-commands-section textarea')?.value || '';
            if (!name || !response) return showNotification('Fill in all fields', 'info');
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) return;
            try {
                const res = await fetch(`/api/commands/${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, response }),
                    credentials: 'include'
                });
                if (res.ok) {
                    showNotification('âœ… Command created', 'success');
                    document.querySelector('#custom-commands-section input').value = '';
                    document.querySelector('#custom-commands-section textarea').value = '';
                } else {
                    showNotification('âŒ Failed to create command', 'error');
                }
            } catch (e) { alert('Error: ' + e.message); }
        }

        async function loadXPLevels() {
            await loadTabConfig('xp-levels');
        }

        async function saveXPLevels() {
            const xpPerLevel = document.querySelector('#xp-levels-section input[placeholder="500"]')?.value || '500';
            await saveTabConfig('xp-levels', { xpPerLevel: parseInt(xpPerLevel) });
        }

        async function loadLeaderboards() {
            await loadTabConfig('leaderboards');
        }

        async function saveLeaderboards() {
            await saveTabConfig('leaderboards', { enabled: true });
        }

        async function loadGiveaways() {
            await loadTabConfig('giveaways');
        }

        async function createGiveaway() {
            const prize = document.querySelector('#giveaways-section input[placeholder*="Discord"]')?.value || '';
            const duration = document.querySelector('#giveaways-section input[placeholder*="minutes"]')?.value || '60';
            if (!prize) return showNotification('Enter a prize', 'info');
            await saveTabConfig('giveaways', { prize, duration: parseInt(duration), active: true });
        }

        async function loadSocialNotifs() {
            await loadTabConfig('social-notifs');
        }

        async function addStreamer() {
            await saveTabConfig('social-notifs', { enabled: true });
        }

        async function loadInviteTracking() {
            await loadTabConfig('invite-tracking');
        }

        async function saveInviteTracking() {
            await saveTabConfig('invite-tracking', { enabled: true });
        }

        async function loadMessageCounting() {
            await loadTabConfig('message-counting');
        }

        async function saveMessageCounting() {
            await saveTabConfig('message-counting', { enabled: true });
        }

        async function loadRecordings() {
            await loadTabConfig('recordings');
        }

        async function saveRecordings() {
            await saveTabConfig('recordings', { enabled: true });
        }

        async function loadReminders() {
            await loadTabConfig('reminders');
        }

        async function createReminder() {
            await saveTabConfig('reminders', { enabled: true });
        }

        async function loadStatisticChannels() {
            await loadTabConfig('statistics-channels');
        }

        async function addStatChannel() {
            await saveTabConfig('statistics-channels', { enabled: true });
        }

        // ========== ACTIVITY LOGGING FUNCTIONS - LIVE FROM SERVER ==========
        let activityLogs = [];
        let activityRefreshInterval = null;
        const MAX_LOGS = 500;

        function addActivityLog(category, message, severity = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const log = { timestamp, category, message, severity };
            activityLogs.unshift(log);
            
            if (activityLogs.length > MAX_LOGS) {
                activityLogs.pop();
            }
            localStorage.setItem('activityLogs', JSON.stringify(activityLogs));
        }

        async function fetchLiveActivities() {
            try {
                const response = await fetch('/api/dashboard/activity', { credentials: 'include' });
                if (!response.ok) throw new Error('Failed to fetch activities');
                
                const data = await response.json();
                if (data.activities && data.activities.length > 0) {
                    // Map server activities to display format
                    activityLogs = data.activities.map(activity => ({
                        timestamp: activity.time || new Date().toLocaleTimeString(),
                        category: getCategoryFromIcon(activity.icon),
                        message: `${activity.text} - ${activity.action}`,
                        severity: getSeverityFromIcon(activity.icon),
                        icon: activity.icon
                    }));
                    displayActivityLogs();
                } else {
                    displayActivityLogs();
                }
            } catch (e) {
                console.log('Activity fetch error (normal if not logged in):', e.message);
                displayActivityLogs();
            }
        }

        function getCategoryFromIcon(icon) {
            const categoryMap = {
                'ðŸŽ¤': 'voice',
                'âš ï¸': 'moderation',
                'ðŸ’°': 'economy',
                'ðŸ“ˆ': 'leveling',
                'ðŸŽµ': 'music',
                'ðŸ‘¤': 'members',
                'ðŸ‘¥': 'members',
                'âš™ï¸': 'config',
                'ðŸ“¢': 'alert',
                'ðŸ›¡ï¸': 'moderation'
            };
            return categoryMap[icon] || 'alert';
        }

        function getSeverityFromIcon(icon) {
            if (icon === 'âš ï¸' || icon === 'ðŸ›¡ï¸') return 'warning';
            if (icon === 'âŒ' || icon === 'ðŸ”´') return 'error';
            return 'info';
        }

        async function loadRoleActivityLogs(guildId) {
            try {
                const response = await fetch(`/api/dashboard/activity?guildId=${guildId}`, { credentials: 'include' });
                if (!response.ok) throw new Error('Failed to fetch role activities');
                
                const data = await response.json();
                const activities = data.activities || [];
                
                const logsList = document.getElementById('roleActivityLogsList');
                if (!logsList) return;
                
                if (activities.length === 0) {
                    logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">â³ No role activities yet...</div>';
                    return;
                }
                
                logsList.innerHTML = '';
                activities.slice(0, 20).forEach(activity => {
                    const timestamp = activity.timestamp ? new Date(activity.timestamp).toLocaleTimeString() : 'Unknown';
                    const logEntry = document.createElement('div');
                    logEntry.style.cssText = `
                        padding: 0.5rem 0;
                        border-bottom: 1px solid rgba(0, 212, 255, 0.1);
                        font-size: 0.85rem;
                        line-height: 1.4;
                    `;
                    logEntry.innerHTML = `
                        <span style="color: #00d4ff;">[${timestamp}]</span>
                        <span style="color: #9146ff;">${activity.icon || 'ðŸ“'}</span>
                        <span style="color: rgba(255,255,255,0.8);">${activity.name || 'Admin'}</span>
                        <span style="color: rgba(255,255,255,0.6);">- ${activity.action || 'action'}</span>
                    `;
                    logsList.appendChild(logEntry);
                });
                
                console.log('âœ… Loaded', activities.length, 'role activities');
            } catch (err) {
                console.error('âŒ Failed to load role activities:', err);
                const logsList = document.getElementById('roleActivityLogsList');
                if (logsList) {
                    logsList.innerHTML = '<div style="color: #ff6b6b;">Error loading activities</div>';
                }
            }
        }

        async function loadAdminActivityLogs(guildId) {
            try {
                const response = await fetch(`/api/dashboard/activity?guildId=${guildId}`, { credentials: 'include' });
                if (!response.ok) throw new Error('Failed to fetch admin activities');
                
                const data = await response.json();
                const activities = data.activities || [];
                
                const logsList = document.getElementById('adminActivityLogsList');
                if (!logsList) return;
                
                if (activities.length === 0) {
                    logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 3rem 0;">â³ No admin activities yet...</div>';
                    return;
                }
                
                logsList.innerHTML = '';
                activities.slice(0, 30).forEach(activity => {
                    const timestamp = activity.timestamp ? new Date(activity.timestamp).toLocaleTimeString() : 'Unknown';
                    const logEntry = document.createElement('div');
                    logEntry.style.cssText = `
                        padding: 0.75rem;
                        margin-bottom: 0.5rem;
                        background: rgba(145, 70, 255, 0.05);
                        border-left: 3px solid #9146ff;
                        border-radius: 4px;
                        font-size: 0.85rem;
                        line-height: 1.6;
                    `;
                    logEntry.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="color: #00d4ff; font-weight: bold;">[${timestamp}]</span>
                                <span style="color: #ff69b4; margin: 0 0.5rem;">${activity.icon || 'ðŸ‘®'}</span>
                                <span style="color: rgba(255,255,255,0.9); font-weight: 600;">${activity.name || 'Admin'}</span>
                            </div>
                        </div>
                        <div style="margin-top: 0.3rem; color: rgba(255,255,255,0.7);">${activity.action || 'performed action'}</div>
                    `;
                    logsList.appendChild(logEntry);
                });
                
                console.log('âœ… Loaded', activities.length, 'admin activities');
            } catch (err) {
                console.error('âŒ Failed to load admin activities:', err);
                const logsList = document.getElementById('adminActivityLogsList');
                if (logsList) {
                    logsList.innerHTML = '<div style="color: #ff6b6b;">Error loading activities</div>';
                }
            }
        }

        function clearAdminActivityLogs() {
            if (confirm('Clear all admin activity logs? This cannot be undone.')) {
                const logsList = document.getElementById('adminActivityLogsList');
                if (logsList) {
                    logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 3rem 0;">âœ… Admin activity logs cleared</div>';
                }
            }
        }

        function clearRoleActivityLogs() {
            if (confirm('Clear all role activity logs? This cannot be undone.')) {
                const logsList = document.getElementById('roleActivityLogsList');
                if (logsList) {
                    logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">âœ… Role activity logs cleared</div>';
                }
            }
        }

        function displayActivityLogs() {
            const logsList = document.getElementById('activityLogsList');
            if (!logsList) return;
            
            if (activityLogs.length === 0) {
                logsList.innerHTML = '<div style="color: rgba(0, 212, 255, 0.7); text-align: center; padding: 2rem 0;">â³ Waiting for activities... Messages will appear here as they happen</div>';
                return;
            }

            let html = activityLogs.map(log => {
                const icons = {
                    'voice': 'ðŸŽ¤',
                    'moderation': 'âš ï¸',
                    'economy': 'ðŸ’°',
                    'leveling': 'ðŸ“ˆ',
                    'music': 'ðŸŽµ',
                    'members': 'ðŸ‘¥',
                    'config': 'âš™ï¸',
                    'alert': 'ðŸ“¢'
                };
                const icon = icons[log.category] || log.icon || 'ðŸ“‹';
                const color = log.severity === 'error' ? '#ff6b6b' : log.severity === 'warning' ? '#ffd700' : '#00d4ff';
                
                return `<div style="color: ${color}; margin: 0.5rem 0; padding: 0.5rem; border-left: 2px solid ${color}; padding-left: 0.75rem;">
                    [${log.timestamp}] ${icon} ${log.category.toUpperCase()}: ${log.message}
                </div>`;
            }).join('');
            
            logsList.innerHTML = html;
        }

        function filterActivityLogs() {
            displayActivityLogs();
        }

        function toggleFilterDropdown() {
            const content = document.getElementById('filterLogsContent');
            const icon = document.getElementById('filterToggleIcon');
            const text = document.getElementById('filterToggleText');
            
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.style.transform = 'rotate(180deg)';
                text.textContent = 'Hide';
            } else {
                content.style.display = 'none';
                icon.style.transform = 'rotate(0deg)';
                text.textContent = 'Show';
            }
        }

        function clearActivityLogs(event) {
            if (event) event.stopPropagation();
            if (confirm('Clear all activity logs? This cannot be undone.')) {
                activityLogs = [];
                localStorage.removeItem('activityLogs');
                displayActivityLogs();
                showNotification('âœ… Activity logs cleared', 'success');
            }
        }

        // Load logs from localStorage on startup
        function loadActivityLogs() {
            const saved = localStorage.getItem('activityLogs');
            if (saved) {
                try {
                    activityLogs = JSON.parse(saved);
                } catch (e) {
                    activityLogs = [];
                }
            }
            // Fetch latest from server
            fetchLiveActivities();
        }

        // Initialize activity logging with auto-refresh
        function initializeActivityLogging() {
            loadActivityLogs();
            
            // Refresh activities every 3 seconds for live updates
            if (activityRefreshInterval) clearInterval(activityRefreshInterval);
            activityRefreshInterval = setInterval(() => {
                fetchLiveActivities();
            }, 3000);
        }

        // Call on page load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeActivityLogging);
        } else {
            initializeActivityLogging();
        }
        
        // Legacy support for event listeners (backup)
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', function() {
                const section = this.dataset.section;
                switchSection(section);
            });
        });

        function logout() {
            fetch('/logout', { method: 'POST', credentials: 'include' })
                .then(() => window.location.href = '/login');
        }

        window.addEventListener('load', async () => {
            // Load saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'dark';
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                document.getElementById('modeIcon').textContent = 'â˜€ï¸';
            } else {
                document.getElementById('modeIcon').textContent = 'ðŸŒ™';
            }

            try {
                const res = await fetch('/api/user', { credentials: 'include' });
                if (res.ok) {
                    const data = await res.json();
                    const user = data.user;
                    
                    // Display Discord username
                    const displayName = user.global_name || user.username || 'User';
                    document.getElementById('userName').textContent = displayName;
                    
                    // Set user avatar with Discord profile picture
                    const userAvatar = document.getElementById('userAvatar');
                    userAvatar.style.overflow = 'hidden';
                    if (user.avatarUrl) {
                        userAvatar.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = user.avatarUrl;
                        img.alt = displayName;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.borderRadius = '50%';
                        img.style.objectFit = 'cover';
                        img.onerror = () => {
                            console.warn(`ðŸ“¸ Avatar failed to load, trying proxy...`);
                            if (user.avatarProxyUrl) {
                                img.src = user.avatarProxyUrl;
                                img.onerror = () => {
                                    userAvatar.innerHTML = displayName.charAt(0).toUpperCase();
                                    console.warn(`ðŸ“¸ Avatar proxy also failed`);
                                };
                            } else {
                                userAvatar.innerHTML = displayName.charAt(0).toUpperCase();
                            }
                        };
                        userAvatar.appendChild(img);
                    } else {
                        userAvatar.textContent = displayName.charAt(0).toUpperCase();
                    }
                    
                    // Set user role/status
                    document.getElementById('userRole').textContent = 'Authenticated';
                    
                    // Load servers first, THEN load dashboard data
                    await loadServerList();
                    
                    let selectedServerId = localStorage.getItem('selectedServerId');
                    if (!selectedServerId) {
                        const serverRes = await fetch('/api/creator/servers', { credentials: 'include' });
                        if (serverRes.ok) {
                            const serverData = await serverRes.json();
                            if (serverData.servers && serverData.servers.length > 0) {
                                selectedServerId = serverData.servers[0].id;
                                localStorage.setItem('selectedServerId', selectedServerId);
                                console.log('âœ… Auto-selected first server:', selectedServerId);
                            }
                        }
                    }
                    
                    // NOW load all data for the selected server
                    if (selectedServerId) {
                        console.log('ðŸ”„ Loading data for server:', selectedServerId);
                        await loadRoleCategories(selectedServerId);
                        await loadMemberGraphs();
                        await loadMemberEvents();
                        await loadChannels(selectedServerId);
                        await loadRoles(selectedServerId);
                        
                        // AUTO-SYNC: Refresh all dashboard data periodically
                        console.log('âœ… Started auto-sync - bot changes will update website in real-time');
                        
                        // Refresh member events every 3 seconds
                                setInterval(loadMemberEvents, 3000);
                                
                                // Refresh member graphs every 5 seconds
                                setInterval(loadMemberGraphs, 5000);
                                
                                // Refresh role categories every 5 seconds
                                setInterval(() => loadRoleCategories(selectedServerId), 5000);
                                
                                // Refresh admin activity every 3 seconds
                                setInterval(() => loadAdminActivityLogs(selectedServerId), 3000);
                                
                                // Refresh settings every 5 seconds (if in settings tab)
                                setInterval(() => {
                                    if (document.getElementById('settings-section')?.style.display !== 'none') {
                                        loadSettings();
                                    }
                                }, 5000);
                                
                                // Refresh leaderboards every 5 seconds (if in leaderboards tab)
                                setInterval(() => {
                                    if (document.getElementById('leaderboards-section')?.style.display !== 'none') {
                                        loadLeaderboards();
                                    }
                                }, 5000);
                                
                                // Refresh XP levels every 5 seconds (if in xp-levels tab)
                                setInterval(() => {
                                    if (document.getElementById('xp-levels-section')?.style.display !== 'none') {
                                        loadXPLevels();
                                    }
                                }, 5000);
                                
                                // Refresh giveaways every 5 seconds (if in giveaways tab)
                                setInterval(() => {
                                    if (document.getElementById('giveaways-section')?.style.display !== 'none') {
                                        loadGiveaways();
                                    }
                                }, 5000);
                                
                                // Refresh react roles every 5 seconds (if in react-roles tab)
                                setInterval(() => {
                                    if (document.getElementById('react-roles-section')?.style.display !== 'none') {
                                        loadReactRoles();
                                    }
                                }, 5000);
                    }
                } else {
                    window.location.href = '/login';
                }
            } catch (err) {
                console.error('Failed to load user:', err);
                window.location.href = '/login';
            }
        });


        // Member Graph Functions
        let charts = {};

        async function loadMemberGraphs() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            console.log('ðŸ”µ loadMemberGraphs called for:', selectedServerId);
            if (!selectedServerId) {
                console.log('âŒ No server selected');
                return;
            }

            let stats = null;
            try {
                const res = await fetch(`/api/member-stats/${selectedServerId}`, { credentials: 'include' });
                console.log('ðŸ”µ API response status:', res.status);
                if (res.ok) {
                    stats = await res.json();
                    console.log('ðŸ”µ Stats received from API:', stats);
                } else {
                    console.warn('âš ï¸ API returned:', res.status, '- using mock data');
                    // FALLBACK: Mock data for testing/display purposes
                    stats = {
                        members: 145,
                        verified: 120,
                        bots: 8,
                        admins: 5,
                        mods: 12,
                        roles: [
                            { id: '1', name: 'Member', count: 145 },
                            { id: '2', name: 'Moderator', count: 12 },
                            { id: '3', name: 'Admin', count: 5 },
                            { id: '4', name: 'Bot', count: 8 }
                        ]
                    };
                }
            } catch (err) {
                console.error('ðŸ”´ Fetch failed:', err);
                // FALLBACK: Use mock data
                stats = {
                    members: 145,
                    verified: 120,
                    bots: 8,
                    admins: 5,
                    mods: 12,
                    roles: [
                        { id: '1', name: 'Member', count: 145 },
                        { id: '2', name: 'Moderator', count: 12 },
                        { id: '3', name: 'Admin', count: 5 },
                        { id: '4', name: 'Bot', count: 8 }
                    ]
                };
            }
            
            if (!stats) {
                console.error('âŒ No stats available');
                return;
            }

            // UPDATE LIVE STATS AT TOP
            if (stats) {
                document.getElementById('totalMembersLive').textContent = (stats.total || stats.members).toLocaleString();
                document.getElementById('verifiedMembersLive').textContent = (stats.verified || 0).toLocaleString();
                document.getElementById('botsLive').textContent = (stats.bots || 0).toLocaleString();
                document.getElementById('adminsLive').textContent = (stats.admins || 0).toLocaleString();
                document.getElementById('modsLive').textContent = (stats.mods || 0).toLocaleString();
            }

            // ONE COMBINED BAR CHART with all member types
            const ctx = document.getElementById('allMembersChart');
            if (ctx && typeof Chart !== 'undefined') {
                try {
                    if (charts.allMembers) {
                        charts.allMembers.destroy();
                    }
                    charts.allMembers = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Members', 'Verified', 'Bots', 'Admins', 'Moderators'],
                            datasets: [{
                                label: 'Count',
                                data: [stats.members, stats.verified, stats.bots, stats.admins, stats.mods],
                                backgroundColor: ['#00d4ff', '#00ff88', '#9146ff', '#ff69b4', '#ff6b35'],
                                borderColor: ['rgba(0,212,255,0.3)', 'rgba(0,255,136,0.3)', 'rgba(145,70,255,0.3)', 'rgba(255,105,180,0.3)', 'rgba(255,107,53,0.3)'],
                                borderWidth: 1
                            }]
                        },
                        options: { 
                            responsive: true, 
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { labels: { color: '#fff' } },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.label + ': ' + context.parsed.y;
                                        }
                                    }
                                }
                            },
                            scales: { 
                                y: { 
                                    ticks: { color: '#fff' }, 
                                    grid: { color: 'rgba(255,255,255,0.1)' },
                                    beginAtZero: true
                                }, 
                                x: { 
                                    ticks: { color: '#fff' } 
                                } 
                            }
                        }
                    });
                    console.log('âœ… Bar chart rendered');
                } catch (e) {
                    console.error('Chart creation error:', e);
                }
            } else {
                console.warn('Canvas not found or Chart.js not available');
            }

        }

        // Load and display member events
        async function loadMemberEvents() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            if (!selectedServerId) return;

            try {
                const res = await fetch(`/api/member-events/${selectedServerId}`, { credentials: 'include' });
                if (!res.ok) return;
                const data = await res.json();

                const eventsList = document.getElementById('memberEventsList');
                if (!eventsList) return;

                if (!data.events || data.events.length === 0) {
                    eventsList.innerHTML = '<div style="color: rgb(255, 255, 255); padding: 1rem; text-align: center;">No member events yet</div>';
                    return;
                }

                eventsList.innerHTML = '';
                data.events.forEach(event => {
                    const eventEl = document.createElement('div');
                    let icon = 'ðŸ‘¤';
                    let actionText = '';
                    let bgColor = 'rgba(0, 212, 255, 0.1)';
                    let borderColor = 'rgba(0, 212, 255, 0.3)';

                    if (event.type === 'join') {
                        icon = 'ðŸ‘¤';
                        actionText = 'joined the server';
                        bgColor = 'rgba(0, 212, 255, 0.1)';
                        borderColor = 'rgba(0, 212, 255, 0.3)';
                    } else if (event.type === 'leave') {
                        icon = 'ðŸ‘‹';
                        actionText = 'left the server';
                        bgColor = 'rgba(255, 107, 107, 0.1)';
                        borderColor = 'rgba(255, 107, 107, 0.3)';
                    } else if (event.type === 'boost') {
                        icon = 'ðŸ’Ž';
                        actionText = 'boosted the server';
                        bgColor = 'rgba(255, 192, 61, 0.1)';
                        borderColor = 'rgba(255, 192, 61, 0.3)';
                    }

                    eventEl.style.cssText = `
                        background: ${bgColor};
                        border: 1px solid ${borderColor};
                        border-radius: 6px;
                        padding: 0.75rem;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;

                    eventEl.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <span style="font-size: 1.2rem;">${icon}</span>
                            <div>
                                <div style="font-weight: 600; color: #fff;">${event.user}</div>
                                <div style="font-size: 0.85rem; color: rgb(255, 255, 255);">${actionText}</div>
                            </div>
                        </div>
                        <div style="font-size: 0.75rem; color: rgb(255, 255, 255);">${event.timestamp}</div>
                    `;
                    eventsList.appendChild(eventEl);
                });
            } catch (err) {
                console.error('Failed to load member events:', err);
            }
        }



        // ========== UNSAVED CHANGES DETECTION ==========
        let hasUnsavedChanges = false;
        let originalValues = {};

        function showUnsavedNotification() {
            if (!hasUnsavedChanges) {
                hasUnsavedChanges = true;
                const notification = document.getElementById('unsavedNotification');
                if (notification) {
                    notification.style.display = 'flex';
                }
            }
        }

        function checkIfChangesReverted() {
            // Check if all current values match original values
            const inputs = document.querySelectorAll('input, select, textarea');
            let allReverted = true;
            
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (input.type === 'checkbox' || input.type === 'radio') {
                    if (originalValues[key] !== undefined && originalValues[key] !== input.checked) {
                        allReverted = false;
                    }
                } else {
                    if (originalValues[key] !== undefined && originalValues[key] !== input.value) {
                        allReverted = false;
                    }
                }
            });
            
            if (allReverted && hasUnsavedChanges) {
                hideUnsavedNotification();
            }
        }

        function hideUnsavedNotification() {
            hasUnsavedChanges = false;
            const notification = document.getElementById('unsavedNotification');
            if (notification) {
                notification.classList.add('hide');
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.classList.remove('hide');
                }, 400);
            }
        }

        function resetChanges() {
            // Reset only changed inputs back to original values
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (originalValues[key] !== undefined) {
                    if (input.type === 'checkbox' || input.type === 'radio') {
                        input.checked = originalValues[key];
                    } else {
                        input.value = originalValues[key];
                    }
                }
            });
            hideUnsavedNotification();
        }

        async function updateBotSetting(setting, value) {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            if (!value || value.trim() === '') {
                showNotification('Please enter a value', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/${setting}?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ value: value.trim() }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification(`âœ… ${setting.charAt(0).toUpperCase() + setting.slice(1)} updated successfully!`, 'success');
                } else {
                    showNotification(`âŒ Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating setting', 'info');
            }
        }

        async function updateRoles() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            const adminRole = document.getElementById('adminRoleSelect').value;
            const moderatorRole = document.getElementById('moderatorRoleSelect').value;
            const membersRole = document.getElementById('membersRoleSelect').value;
            const mutedRole = document.getElementById('mutedRoleSelect').value;

            if (!adminRole && !moderatorRole && !membersRole && !mutedRole) {
                showNotification('Please select at least one role', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/roles?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        adminRole: adminRole || '',
                        moderatorRole: moderatorRole || '',
                        membersRole: membersRole || '',
                        mutedRole: mutedRole || ''
                    }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification('âœ… Roles updated successfully!', 'success');
                } else {
                    showNotification(`âŒ Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating roles', 'info');
            }
        }

        function showNotification(message, type = 'success', duration = 3000) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'âœ…';
            let headerText = 'SPIDEY BOT';
            
            if (type === 'error') {
                icon = 'âŒ';
                headerText = 'ERROR';
            } else if (type === 'info') {
                icon = 'â„¹ï¸';
                headerText = 'INFO';
            }
            
            toast.innerHTML = `
                <div class="toast-header">
                    <span class="toast-icon">${icon}</span>
                    <span>${headerText}</span>
                </div>
                <div class="toast-text">${message}</div>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('remove');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        async function updateChannels() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            const generalChannel = document.getElementById('generalChannelSelect').value;
            const announcementsChannel = document.getElementById('announcementsChannelSelect').value;
            const welcomeChannel = document.getElementById('welcomeChannelSelect').value;

            if (!generalChannel && !announcementsChannel && !welcomeChannel) {
                showNotification('Please select at least one channel', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/channels?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        generalChannel: generalChannel || '',
                        announcementsChannel: announcementsChannel || '',
                        welcomeChannel: welcomeChannel || ''
                    }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification('Channels updated successfully!', 'success');
                } else {
                    showNotification(`Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating channels', 'error');
            }
        }

        async function updateAllLogging() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/logging?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        logDeleted: document.getElementById('logDeletedCheck').checked,
                        logEdited: document.getElementById('logEditedCheck').checked,
                        logBulkDelete: document.getElementById('logBulkDeleteCheck').checked,
                        logChannel: document.getElementById('messageLogChannelInput').value || '',
                        logBans: document.getElementById('logBansCheck').checked,
                        logKicks: document.getElementById('logKicksCheck').checked,
                        logMutes: document.getElementById('logMutesCheck').checked,
                        logWarns: document.getElementById('logWarnsCheck').checked,
                        modLogChannel: document.getElementById('modLogChannelInput').value || ''
                    }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification('All logging settings updated!', 'success');
                } else {
                    showNotification(`Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating logging', 'error');
            }
        }

        async function updateAllServerGuard() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/server-guard?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        antiSpamEnabled: document.getElementById('antiSpamCheck').checked,
                        antiSpamLimit: parseInt(document.getElementById('antiSpamLimitInput').value) || 5,
                        antiSpamAction: document.getElementById('antiSpamActionSelect').value || 'Warn',
                        raidEnabled: document.getElementById('raidProtectionCheck').checked,
                        raidLimit: parseInt(document.getElementById('raidLimitInput').value) || 10,
                        banRaidUsers: document.getElementById('banRaidUsersCheck').checked,
                        membersOnly: document.getElementById('membersOnlyCheck').checked,
                        adminsBypass: document.getElementById('adminsBypassCheck').checked,
                        allowDM: document.getElementById('allowDMCheck').checked,
                        confirmDangerous: document.getElementById('confirmDangerousCheck').checked
                    }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification('All Server Guard settings updated!', 'success');
                } else {
                    showNotification(`Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating server guard', 'error');
            }
        }

        async function updateServerMessages() {
            const guildId = localStorage.getItem('selectedServerId');
            if (!guildId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            try {
                const res = await fetch(`/api/bot-config/messages?guildId=${guildId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        enableWelcome: document.getElementById('enableWelcomeCheck').checked,
                        welcomeMessage: document.getElementById('welcomeMessageInput').value || '',
                        enableGoodbye: document.getElementById('enableGoodbyeCheck').checked,
                        goodbyeMessage: document.getElementById('goodbyeMessageInput').value || ''
                    }),
                    credentials: 'include'
                });

                const data = await res.json();
                if (data.success) {
                    showNotification('Server messages updated!', 'success');
                } else {
                    showNotification(`Error: ${data.message || 'Failed to update'}`, 'error');
                }
            } catch (err) {
                console.error('Update error:', err);
                showNotification('Error updating messages', 'error');
            }
        }

        async function saveAllChanges() {
            const selectedServerId = localStorage.getItem('selectedServerId');
            if (!selectedServerId) {
                showNotification('Please select a server first', 'info');
                return;
            }

            console.log('ðŸ’¾ Starting save for server:', selectedServerId);

            // Find and save the CURRENTLY VISIBLE section (the active one)
            const activeSection = document.querySelector('.content-section[style*="display: block"], .content-section.active');
            if (!activeSection) {
                console.warn('No active section found');
                hideUnsavedNotification();
                return;
            }

            const sectionId = activeSection.id;
            const sectionMap = {
                'settings-section': 'settings',
                'logging-section': 'logging',
                'server-guard-section': 'server-guard',
                'react-roles-section': 'react-roles',
                'role-categories-section': 'role-categories',
                'server-messages-section': 'server-messages',
                'custom-commands-section': 'custom-commands',
                'components-section': 'components',
                'xp-levels-section': 'xp-levels',
                'leaderboards-section': 'leaderboards',
                'invite-tracking-section': 'invite-tracking',
                'message-counting-section': 'message-counting',
                'statistics-channels-section': 'statistics-channels',
                'giveaways-section': 'giveaways',
                'social-notifs-section': 'social-notifs',
                'reminders-section': 'reminders',
                'recordings-section': 'recordings'
            };

            const sectionName = sectionMap[sectionId];
            if (!sectionName) {
                console.warn('Unknown section:', sectionId);
                hideUnsavedNotification();
                return;
            }

            console.log('ðŸ’¾ Saving section:', sectionName);
            
            // Only collect inputs that have actual ID or NAME attributes (real form fields)
            const inputs = activeSection.querySelectorAll('input[type="text"], input[type="number"], input[type="checkbox"], input[type="color"], select, textarea');
            const data = {};

            inputs.forEach(input => {
                // Skip inputs without proper id or name
                if (!input.id && !input.name) return;
                
                const key = input.id || input.name;
                
                // Skip placeholder-only or class-only identifiers
                if (!key || key.startsWith('form-') || key.includes('example') || key.includes('e.g') || key.includes('GMT') || key === 'SPIDEY BOT' || key === '//' || key === '') return;
                
                if (input.type === 'checkbox') {
                    data[key] = input.checked;
                    originalValues[key] = input.checked;
                } else if (input.type === 'color') {
                    data[key] = input.value;
                    originalValues[key] = input.value;
                } else {
                    data[key] = input.value;
                    originalValues[key] = input.value;
                }
            });

            console.log('ðŸ’¾ Data to save:', data);

            // Save via API with selected guild ID
            const guildId = localStorage.getItem('selectedServerId');
            const url = `/api/config/${sectionName}?guildId=${guildId}`;
            
            try {
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                    credentials: 'include'
                });
                
                if (!res.ok) {
                    throw new Error(`HTTP ${res.status}: ${res.statusText}`);
                }
                
                const result = await res.json();
                console.log(`âœ… Saved ${sectionName}:`, result);
                showNotification(`âœ… Settings saved to server successfully!`, 'success');
            } catch (err) {
                console.error(`âŒ Error saving ${sectionName}:`, err);
                showNotification(`âŒ Error saving settings: ${err.message}`, 'error');
            }

            hideUnsavedNotification();
        }

        function setupUnsavedDetection() {
            // Store original values on load
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                const key = input.id || input.name || input.className;
                if (input.type === 'checkbox' || input.type === 'radio') {
                    originalValues[key] = input.checked;
                } else {
                    originalValues[key] = input.value;
                }
                
                // Listen for changes and check if reverted
                input.addEventListener('change', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
                input.addEventListener('input', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
            });

            // Also listen for color picker changes
            const colorPickers = document.querySelectorAll('input[type="color"]');
            colorPickers.forEach(picker => {
                const key = picker.id || picker.className;
                originalValues[key] = picker.value;
                
                picker.addEventListener('change', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
                picker.addEventListener('input', () => {
                    showUnsavedNotification();
                    checkIfChangesReverted();
                });
            });
        }

        // Load saved colors on startup
        window.addEventListener('load', function() {
            const savedThemeColor = localStorage.getItem('themeColor');
            if (savedThemeColor) changeThemeColor(savedThemeColor);
            
            const savedCyan = localStorage.getItem('accentCyan');
            if (savedCyan) changeCyanAccent(savedCyan);
            
            const savedPurple = localStorage.getItem('accentPurple');
            if (savedPurple) changePurpleAccent(savedPurple);
            
            const savedPink = localStorage.getItem('accentPink');
            if (savedPink) changePinkAccent(savedPink);

            const savedTextColor = localStorage.getItem('textColor');
            if (savedTextColor) changeTextColor(savedTextColor);

            // Setup unsaved changes detection
            setupUnsavedDetection();
        });
        
        // Global error handler - ensure page doesn't break
        window.addEventListener('error', (event) => {
            console.error('ðŸ”´ Global error caught:', event.error || event.message);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('ðŸ”´ Unhandled promise rejection:', event.reason);
        });

    </script>

    <!-- Unsaved Changes Notification -->
    <div id="unsavedNotification">
        <div class="unsaved-message">
            <div class="unsaved-icon">âš ï¸</div>
            <div class="unsaved-text">Careful â€” you have unsaved changes!</div>
        </div>
        <div class="unsaved-buttons">
            <button class="btn-reset" onclick="resetChanges()">Reset</button>
            <button class="btn-save-changes" onclick="saveAllChanges()">Save Changes</button>
        </div>
    </div>
</body>
</html>
